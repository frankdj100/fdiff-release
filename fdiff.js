var fdiff=(function(){var h={};var u="4.82";var ac="<u>";var s="</u>";var D="<s>";var ab="</s>";var l="[[";var T="]]";var r="{{{";var b="}}}";var k=0;var m=0;var g=1;var d=2;var Z=3;var U=4;var L=5;var p=6;var y=7;var e=1;var W=7;var R=15;var x=true;var A=true;var N=true;var o=true;var v=false;var X=false;var S=false;var M=false;var a=false;var O=false;var j=false;var aa=true;var I=true;var H=false;var Y=false;var P=false;var t=[];var z=[];var B=[];var f=[];var G=[];var K=[];var E="Difference";var F="";var w="";var V="";h.fix_unclosed_brackets=function(aj){var af;var ai,ad;var ah="";var ae="",ag="";af=aj.toString().split("");for(ad=0;ad<af.length;ad++){ai=af[ad];if(ah!==""){ah=ah+ai;if(ai===")"){if(j==false){ae=ae+ah}ah=""}}else{if(ai==="("){ah=ai;if(ag!==""){ae=ae+ag;ag=""}}else{ag=ag+ai}}}if(ah!==""){return ae+"{"+ah.substr(1)}return ae+ag};h.handle_reference_signs=function(af){if(j==true){var ae;var ad=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ae=ad.exec(af))!=null){af=ae[1]+ae[3]}}return h.fix_unclosed_brackets(af)};h.LCSubStr2=function(an,ak,ag,ae){var af,ad,ap,ao;var aj=new Array(-1,-1,-1,-1);var am=[];var al=0;var ai,ah;for(ap=0;ap<ag.length;ap++){af=ag[ap];am[ap]=[];for(ao=0;ao<ae.length;ao++){ad=ae[ao];if(an[af]===ak[ad]){if((ap===0)||(ao===0)){am[ap][ao]=1}else{am[ap][ao]=am[ap-1][ao-1]+1}if(am[ap][ao]>al){al=am[ap][ao];aj[0]=ag[ap-al+1];aj[1]=ag[ap];aj[2]=ae[ao-al+1];aj[3]=ae[ao]}}else{am[ap][ao]=0}}}return aj};h.recurse=function(av,au,aj,aG){var ao,aA,an,az,ay,ax;var ai=[];var aD=[];var am=[];var aH=[];var at=[];var ah=[];var ak;var af,ae,ap,aw;var ar,ag,aB,al;var aI,aF;var aC=/\s/;if(av.length<=0){if(au.length>=1){return[ac].concat(au,s)}else{return[""]}}else{if(au.length<=0){return[D].concat(av,ab)}}if(a){var aE=[],ad=[];for(var aq=0;aq<av.length;aq++){aE.push(av[aq].toUpperCase())}for(var aq=0;aq<au.length;aq++){ad.push(au[aq].toUpperCase())}ak=h.LCSubStr2(aE,ad,aj,aG)}else{ak=h.LCSubStr2(av,au,aj,aG)}af=ak[0];ae=ak[1];ap=ak[2];aw=ak[3];if(af<0){ar=[];while((av.length>0)&&(au.length>0)&&(av[0]===au[0])){ar.push(av.shift());au.shift()}ag=[];while((av.length>0)&&(au.length>0)&&(av[av.length-1]===au[au.length-1])){ag.unshift(av.pop());au.pop()}if(av.length>0){aB=[D];aB=aB.concat(av);aB.push(ab)}else{aB=[]}if(au.length>0){al=[ac];al=al.concat(au);al.push(s)}else{al=[]}return ar.concat(aB,al,ag)}if((af===0)&&(ae===av.length-1)&&(ap===0)&&(aw===au.length-1)){return au}ao=av.splice(0,af);aA=au.splice(0,ap);ay=av.splice(0,ae-af+1);ax=au.splice(0,aw-ap+1);an=av;az=au;for(aF=0;aF<aj.length;aF++){aI=aj[aF];if(aI>ae){aD.push(aI-ae-1)}if(aI<af){ai.push(aI)}}for(aF=0;aF<aG.length;aF++){aI=aG[aF];if(aI>aw){aH.push(aI-aw-1)}if(aI<ap){am.push(aI)}}for(aI=0;aI<ay.length;aI++){if(!aC.test(ay[aI])){at.push(aI)}}for(aI=0;aI<ax.length;aI++){if(!aC.test(ax[aI])){ah.push(aI)}}return(h.recurse(ao,aA,ai,am)).concat(h.recurse(ay,ax,at,ah),h.recurse(an,az,aD,aH))};h.find_keyword_indices=function(ah){var ag=[];var ae;var af;var ad=/[\s,;:?!"'\-&\/()]/;for(ae=0;ae<ah.length;ae++){af=ah[ae];if(af===""){continue}if(ad.test(af)){continue}ag.push(ae)}return ag};h.split_punctuation=function(ao){var an;var al=[];var ai="";var ah,ad="",ak;var ap=/[\s,.;:?!"'\-\/]/;var af=/[a-z,A-Z,\#,0-9]/;var ae=/(.*?)([+\-±\s]+)(\d+\.\d+)(\s+)(.*)/;var ag=/\d+\.\d+/;var aj;an=[];if(ag.test(ao)){while((aj=ae.exec(ao))!=null){an=an.concat(aj[1].toString().split(""));an=an.concat(aj[2].toString().split(""));an.push(aj[3]);an=an.concat(aj[4].toString().split(""));ao=aj[5]}}if(ao!==""){an=an.concat(ao.toString().split(""))}for(ak=0;ak<an.length;ak++){ah=an[ak];if(ai!==""){ai=ai+ah;if(ah===")"){if(j==false){al.push(ai)}else{if((al.length>0)&&(al[al.length-1]===" ")){al.pop()}}ai=""}}else{if(ah==="("){ai=ah;if(ad!==""){al.push(ad);ad=""}}else{if(ap.test(ah)){if(ad!==""){al.push(ad)}al.push(ah);ad=""}else{if(ah==="&"){if(ad!==""){al.push(ad)}ad="&";for(var am=ak+1;am<an.length;am++){if(af.test(an[am])){ad=ad+an[am]}else{break}}if((am<an.length)&&(an[am]===";")&&(am>ak+1)){al.push(ad+";");ak=am}else{al.push("&")}ad=""}else{ad=ad+ah}}}}}if(ad!==""){al.push(ad)}return al};h.remove_deleted_tabs=function(af){var ae=false;for(var ad=0;ad<af.length;ad++){if(af[ad]==D){ae=true}else{if(ae==true){if(af[ad]==ab){ae=false}else{if(af[ad]=="\t"){af[ad]=" "}}}}}for(var ad=0;ad<af.length-2;ad++){if((af[ad]==D)&&(af[ad+1]==" ")&&(af[ad+2]==ab)){af.splice(ad,3);ad=ad-1}}for(var ad=0;ad<af.length-2;ad++){if((af[ad]==ac)&&(af[ad+2]==s)&&((af[ad+1]==" ")||(af[ad+1]=="\t"))){af.splice(ad+2,1);af.splice(ad,1)}}return af};h.fdiff3=function(aj,ai){var ah,af;var ae,ad;var ag;ah=h.split_punctuation(aj);af=h.split_punctuation(ai);ae=h.find_keyword_indices(ah);ad=h.find_keyword_indices(af);ag=h.recurse(ah,af,ae,ad);return h.remove_deleted_tabs(ag)};h.detect_language=function(aj){var ae=0,ad=0,ag=0;var ai="X";var ah,af;ad=1+(aj.split(/claim/i)).length-1+(aj.split(/characteri/i)).length-1+(aj.split(/according/i)).length-1;ae=1+(aj.split(/revendication/i)).length-1+(aj.split(/caract.ris/i)).length-1+(aj.split(/selon/i)).length-1;ag=1+(aj.split(/anspr.ch/i)).length-1+(aj.split(/gekennzeich/i)).length-1+(aj.split(/nach/i)).length-1;if(ad>=ag){ah=ad;af=ag}else{ah=ag;af=ad}if(ae>=ah){af=ah;ah=ae}else{if(ae>=af){af=ae}}if((ah/af)>=3){if(ah==ad){ai="E"}else{if(ah==ag){ai="D"}else{ai="F"}}}return ai};h.correct_missing_spaces=function(aj){var ai;ai=h.detect_language(aj);aj=aj.split(/\:/);aj=aj.join(": ");aj=aj.split(/\;/);aj=aj.join("; ");aj=aj.split(/\,/);aj=aj.join(", ");if(ai=="E"){aj=aj.split(/ ofa /);aj=aj.join(" of a ");aj=aj.split(/ wherein/);aj=aj.join(" wherein ");aj=aj.split(/ wherein :/);aj=aj.join(" wherein:");aj=aj.split(/ said/);aj=aj.join(" said ");aj=aj.split(/ and\/or/);aj=aj.join(" ANDSLASHOR ");aj=aj.split(/ and\,/);aj=aj.join(" ANDCOMMA ");aj=aj.split(/ and/);aj=aj.join(" and ");aj=aj.split(/ ANDSLASHOR /);aj=aj.join(" and/or");aj=aj.split(/ ANDCOMMA /);aj=aj.join(" and, ");aj=aj.split(/inthat/);aj=aj.join("in that");aj=aj.split(/ that/);aj=aj.join(" that ");aj=aj.split(/ that :/);aj=aj.join(" that:");aj=aj.split(/orfurther/);aj=aj.join("or further");aj=aj.split(/orwhere/);aj=aj.join("or where");aj=aj.split(/orthat/);aj=aj.join("or that")}if(ai=="E"){var ae=/(claim)(\d)/i;var ad=/(claims)(\d)/i;var ah;if((ah=ae.exec(aj))!=null){var af=/([\s\S]*)(claim)(\d+)([\s\S]*)/i;while((ah=af.exec(aj))!=null){aj=ah[1]+ah[2]+" "+ah[3]+ah[4]}}if((ah=ad.exec(aj))!=null){var ag=/([\s\S]*)(claims)(\d+)([\s\S]*)/i;while((ah=ag.exec(aj))!=null){aj=ah[1]+ah[2]+" "+ah[3]+ah[4]}}}return aj};h.ocr_cleanup=function(af){if(I==true){af=h.correct_missing_spaces(af)}af=h.handle_reference_signs(af);if(O==true){af=af.split(/\s+\)/);af=af.join(")");af=af.split(/\(\s+/);af=af.join("(");af=af.split(/\s+\]/);af=af.join("]");af=af.split(/\[\s+/);af=af.join("[");af=af.split(/\s+\,/);af=af.join(",");af=af.split(/\s+\;/);af=af.join(";");af=af.split(/\s+\:/);af=af.join(":");af=af.split(/\s+\./);af=af.join(".")}af=af.split("<RTI>");af=af.join("");af=af.split("<RTIgt;");af=af.join("");af=af.split("</RTI>");af=af.join("");af=af.replace(/\&/g,"AMPERSANDFOOBAR");af=af.replace(/\;/g,"&#59;");af=af.replace(/\:/g,"&#58;");af=af.replace(/AMPERSANDFOOBAR/g,"&amp;");af=af.replace(/\u2013|\u2014/g,"-");af=af.replace(/\u2018|\u2019|\u201A|\u0060/g,"'");af=af.replace(/\u201c|\u201d|\u201e/g,'"');af=af.split("<");af=af.join("&lt;");af=af.split(">");af=af.join("&gt;");if(M==true){af=af.replace(/\u00df/g,"ss")}af=af.split(/[ \t]+/);af=af.join(" ");af=af.split(/[\n\f\r]+/);af=af.join("\t");if(S==true){var ad=/(.*[a-zA-Z\u00e9\u00e8\u00f6\u00fc]+)\-\s*(\w+.*)/;var ae;while((ae=ad.exec(af))!=null){af=ae[1]+ae[2]}}return af};h.ocr_cleanup_desc=function(ag){var ad=j;var ae=S;var af;j=false;S=false;af=h.ocr_cleanup(ag);j=ad;S=ae;return af};h.form_claim_reg_exp=function(af){var ae;var ad;af=af.toString();ae=af.split("");re="";for(ad=0;ad<ae.length;ad++){if(ad>0){re=re+"\\s{0,1}"}if(ae[ad]==1){pat="[1,l,I,i]"}else{if(ae[ad]==2){pat="[2,Z,z]"}else{if(ae[ad]==5){pat="[5,S,s]"}else{if(ae[ad]==0){pat="[0,O,o]"}else{pat=ae[ad]}}}}re=re+pat}return re};h.handle_strict_patterns=function(ag,at,al,aj,au,an){var ah;var af;var aq=0;var ae=100000;var av=[];var ai;var ap;var am;var ao=false;var ak=[];if(typeof(an)=="undefined"){an=""}ah=new RegExp("(.*\\.\\s*)("+at+")(\\d+)("+al+")(.*)$",an);while((af=ah.exec(ag))!=null){claim_no=parseInt(af[3],10);if(typeof av[claim_no]!="undefined"){ao=true;ak.push(claim_no)}av[claim_no]=af[2]+af[3]+af[4]+af[5];ag=af[1];if(aq<claim_no){aq=claim_no}if(ae>claim_no){ae=claim_no}}v2="";ah=new RegExp("^(.*?)("+at+")(\\d+)("+al+")(.*)$",an);while((af=ah.exec(ag))!=null){claim_no=parseInt(af[3],10);ag=af[1];v2=af[2]+af[3]+af[4]+af[5]+v2;if((claim_no<ae)&&(claim_no>0)){av[claim_no]=v2;v2="";ae=claim_no}if(aq<claim_no){aq=claim_no}}if(ao==true){var ar="Warning: the following claims/paragraphs have been found multiple times:\n";ar=ar+ak.pop();while(ak.length>0){ar=ar+", "+ak.pop()}alert(ar+".\nPlease check the text in the input window.")}av[0]=ag;if(aq>1000){var ad=aq;aq=1000;while((aq>0)&&(typeof(av[aq])=="undefined")){aq--}alert("Something probably went wrong.\nHighest claim number detected: "+ad+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+aq+".")}am=0;for(c=1;c<=aq+3;c++){if(typeof av[c]=="undefined"){ah=new RegExp(h.form_claim_reg_exp(c));if(ah.test(av[am])){ah=new RegExp(aj+h.form_claim_reg_exp(c)+au);if(ah.test(av[am])){if(am==0){ah=new RegExp("(.*?)("+aj+h.form_claim_reg_exp(c)+au+")(.*)",an)}else{ah=new RegExp("(.*?[\\.\\s]+)("+aj+h.form_claim_reg_exp(c)+au+")(.*)",an)}if((af=ah.exec(av[am]))!=null){av[am]=af[1];av[c]=af[2]+af[3];am=c;if(c>aq){aq=c}}}}}else{am=c}}av.unshift(aq);return av};h.handle_square_brackets_type_claims=function(ad){return h.handle_strict_patterns(ad,"\\[","\\]","\\[[0oO\\s]*","\\s{0,1}\\]")};h.handle_siemens_type_claims=function(ae){var ad=h.detect_language(ae);if(ad=="E"){return h.handle_strict_patterns(ae,"\\[claim\\s+","\\]","\\[claim\\s+","\\s{0,1}\\]","i")}else{if(ad=="D"){return h.handle_strict_patterns(ae,"\\[anspruch\\s+","\\]","\\[anspruch\\s+","\\s{0,1}\\]","i")}else{if(ad=="F"){return h.handle_strict_patterns(ae,"\\[revendication\\s+","\\]","\\[revendication\\s+","\\s{0,1}\\]","i")}else{return[0,ae]}}}};h.handle_claim_type_claims=function(ae){var ad=h.detect_language(ae);if(ad=="E"){return h.handle_strict_patterns(ae,"claim\\s+","\\.","claim\\s+","\\s{0,1}\\.","i")}else{if(ad=="D"){return h.handle_strict_patterns(ae,"anspruch\\s+","\\.","anspruch\\s+","\\s{0,1}\\.","i")}else{if(ad=="F"){return h.handle_strict_patterns(ae,"revendication\\s+","\\.","revendication\\s+","\\s{0,1}\\.","i")}else{return[0,ae]}}}};h.count_matches=function(ag,ad){var af;var ae=0;while((af=ad.exec(ag))!=null){ae=ae+1;ag=af[1]}return ae};h.detect_claim_numbering_style=function(ah){var aw=/\.\s*\d+\.(.*)/;var ai=/^\d+\./;var av=/\[\d+\]\s+(.*)/;var ae=/\[\s*anspruch\s+\d+\s*\](.*)/i;var ad=/\[\s*revendication\s+\d+\s*\](.*)/i;var ay=/\[\s*claim\s+\d+\s*\](.*)/i;var at=/\.\s*\d+\/(.*)/;var aj=/^\d+\//;var ar=/\.\s*\d+\s{0,1}\-(.*)/;var an=/^\d+\s{0,1}\-/;var ap=/\.\s*\d+\)(.*)/;var af=/^\d+\)/;var aq=/\.\s*anspruch\s+\d+\.(.*)/i;var ao=/\.\s*revendication\s+\d+\.(.*)/i;var am=/\.\s*claim\s+\d+\.(.*)/i;var ak=[0,0,0,0,0,0,0,0,0,0,0,0];var ag;ak[g]=h.count_matches(ah,aw);if((matches=ai.exec(ah))!=null){ak[g]=ak[g]+1}ak[d]=h.count_matches(ah,av);ak[Z]=h.count_matches(ah,ae)+h.count_matches(ah,ad)+h.count_matches(ah,ay);ak[y]=h.count_matches(ah,aq)+h.count_matches(ah,ao)+h.count_matches(ah,am);ak[U]=h.count_matches(ah,at);if((matches=aj.exec(ah))!=null){ak[U]=ak[U]+1}ak[L]=h.count_matches(ah,ar);if((matches=an.exec(ah))!=null){ak[L]=ak[L]+1}var ax=j;j=true;var al=h.split_punctuation(ah);ag=al.join("");j=ax;ak[p]=h.count_matches(ag,ap);if((matches=af.exec(ag))!=null){ak[p]=ak[p]+1}largest_score=ak[e];largest_score_style=e;second_largest_score=0;second_largest_score_style=m;for(var au=e+1;au<=W;au++){if(ak[au]>second_largest_score){if(ak[au]>largest_score){second_largest_score=largest_score;second_largest_score_style=largest_score_style;largest_score=ak[au];largest_score_style=au}else{second_largest_score=ak[au];second_largest_score_style=au}}}if((largest_score_style==d)&&(largest_score>=10)){claim_style=largest_score_style}else{if((second_largest_score!=0)&&(largest_score<2*second_largest_score)){claim_style=m}else{claim_style=largest_score_style}}return claim_style};h.split_claims=function(al){var ao;var af;var ar=0;var aj=100000;var ah=[];var at;var aq;var ak;var ag=false;var ap=[];if(aa==true){at=h.detect_claim_numbering_style(al)}else{at=m}var ai="\\.";var an="[.,]";var ad="\\s{0,1}\\.";if(at==d){return h.handle_square_brackets_type_claims(al)}else{if(at==Z){return h.handle_siemens_type_claims(al)}else{if(at==y){return h.handle_claim_type_claims(al)}else{if(at==U){ai="\\/";an=ai;ad="\\s{0,1}\\/"}else{if(at==L){ai="\\s{0,1}\\-";an=ai;ad=ai}else{if(at==p){ai="\\)";an=ai;ad="\\s{0,1}\\)"}}}}}}ao=new RegExp("(.*\\.\\s+)(\\d+)("+ai+")(.*)$");while((af=ao.exec(al))!=null){claim_no=parseInt(af[2],10);if(claim_no>1000){al=af[1]+"["+af[2]+"]"+af[3]+af[4];continue}if(typeof ah[claim_no]!="undefined"){ag=true;ap.push(claim_no)}ah[claim_no]=""+claim_no+af[3]+af[4];al=af[1];if(ar<claim_no){ar=claim_no}if(aj>claim_no){aj=claim_no}}v2="";ao=new RegExp("^(.*?)(\\d+)("+ai+")(\\s+.*)$");while((af=ao.exec(al))!=null){claim_no=parseInt(af[2],10);al=af[1];v2=""+claim_no+af[3]+af[4]+v2;if((claim_no<aj)&&(claim_no>0)){ah[claim_no]=v2;v2="";aj=claim_no}if(ar<claim_no){ar=claim_no}}if(ag==true){var am="Warning: the following claims/paragraphs have been found multiple times:\n";am=am+ap.pop();while(ap.length>0){am=am+", "+ap.pop()}alert(am+".\nPlease check the text in the input window.")}ah[0]=al;if(typeof ah[1]=="undefined"){if((c=ah[0].indexOf("1 "))==0){ah[1]=ah[0];ah[0]=""}else{if((c=ah[0].indexOf(" 1 "))!==-1){ah[1]=ah[0].substring(c);ah[0]=ah[0].substring(0,c)}else{ao=new RegExp("^("+h.form_claim_reg_exp(1)+ad+")(.*)");if((af=ao.exec(ah[0]))!=null){ah[0]="";ah[1]=af[1]+af[2]}}}}if(ar>1000){var ae=ar;ar=1000;while((ar>0)&&(typeof(ah[ar])=="undefined")){ar--}alert("Something probably went wrong.\nHighest claim number detected: "+ae+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ar+".")}ak=0;for(c=1;c<=ar+15;c++){if(typeof ah[c]=="undefined"){if(ah[ak].indexOf("."+c)!==-1){ao=new RegExp("(.*?\\.)("+c+ai+")(\\s+.*)");if((af=ao.exec(ah[ak]))!=null){ah[ak]=af[1];ah[c]=af[2]+af[3];ak=c;if(c>ar){ar=c}}}}else{ak=c}}ak=0;for(c=1;c<=ar+3;c++){if(typeof ah[c]=="undefined"){if(ah[ak].indexOf(c)!==-1){ao=new RegExp("(.*?\\.\\s*)("+c+")(\\s+.*)");if((af=ao.exec(ah[ak]))!=null){if((af[1].length>=2)&&((af[1].charAt(af[1].length-2)>="0")&&(af[1].charAt(af[1].length-2)<="9"))){}else{ah[ak]=af[1];ah[c]=af[2]+af[3];ak=c;if(c>ar){ar=c}}}}}else{ak=c}}ak=0;for(c=1;c<=ar+3;c++){if(typeof ah[c]=="undefined"){ao=new RegExp(h.form_claim_reg_exp(c));if(ao.test(ah[ak])){ao=new RegExp("(.*?\\.\\s+)("+h.form_claim_reg_exp(c)+an+")(.*)");if((af=ao.exec(ah[ak]))!=null){ah[ak]=af[1];ah[c]=af[2]+af[3];ak=c;if(c>ar){ar=c}}}}else{ak=c}}if(at==g){ak=0;for(c=1;c<=ar+3;c++){if(typeof ah[c]=="undefined"){ao=new RegExp(h.form_claim_reg_exp(c));if(ao.test(ah[ak])){ao=new RegExp("(.*?\\s+)("+c+ai+"\\s{0,1})(\\D.*)");if((af=ao.exec(ah[ak]))!=null){ah[ak]=af[1];ah[c]=af[2]+af[3];ak=c;if(c>ar){ar=c}}}}else{ak=c}}}ak=0;for(c=1;c<=ar+3;c++){if(typeof ah[c]=="undefined"){ao=new RegExp(h.form_claim_reg_exp(c));if(ao.test(ah[ak])){ao=new RegExp("(.*?\\s+)("+h.form_claim_reg_exp(c)+ad+")(.*)");if((af=ao.exec(ah[ak]))!=null){ah[ak]=af[1];ah[c]=af[2]+af[3];ak=c;if(c>ar){ar=c}}}}else{ak=c}}for(c=1;c<=ar;c++){if(typeof ah[c]!="undefined"){ah[c]=h.fix_unclosed_brackets(ah[c])}}ah.unshift(ar);return ah};h.handle_double_paragraphs=function(aj){var al=/\[\d+\][^\S\t]+\[\d+\](.*)/;var af=/(.*?)\t(\[\d+\])([ ]+)(\[\d+\])(.*)/;var ad=/(.*?)(\[\d+\])(.*)/;var ag="";var ae="";if(aj==""){return aj}if(h.count_matches(aj,al)>=1){while((matches=af.exec(aj))!=null){var ai=matches[1];var ak=matches[2];var ah=matches[4];aj=matches[5];while((matches=ad.exec(ai))!=null){ai=matches[1]+matches[3];ag=ag+matches[2]}ae=ae+ai+"\t"+ah;ag=ag+ak}while((matches=ad.exec(aj))!=null){aj=matches[1]+matches[3];ag=ag+matches[2]}ae=ae+aj;return ae}return aj};h.split_desc=function(ah){if(ah==""){return[0,ah]}else{var ae;var ad=/\.\s*\[\d+\](.*)/;var ag=h.ocr_cleanup_desc(ah);if(h.count_matches(ag,ad)>=2){ag=h.handle_double_paragraphs(ag);ae=h.handle_square_brackets_type_claims(ag)}else{ae=ag.split(/[\t]+/);while((ae.length>0)&&(ae[ae.length-1]=="")){ae.pop()}ae.unshift("");ae.unshift(ae.length-1)}for(var af=1;af<ae.length;af++){if(typeof ae[af]!="undefined"){ae[af]=h.fix_unclosed_brackets(ae[af])}}return ae}};h.calculate_score_for_word=function(ad){if((ad=="claim")||(ad=="claims")||(ad=="according")||(ad=="characterised")||(ad=="characterized")||(ad=="Anspruch")||(ad=="Ansprüche")||(ad=="gekennzeichnet")||(ad=="revendication")||(ad=="revendications")||(ad=="caractérisé")||(ad=="caractérisée")){return 0}else{return ad.length}};h.count_added=function(ag){var ae=0;var af=0;var ad;for(ad=0;ad<ag.length;ad++){if(ag[ad]==ac){af=1}else{if(ag[ad]==s){af=0}else{if(ag[ad]==D){af=2}else{if(ag[ad]==ab){af=0}else{if(af==1){ae=ae+h.calculate_score_for_word(ag[ad])}}}}}}return ae};h.count_unchanged=function(ag){var af=0;var ae=0;var ad;for(ad=0;ad<ag.length;ad++){if(ag[ad]==ac){ae=1}else{if(ag[ad]==s){ae=0}else{if(ag[ad]==D){ae=2}else{if(ag[ad]==ab){ae=0;af=af-1}else{if(ae==0){af=af+h.calculate_score_for_word(ag[ad])}}}}}}if(af>0){return af}else{return 0}};h.is_short_word=function(ae){var af=["the","a"," ","of","in","and","to","is","that","der","die","das","dem","des","den","im","und","le","la","dans","que","de"];for(var ad=0;ad<af.length;ad++){if(ae==af[ad]){return 1}}return 0};h.cross_out_deleted=function(af){var ae=0;var ag=[];for(var ad=0;ad<af.length;ad++){if(af[ad]==D){ae=1}else{if(af[ad]==ab){ae=0}else{if(af[ad]==ac){ae=2}else{if(af[ad]==s){ae=0}else{if(ae==0){ag.push(af[ad])}else{if(ae==1){if(af[ad]==" "){ag.push(" ")}else{ag.push(Array(1+af[ad].length).join("-"))}}}}}}}}return ag};h.alert_array=function(ad){var ae=ad.join("-");alert(ae)};h.reset_feature_blocks=function(){f=[];G=[];K=[]};h.add_feature_for_claim=function(ae,af,ad){f.push(ae);G.push(af);K.push(ad)};h.find_feature_block_marker=function(ag,ad){var af=ag.indexOf(l,ad);var ae=ag.indexOf(T,ad);if((af<0)&&(ae>=0)){return ae}if((ae<0)&&(af>=0)){return af}if(af<ae){return af}else{return ae}};h.find_feature_blocks=function(ah,ai){var af=0;var ad=0,ag=0,ak=0;while((af=h.find_feature_block_marker(ai,af))>=0){if(ai.substr(af,2)==l){ak=ak+1}else{if(ai.substr(af,2)==T){ak=ak-1}}if(ak>ad){ad=ak}if(ak<ag){ag=ak}af=af+2}if((ad>1)||(ag<0)||(ak!=0)){alert("Unbalanced feature brackets [[ ... ]] found in claim "+ah+" -- ignoring all brackets");return ai}if((ad==0)&&(ag==0)){return ai}var ae=/(.*)\[\[(.*?)\]\](.*)/;var aj=0;while((matches=ae.exec(ai))!=null){h.add_feature_for_claim(ah,aj,matches[2]);ai=matches[1]+" "+r+aj+b+" "+matches[3];aj=aj+1}ai=(ai.split("  ")).join(" ");return ai};h.replace_feature_markers=function(ah){var ad=/(.*)\{\{\{(\d+)\}\}\}(.*)/;var af;var ae;var ag=0;if(ad.exec(ah.join(""))==null){return ah}ae=[];for(loop=0;loop<ah.length;loop++){if(ah[loop]==ac){ag=1}else{if(ah[loop]==s){ag=0}}if((af=ad.exec(ah[loop]))!=null){if(af[1].length>0){ae.push(af[1])}if(ag==1){ae.push(s);ae.push(ac)}if(af[2]<=f.length){atoms=K[af[2]].split(" ");for(i=0;i<atoms.length;i++){ae.push(atoms[i]);if(i!=atoms.length){ae.push(" ")}}}if(ag==1){ae.push(s);ae.push(ac)}if(af[3].length>0){ae.push(af[3])}}else{ae.push(ah[loop])}}return ae};h.collect_deleted_parts=function(ai){var ah=0;var aj,af,ak,ad=-1;var al;for(aj=ai.length-1;aj>=0;aj--){if(ai[aj]==ab){ad=aj}else{if(ai[aj]==D){for(af=aj-1;af>=0;af--){if(h.is_short_word(ai[af])){continue}else{if(ai[af]==s){for(ak=af-1;ak>=0;ak--){if(ai[ak]==ac){break}}if((ak>=0)&&(ad>0)){if(aj-af>1){short_words=ai.splice(af+1,aj-af-1);Array.prototype.splice.apply(ai,[af,0].concat(short_words));af=af+short_words.length;Array.prototype.splice.apply(ai,[aj+1,0].concat(short_words));ad=ad+short_words.length}var ae=af-ak+1;added_block=ai.splice(ak,ae);aj=aj-ae;af=aj;ad=ad-ae;Array.prototype.splice.apply(ai,[ad+1,0].concat(added_block))}else{alert("Warning: this should not happen (E101)");return ai}}else{if(ai[af]==ab){if(af==aj-1){for(start_other_del=af-1;start_other_del>=0;start_other_del--){if(ai[start_other_del]==D){break}}if(start_other_del>=0){ai.splice(af,2);aj=start_other_del;af=aj;ad=ad-2}}else{break}}else{break}}}}}}}for(var ag=0;ag<ai.length-1;ag++){if(((ai[ag]==ab)&&(ai[ag+1]==D))||((ai[ag]==s)&&(ai[ag+1]==ac))){ai.splice(ag,2)}}return ai};h.remove_deleted=function(af){var ae=0;var ag=[];for(var ad=0;ad<af.length;ad++){if(af[ad]==D){ae=1}else{if(af[ad]==ab){ae=0}else{if(ae==0){ag.push(af[ad])}}}}return ag};h.remove_short_unchanged=function(af){var ag=[];for(var ae=0;ae<af.length;ae++){if(af[ae]==ac){for(var ad=ag.length-1;ad>=0;ad--){if(!h.is_short_word(ag[ad])||ag[ad]==s){break}}if(ad<0){ag.unshift(ac);continue}else{if(ag[ad]==s){ag.splice(ad,1);continue}}}ag.push(af[ae])}for(var ad=ag.length-1;ad>=0;ad--){if(!h.is_short_word(ag[ad])||ag[ad]==s){break}}if((ad>=0)&&(ag[ad]==s)){ag.splice(ad,1);ag.push(s)}return ag};h.remove_tags=function(ad){ad=(ad.split(ac)).join("");ad=(ad.split(s)).join("");ad=(ad.split(D)).join("");ad=(ad.split(ab)).join("");return ad};h.get_color_string=function(ae){var ad=["yellow","cyan","lime","orange","lightskyblue","lightgreen","coral","gold","violet","silver","pink","lightsalmon","tomato"];max_color=12;if(ae==0){the_color=0}else{the_color=1+((ae-1)%max_color)}return'<span style="BACKGROUND-COLOR: '+ad[the_color]+'">'};h.get_color_string_end=function(){return"</span>"};h.get_color_string_and_update_legend_for_claim=function(ae,ad){var af=new RegExp('BACKGROUND-COLOR: (\\w+)">'+ae+h.get_color_string_end());for(leg=1;leg<ad.length;leg++){if(af.exec(ad[leg])!=null){break}}if(leg==ad.length){ad.push(" "+h.get_color_string(leg)+ae+h.get_color_string_end())}return h.get_color_string(leg)};h.make_single_added=function(ae){var ad;var af=[];for(ad=0;ad<ae.length;ad++){if((ae[ad]!=ac)&&(ae[ad]!=s)){af.push(ae[ad])}}if(af.length>0){af.unshift(ac);af.push(s)}while(ae.length>0){ae.pop()}while(af.length>0){ae.push(af.shift())}return};h.format_claim_span=function(ah,al){var ad="";var ak=-1;var am=-1;var ai=[];var aj=[];var ae=false;for(var ag=1;ag<=al;ag++){if(typeof ah[ag]!="undefined"){ai.push(ag)}else{ae=true}}if(ai.length==0){return"None"}for(var af=0;af<ai.length;af++){if((ai[af]-am==1)){am=ai[af]}else{if(ak>0){if((am-ak)>=2){ad=ad+ak+"-"+am+","}else{if((am-ak)==1){ad=ad+ak+","+am+","}else{ad=ad+ak+","}}}ak=ai[af];am=ai[af]}}if((am-ak)>=2){ad=ad+ak+"-"+am}else{if((am-ak)==1){ad=ad+ak+","+am}else{ad=ad+ak}}if(ae){ad=ad+" (Warning: irregularly numbered set, please check input)"}return ad};h.split_into_added_unchanged_added=function(al,ah,ar,ap){var an,am;var ai,ae;var ao,ag,aq;var ad,ak,af;var aj;aq=0;ao=0;ag=0;af=0;ad=0;ak=0;ae=0;ai=0;for(an=0;an<al.length;an++){if(al[an]==ac){aj=true;ai=an;ae=0}else{if(al[an]==s){if(ae>R){ak=ai-1;if(af>aq){ao=ad;ag=ak;aq=af}ad=an+1;ak=an+1;af=0}else{ak=an}aj=false}else{if(aj){ae=ae+al[an].length}else{af=af+al[an].length;ak=an}}}}if(af>aq){ao=ad;ag=ak;aq=af}for(an=0;an<ao;an++){ah.push(al[an])}for(an=ao;an<=ag;an++){ar.push(al[an])}for(an=ag+1;an<al.length;an++){ap.push(al[an])}h.make_single_added(ah);h.make_single_added(ap);return};h.recode_added_parts=function(aj,al,ad,ae){var am,ak,an,ar,aw;var ag,ao;var av,ap;var af;am=ak=an=ar=ag=ao=[];ap=0;k++;if(o==true){af="|"}else{af=""}for(av=0;av<ad.length;av++){if(ad[av]==ac){ap=1;ak=[];if(k==1){ar.push(ad[av])}continue}else{if(ad[av]==s){ap=2;coded_yet=0;if(h.count_added([ac].concat(ak,s))>R){max_score=0;aw=0;var at,ai;for(var aq=1;aq<=al;aq++){if(typeof aj[aq]=="undefined"){continue}at=h.fdiff3(aj[aq],ak.join(""));at=h.remove_deleted(at);if((diff_score=h.count_unchanged(at))>max_score){aw=aq;max_score=diff_score}}if(max_score>R){var ah,ax,au;at=h.fdiff3(aj[aw],ak.join(""));at=h.remove_deleted(at);ah=[];ax=[];au=[];h.split_into_added_unchanged_added(at,ah,ax,au);ag=h.recode_added_parts(aj,al,ah,ae);ar=ar.concat(ag);ar.push("<SPAN>"+af);if(o){ar.push(h.get_color_string_and_update_legend_for_claim(aw,ae))}else{ar.push(h.get_color_string(ae.length));ae.push(" "+h.get_color_string(ae.length)+aw+h.get_color_string_end())}mode2=0;for(d2=0;d2<ax.length;d2++){if(ax[d2]==D){mode2=1;alert("This should not happen. Code 1.")}else{if(ax[d2]==ab){mode2=0;alert("This should not happen. Code 2.")}else{if(ax[d2]==ac){ar.push(h.get_color_string(0))}else{if(ax[d2]==s){ar.push(h.get_color_string_end())}else{if(mode2==0){ar.push(ax[d2])}}}}}}ar.push(h.get_color_string_end());ai=h.fdiff3(aj[aw],h.remove_tags(ax.join("")));ar.push(af+'</SPAN><SPAN class="tooltip">'+ai.join("")+"</SPAN>");ao=h.recode_added_parts(aj,al,au,ae);ar=ar.concat(ao);coded_yet=1}}if(!coded_yet){ar.push(h.get_color_string(0));ar=ar.concat(ak);ar.push(h.get_color_string_end())}if(k==1){ar.push(s)}}}if(ap==0){ar.push(ad[av])}else{if(ap==1){ak.push(ad[av])}else{if(ap==2){ap=0}}}}k--;return ar};h.get_main_base_claim=function(ae){for(var af=0;af<t.length;af++){if(t[af]==ae){var ad=/^(\d+)/;var ag;if((ag=ad.exec(z[af]))!=null){var ah=parseInt(ag[1]);if(ah<0){alert('Base value "'+base+'"out of bounds');return -1}else{return ah}}}}return -1};h.get_claim_base_exclusions=function(aq,aw,aj,ai){var al=0;var ag;var ae=false;if(ai==false){aj=0;ag=z}else{ag=z.slice(0)}for(var ak=0;ak<t.length;ak++){if(t[ak]==aq){if((ag[ak].search("!")>=0)&&(ag[ak].search("&")>=0)){alert("Error in base override for claim "+aq+"\nCan't both include (&) and exclude (!) claims");return[]}var ap=/(.*)\[(\d+)\](.*)/;var af;while((af=ap.exec(ag[ak]))!=null){if((Math.round(af[2])<=aj)&&(Math.round(af[2])!=0)){ag[ak]=af[1]+(aw+parseInt(af[2]))+af[3];ae=true}else{if(ai==true){alert("Error in base override for claim "+aq+"\nInvalid paragraph number ["+af[2]+"] encountered.")}else{if(ag[ak].search("&")>=0){alert("Error in base override for claim "+aq+":\nuse of description not selected.")}}ag[ak]=af[1]+af[3]}}var ar=ag[ak].split(/[0-9!&\-\,]+/);if((ar=ar.join(""))!==""){alert("Error in base override for claim "+aq+"\nInvalid character(s) "+ar+' encountered.\n\nValid examples: "5!8,9,12-15,38-40" or "&8,9,12-15,38-40"');return[]}var au=ag[ak];var ad=/(.*?)(\d+)\-(\d+)(.*)/;var af,ah,ao;while((af=ad.exec(au))!=null){ah=parseInt(af[2]);ao=parseInt(af[3]);if(ah>=ao){alert("Invalid base override range ("+af[2]+"-"+af[3]+") for claim "+aq+".");return[]}au=""+af[1]+af[2];for(var av=ah+1;av<=ao;av++){au=au+","+av}au=au+af[4]}au=au.split(/[!&,]/);au.shift();if(ag[ak].search("!")>=0){return au}else{if(ag[ak].search("&")>=0){if((ae==false)&&(ai==true)){aj=0}var at=[];for(var an=1;an<=aw+aj;an++){for(var am=0;am<au.length;am++){if(au[am]==an){break}}if(am==au.length){at.push(an)}}return at}}break}}return[]};h.get_base_text_for_claim=function(ad){for(var ae=0;ae<t.length;ae++){if(t[ae]==ad){return z[ae]}}return""};h.insert_in_score_list=function(ae,ad,af){ae.push(ad);ae.push(af);for(var ag=(ae.length/2)-2;ag>=0;ag--){if(af<=ae[ag*2+1]){break}ae[(ag+1)*2]=ae[ag*2];ae[(ag+1)*2+1]=ae[ag*2+1];ae[ag*2]=ad;ae[ag*2+1]=af}return};h.show_dependency_table=function(af,ai){var ae="<B>Claim dependency table:</B><BR>";var ad;for(var ag=1;ag<=ai;ag++){if(typeof(af[ag])=="undefined"){continue}ad="    "+ag+": ";ae=ae+ad.substr(-5);for(var ah=1;ah<=ag;ah++){if(ag==ah){ae=ae+"x "}else{if(typeof(af[ag][ah])=="undefined"){ae=ae+"- "}else{ae=ae+af[ag][ah]+" "}}}ae=ae+"<BR>"}return ae};h.format_claim_tree_recursive=function(am,ai,al,af,ae,aj){if(typeof(am[ai])=="undefined"){return ae}if(ae.indexOf("-"+ai+"-")>=0){return ae}var ak="";if(typeof(aj)!="undefined"){if(typeof(aj[ai])!="undefined"){ak="<SUP>("+aj[ai]+")</SUP>"}}for(var ag=1;ag<af;ag++){ae=ae+"| "}if(af>0){ae=ae+"+ "}else{if(af==0){ae=ae+"<BR>"}}if(af==0){ae=ae+"<BR>-<B>"+ai+"</B>-"+ak+"<BR>"}else{ae=ae+"-"+ai+"-"+ak+"<BR>"}for(var ah=ai+1;ah<=al;ah++){if(ae.indexOf("-"+ah+"-")>=0){continue}else{if(typeof(am[ah])=="undefined"){continue}else{if(am[ah][ai]==1){for(var ad=ai-1;ad>0;ad--){if(am[ah][ad]==1){break}}if(ad==0){if(typeof(aj)!="undefined"){if(typeof(aj[ah])!="undefined"){if(typeof(aj[ai])!="undefined"){aj[ah]=aj[ah]+";"+aj[ai]}}}ae=h.format_claim_tree_recursive(am,ah,al,af+1,ae,aj)}}}}}return ae};h.format_claim_tree=function(ad,av,ai){var aj="";for(var an=1;an<=av;an++){aj=h.format_claim_tree_recursive(ad,an,av,0,aj,ai)}var am=aj.split("<BR>");while((am.length>0)&&(am[0]=="")){am.shift()}for(var an=1;an<am.length;an++){am[an]=am[an].split(" ")}for(var ao=0;ao<av;ao++){last="";for(var an=am.length-1;an>=1;an--){if(typeof(am[an][ao])=="undefined"){last="";continue}else{if(am[an][ao]=="|"){if(last==""){am[an][ao]=" "}}else{if(am[an][ao]=="+"){last="+"}else{last=""}}}}}for(var an=1;an<am.length;an++){am[an]=am[an].join(" ")}aj=am.join("<BR>");aj=aj.split("-");aj=aj.join("");aj=aj.split("+ ");aj=aj.join("+-");var ar=/(.*)<SUP>\((.*?)\)<\/SUP>(.*)/;var al=/(.*?)\;(.*)/;var ak=/(\d+)/;var ag,au;while((ag=ar.exec(aj))!=null){if((au=al.exec(ag[2]))!=null){base_and_support=au[1].split(",")}else{base_and_support=ag[2].split(",")}base_and_support[0]="<b><u>"+base_and_support[0]+"</u></b>";for(var ap=1;ap<base_and_support.length;ap++){base_and_support[ap]="<b>"+base_and_support[ap]+"</b>"}if(au!=null){ag[2]=base_and_support.join(",")+","+au[2]}else{ag[2]=base_and_support.join(",")}ag[2]=ag[2].split(";");ag[2]=ag[2].join(",");var ae=[];var ah=[];var at;var af=ag[2].split(",");for(var aq=0;aq<af.length;aq++){if((at=ak.exec(af[aq]))!=null){value=Math.round(at[1]);for(var ap=0;ap<ae.length;ap++){if(ae[ap]>=value){break}}if((ap==ae.length)||(ae[ap]!=value)){ae.splice(ap,0,value);ah.splice(ap,0,af[aq])}}}ag[2]=ah.join(",");aj=ag[1]+"<sup>("+ag[2]+")</sup>"+ag[3]}return aj};h.remove_claim_tree_deps=function(ad){var ae=/(.*)\((.*?)\)(.*)/;var ag;while((ag=ae.exec(ad))!=null){var ah=[];legend=ag[2].split(/,/);for(var af=0;af<legend.length;af++){if(legend[af].indexOf("<b>")>=0){ah.push(legend[af])}}ad=ag[1]+"{"+ah.join(",")+"}"+ag[3]}ad=ad.split(/\{/);ad=ad.join("(");ad=ad.split(/\}/);ad=ad.join(")");return ad};h.remove_claim_tree_deps_and_support=function(ad){var ae=/(.*)<sup>\((.*?)\)<\/sup>(.*)/;var af;while((af=ae.exec(ad))!=null){ad=af[1]+af[3]}return ad};h.do_claim_tree_analysis=function(am,ae,au,aj){var aq=/(\w+)(\s+)([C,c]laim)([s]*)(and|or|\s|\,|\-|\d)+(\w+)/;var an=" to - zu bis à ";var ao=" or , and oder ou ";var ai;var ar=[];var at=[];var ad="";var al=0;var ap;at=new Array(ae+1);for(var ah=1;ah<=ae;ah++){if(typeof(am[ah])=="undefined"){continue}ap=false;at[ah]=new Array(ah);for(var ag=0;ag<ah;ag++){at[ah][ag]=0}words=h.split_punctuation(am[ah]);for(w1=2;w1<words.length;w1++){var ak=words[w1].toLowerCase();if(((ak.indexOf("claim")>=0)&&(ak.indexOf("claimed")<0))||(ak.indexOf("anspruch")>=0)||(ak.indexOf("ansprüche")>=0)||(ak.indexOf("revendication")>=0)){w1++;break}}var af=false;al=-1;for(;w1<words.length;w1++){if(words[w1].charAt(0)==" "){continue}the_number=parseInt(words[w1],10);if(the_number>0){if(the_number==ah){alert(au+ah+" refers back to itself")}else{if(the_number>ah){alert(au+ah+" refers back to a higher claim")}else{at[ah][the_number]=1;if(af==false){al=the_number}else{to_number=the_number;if(to_number<=al){alert(au+ah+" has a malformed dependency range ("+al+" to "+to_number+")")}else{for(d1=al+1;d1<=to_number;d1++){at[ah][d1]=1}}af=false}}}ap=true}else{if((al>0)&&(an.indexOf(words[w1])>=0)){af=true}else{if(ao.indexOf(words[w1])<0){break}}}}if(ap==false){lower_claim=am[ah].toLowerCase();lower_claim=lower_claim.replace(/\s+/g," ");lower_claim=lower_claim.replace(/voranstehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorangehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorhergehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgenannt/g,"vorstehend");lower_claim=lower_claim.replace(/vorangegangen/g,"vorstehend");lower_claim=lower_claim.replace(/vorherig/g,"vorstehend");lower_claim=lower_claim.replace(/bisherig/g,"vorstehend");if((lower_claim.indexOf("preceding claims")>=0)||(lower_claim.indexOf("previous claims")>=0)||(lower_claim.indexOf("above claims")>=0)||(lower_claim.indexOf("foregoing claims")>=0)||(lower_claim.indexOf("revendications pr")>=0)||(lower_claim.indexOf("den vorstehenden anspr")>=0)){for(d1=1;d1<ah;d1++){at[ah][d1]=1}}else{if((lower_claim.indexOf("the preceding claim")>=0)||(lower_claim.indexOf("the previous claim")>=0)||(lower_claim.indexOf("the above claim")>=0)||(lower_claim.indexOf("the foregoing claim")>=0)||(lower_claim.indexOf("la revendication pr")>=0)||(lower_claim.indexOf("dem vorstehenden anspr")>=0)){at[ah][ah-1]=1}else{if((lower_claim.indexOf("preceding claim")>=0)||(lower_claim.indexOf("previous claim")>=0)||(lower_claim.indexOf("above claim")>=0)||(lower_claim.indexOf("foregoing claim")>=0)||(lower_claim.indexOf("revendication pr")>=0)||(lower_claim.indexOf("vorstehenden anspr")>=0)){for(d1=1;d1<ah;d1++){at[ah][d1]=1}}else{if((lower_claim.indexOf("claim")>=0)||(lower_claim.indexOf("revendication")>=0)||(lower_claim.indexOf("anspr")>=0)){if(lower_claim.indexOf("claim sets")<0){alert(au+ah+"'s dependency not understood, treating as independent.")}}}}}}}ad="<PRE><CODE>"+h.format_claim_tree(at,ae,aj)+"</CODE></PRE>";return ad};var J=[];var Q=0;var n=0;var C=[];h.reset_score_matrix=function(ad,ae){J=[];Q=0;n=0;return};h.set_score_matrix_max=function(ae,ad){C[ae]=ad};h.set_score_matrix_value=function(af,ad,ae){if(typeof(J[af])=="undefined"){J[af]=[]}if(af>Q){Q=af}if(ad>n){n=ad}J[af][ad]=ae;return};var q=["#808080","#909090","#a0a0a0","#b0b0b0","#c0c0c0","#d0d0d0","#e0e0e0","#f0f0f0","#ffff00","#f0ff00","#d0ff00","#b0ff00","#90ff00","#80ff00","#60ff00","#40ff00","#00ff00"];h.score_matrix_score_colour=function(ad){if(ad>=100){return q[16]}if(ad<=0){return q[0]}return q[Math.floor(ad*16/100)]};h.format_score_matrix=function(){var ae="";var af;var ad=[];for(let row=1;row<=Q;row++){if(typeof(J[row])=="undefined"){continue}ad[row]=[];af=1;for(let col=1;col<=n;col++){if(typeof(J[row][col])!="undefined"){if(J[row][col]>af){af=J[row][col]}}}for(let col=1;col<=n;col++){if(typeof(J[row][col])!="undefined"){ad[row][col]=100*J[row][col]/af;J[row][col]=100*J[row][col]/C[row]}}}ae=ae+"<BR><H2>Score matrix</H2>";ae=ae+"<TABLE class='fdiff4' BORDER=1><TR><TH style='width:30px'>%</TH>";for(col=1;col<=n;col++){ae=ae+"<TH style='width:30px'>"+col+"</TH>"}ae=ae+"<TH>old</TH>";ae=ae+"</TR>";for(row=1;row<=Q;row++){if(typeof(J[row])!="undefined"){ae=ae+"<TR><TD><B>"+row+"</B></TD>";for(col=1;col<=n;col++){if(typeof(J[row][col])!="undefined"){ae=ae+"<TD bgcolor='"+h.score_matrix_score_colour(ad[row][col])+"'>"+J[row][col].toFixed(0)+"</TD>"}else{ae=ae+"<TD>&nbsp;</TD>"}}ae=ae+"<TD>&nbsp;</TB></TR>"}}ae=ae+"<TR><TD><B>new</B></TD>";for(col=1;col<=n;col++){ae=ae+"<TD>&nbsp;</TD>"}ae=ae+"</TR>";ae=ae+"</TABLE>";if(false){ae=ae+"<TABLE>";ae=ae+"<TR>";for(let col=0;col<=16;col++){ae=ae+"<TD bgcolor='"+q[col]+"'>&nbsp;</TD>"}ae=ae+"</TR>";ae=ae+"</TABLE>"}return ae};h.insert_line_breaks=function(ae,aj){if((Y==false)&&(P==false)){ae=ae.split(/\t/);ae=ae.join("<BR>\n");return ae}if(Y==true){ae=ae.split("&#59;");ae=ae.join("&#59;<BR>");ae=ae.split("&#58;");ae=ae.join("&#58;<BR>")}if(P==true){ae=ae.split(",");ae=ae.join(",<BR>")}var ai;var ak="OPEN_BRACKET_FOO_FOO_FOO";var af="CLOSE_BRACKET_FOO_FOO_FOO";var ah=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ai=ah.exec(ae))!=null){var ad=ai[2].split("<BR>");ad=ad.join("");ae=ai[1]+ak+ad+af+ai[3]}ae=ae.split(ak);ae=ae.join("(");ae=ae.split(af);ae=ae.join(")");ae=ae.split("<BR> <BR>");ae=ae.join("<BR>");ae=ae.split("<BR><BR>");ae=ae.join("<BR>");ae=ae.split("<BR><BR>");ae=ae.join("<BR>");ae=ae.split(" <BR>");ae=ae.join("<BR>");ae=ae.split("<BR>");ae=ae.join("<BR>&nbsp;&nbsp;&nbsp;");if(aj){ae=ae.replace(/\d+\./g,function ag(al){return"<BR><BR>"+al})}return ae};h.post_cleanup=function(af,ai){if(H==true){deleted_parts=af.split(D);if(deleted_parts.length>0){var ah,ae,ad;ae=new RegExp(D+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+ab+ac+h.get_color_string(0)+"([A-Za-zÀ-ÿ]+)"+h.get_color_string_end()+s+"([\\S\\s]*)");ad=new RegExp(D+"([A-Za-zÀ-ÿ]+)"+ab+ac+h.get_color_string(0)+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+h.get_color_string_end()+s+"([\\S\\s]*)");af=deleted_parts[0];for(var ag=1;ag<deleted_parts.length;ag++){deleted_parts[ag]=D+deleted_parts[ag];if((ah=ae.exec(deleted_parts[ag]))!=null){if(ah[4]===(ah[1]+ah[3])){deleted_parts[ag]=ah[1]+ah[2]+ah[3]+ah[5]}}if((ah=ad.exec(deleted_parts[ag]))!=null){if(ah[1]===(ah[2]+ah[4])){deleted_parts[ag]=ah[2]+ah[3]+ah[4]+ah[5]}}af=af+deleted_parts[ag]}}}if(ai==false){if(A==true){highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+D}else{highlight_and_rem_start='<span style="BACKGROUND-COLOR: LightGrey">'+D}highlight_and_rem_end=ab+h.get_color_string_end();af=(af.split(D)).join(highlight_and_rem_start);af=(af.split(ab)).join(highlight_and_rem_end)}if((ai==true)&&(x==true)){highlight_and_add_start=h.get_color_string(0)+ac;highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+D;highlight_and_add_end=s+h.get_color_string_end();highlight_and_rem_end=ab+h.get_color_string_end();af=(af.split(ac)).join(highlight_and_add_start);af=(af.split(D)).join(highlight_and_rem_start);af=(af.split(s)).join(highlight_and_add_end);af=(af.split(ab)).join(highlight_and_rem_end)}af=h.insert_line_breaks(af,ai);return af};h.split_and_diff=function(aQ,aP,aN){var aH,aF,aj;var ax,aw,am;var aO,ak;var aq;var ay;var ae;var aA,al;var at="";var aL,aJ,aI;var ao;var aM=aQ;var aK=aP;var au="text";var av=[];var az=/\[\d+\]/;if(aN=="DESCMAGICFOO"){au="para";aH=h.split_desc(aQ);aF=h.split_desc(aP);ax=aH.shift();aw=aF.shift();if(ax<1){return"No original description paragraph(s) detected -- doing whole text comparison <HR>\n"+h.diff(aM,aK)}aN=""}else{au="claim";aQ=h.ocr_cleanup(aQ);aP=h.ocr_cleanup(aP);aH=h.split_claims(aQ);aF=h.split_claims(aP);ax=aH.shift();aw=aF.shift();if(ax<1){return"No original claim number(s) detected -- doing whole text comparison <HR>\n"+h.diff(aM,aK)}if(B.length>0){aO=h.split_desc(aN);ak=aO.shift()}else{aO=[];ak=0}}at=at+"<TABLE class='fdiff4' BORDER=1><TR class='fdiff4'><TH class='fdiff4'>New<BR>"+au+"</TH><TH class='fdiff4'>Old<BR>"+au+"</TH><TH class='fdiff4 noprint'>Base<BR>override</TH>";if(au=="claim"){at=at+"<TH class='fdiff4 noprint'>Use<BR>desc</TH>"}at=at+"<TH class='fdiff4'><DIV contenteditable>"+E+"</DIV></TH></TR>\n";if((typeof aF[0]!="undefined")&&(aF[0]!="")){at=at+"<TR class='fdiff4'><TD class='fdiff4'></TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD>";if(au=="claim"){at=at+"<TD class='fdiff noprint'>&nbsp;</TD>"}at=at+"<TD class='fdiff4'>"+aF[0]+"</TD></TR>\n"}h.reset_feature_blocks();h.reset_score_matrix();for(c2=1;c2<=aw;c2++){first_absent=c2;while((c2<aw)&&((typeof aF[c2]=="undefined")||(aF[c2]==""))){c2++}if(c2>first_absent){at=at+"<TR class='fdiff4'><TD class='fdiff4'>"+first_absent;if(c2>(first_absent+1)){at=at+"-"+(c2-1)}at=at+"</TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD><TD class='fdiff4'></TD></TR>\n"}ao=R;score_list=[];best_claim=-1;aA=false;if((best_claim=h.get_main_base_claim(c2))>=0){if((best_claim>0)&&(typeof aH[best_claim]=="undefined")){alert("Base "+au+" "+best_claim+" for "+au+" "+c2+" not found in original "+au+"s!");best_claim=-1}else{aA=true}}al=false;for(var ae=0;ae<B.length;ae++){if(B[ae]==c2){al=true;break}}if(al==false){for(var aD=0;aD<t.length;aD++){if(t[aD]==c2){if(z[aD].search(az)>=0){al=true;if(ak==0&&aN!=""){aO=h.split_desc(aN);ak=aO.shift()}}}}}aF[c2]=h.find_feature_blocks(c2,aF[c2]);for(var ai=1;ai<=ax;ai++){if(typeof aH[ai]=="undefined"){continue}aq=h.fdiff3(aH[ai],aF[c2]);diff_score=h.count_unchanged(aq);if(diff_score>ao){if(aA==false){best_claim=ai}ao=diff_score}h.insert_in_score_list(score_list,ai,diff_score);h.set_score_matrix_value(c2,ai,diff_score)}aq=h.fdiff3(aF[c2],aF[c2]);diff_score=h.count_unchanged(aq);h.set_score_matrix_max(c2,diff_score);aj=aH.slice();var ah=h.get_claim_base_exclusions(c2,ax,ak,al);am=ax;if((ak>0)&&(al==true)){for(var ae=1;ae<=ak;ae++){aj[ax+ae]=aO[ae]}am=ax+ak}for(var af=0;af<ah.length;af++){ai=ah[af];if((ai>0)&&(ai<=am)){aj[ai]=undefined;aA=true}else{if(ai==0){for(ai=0;ai<=am;ai++){aj[ai]=undefined}aA=true}}}if(best_claim>0){ay=[best_claim];aq=h.fdiff3(aH[best_claim],aF[c2])}else{ay=["N/A"];aq=h.fdiff3("",aF[c2])}aq=h.replace_feature_markers(aq);aq=h.collect_deleted_parts(aq);aq=h.recode_added_parts(aj,am,aq,ay);at=at+"<TR class='fdiff4'><TD class='fdiff4'>"+c2+"</TD><TD class='fdiff4'>";if(best_claim>0){at=at+"<SPAN>"+ay[0]+'</SPAN><SPAN class="tooltip">'+aH[best_claim]+"</SPAN>"}else{at=at+ay[0]}claim_tree_legend=""+ay[0];for(ae=1;ae<ay.length;ae++){var ar=/([\S\s]+>)(\d+)(<[\s\S]+)/;var ad,ap;var an=ay[ae];if((ad=ar.exec(ay[ae]))!=null){ap=parseInt(ad[2]);if(ap>ax){desc_para=ap-ax;an="<SPAN>"+ad[1]+"["+desc_para+"]"+ad[3]+'</SPAN><SPAN class="tooltip">'+aj[ap]+"</SPAN>";claim_tree_legend_text=",["+desc_para+"]"}else{an="<SPAN>"+ay[ae]+'</SPAN><SPAN class="tooltip">'+aH[ap]+"</SPAN>";claim_tree_legend_text=","+ap}if((ap!=ay[0])&&(claim_tree_legend.indexOf(claim_tree_legend_text)<0)){claim_tree_legend=claim_tree_legend+claim_tree_legend_text}}at=at+an}av[c2]=claim_tree_legend;at=at+"</TD><TD class='fdiff4 noprint' align='center'>";if(aA==true){at=at+'<INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'" value="'+h.get_base_text_for_claim(c2)+'">'}else{at=at+' <INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'">'}loop_end=score_list.length/2;if(loop_end>3){loop_end=3}for(ae=1;ae<loop_end;ae++){at=at+'<BR><span style="font-size:smaller">'+score_list[ae*2]+"="+Math.round((score_list[ae*2+1]*100)/score_list[1])+"% </span>"}if(au=="claim"){at=at+"</TD><TD class='fdiff4 noprint' align='center'>";if(al==true){at=at+'<INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'" checked>'}else{at=at+' <INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'">'}}at=at+"</TD><TD class='fdiff4'><DIV contenteditable>";var ag="";for(ae=0;ae<aq.length;ae++){ag=ag+aq[ae]}at=at+h.post_cleanup(ag,0)+"</DIV></TD></TR>\n"}at=at+"</TABLE>\n";aL=h.format_claim_span(aH,ax);aJ=h.format_claim_span(aF,aw);at=at+"<p>Original "+au+"s detected: "+aL+"<br>Amended "+au+"s detected: "+aJ;if((N==true)&&((aL.search("Warn")>-1)||(aJ.search("Warn")>-1))){alert("At least one of the detected "+au+" sets has irregular numbering.\nPlease verify that all "+au+" are properly identified and edit the text if necessary.\n\nYou can turn this message off by de-selecting the option below.")}if(au=="claim"){if(B.length>0){aI=h.format_claim_span(aO,ak);at=at+"<br>Original description paragraphs detected: "+aI}else{at=at+"<br>(Description not analyzed)"}if(v==true){var aG=h.do_claim_tree_analysis(aH,ax,"Original claim ");var aE=h.do_claim_tree_analysis(aF,aw,"Amended claim ",av);var aC=h.remove_claim_tree_deps(aE);var aB=h.remove_claim_tree_deps_and_support(aE);at=at+"<BR><H2>Claim trees</H2>";at=at+"<TABLE class='fdiff4' cellpadding='10' border=1><TR class='fdiff4'><TH class='fdiff4'> Original </TH><TH class='fdiff4'> Amended </TH><TH class='fdiff4'> Amended (+supt)</TH><TH class='fdiff4'> Amended (+supt +deps)</TH></TR><TR class='fdiff4'><TD valign='top' style='vertical-align: top !important'>";at+=aG;at+="</TD><TD valign='top' style='vertical-align: top !important'>";at+=aB;at+="</TD><TD valign='top' style='vertical-align: top !important'>";at+=aC;at+="</TD><TD valign='top' style='vertical-align: top !important'>";at+=aE;at+="<BR><BR>&nbsp;&nbsp;<U>Legend:</U><BR>&nbsp;&nbsp;<SUP>(<B><U>2</U></B>)</SUP> base claim<BR>&nbsp;&nbsp;<SUP>(<B>3</B>)</SUP> support claim<BR>&nbsp;&nbsp;<SUP>(4)</SUP> inherited from parent";at=at+"</TD></TR></TABLE>"}if(X==true){at=at+h.format_score_matrix()}}return at};h.diff=function(ak,aj){var ai;var ad;var af,ae;var ah,ag;ak=h.ocr_cleanup(ak);aj=h.ocr_cleanup(aj);ai=h.fdiff3(ak,aj);output="";for(ad=0;ad<ai.length;ad++){output=output+ai[ad]}output=h.post_cleanup(output,1);return output};h.insert_new_lines=function(af){var ag="fj1423lkfnsfdsghdh32342";var ae=new RegExp("^([\\s\\S]*\\.)[ \\t]+([\\s\\S]*)");var ad=new RegExp("^([\\s\\S]*\\d+\\.)$");while((matches=ae.exec(af))!=null){if(ad.test(matches[1])){af=matches[1]+ag+matches[2]}else{af=matches[1]+"\n\n"+matches[2]}}af=af.split(ag);af=af.join(" ");return af};h.set_basis_threshold=function(ad){if((ad>=5)&&(ad<=50)){R=ad;return"OK"}else{return"Value out of bounds"}};h.set_fdiff3_highlights=function(ad){if(ad=="checked"){x=true}else{x=false}return"OK"};h.set_fdiff4_strikeout_highlights=function(ad){if(ad=="checked"){A=true}else{A=false}return"OK"};h.set_fdiff4_warn_claims=function(ad){if(ad=="checked"){N=true}else{N=false}return"OK"};h.set_fdiff4_simplify_legend=function(ad){if(ad=="checked"){o=true}else{o=false}return"OK"};h.set_fdiff4_tree_analysis=function(ad){if(ad=="checked"){v=true}else{v=false}return"OK"};h.set_fdiff4_score_matrix=function(ad){if(ad=="checked"){X=true}else{X=false}return"OK"};h.set_convert_claim_styles=function(ad){if(ad=="checked"){aa=true}else{aa=false}return"OK"};h.set_ignore_hyphenation=function(ad){if(ad=="checked"){S=true}else{S=false}return"OK"};h.set_eszett_normalization=function(ad){if(ad=="checked"){M=true}else{M=false}return"OK"};h.set_ignore_case=function(ad){if(ad=="checked"){a=true}else{a=false}return"OK"};h.set_ignore_spaces=function(ad){if(ad=="checked"){O=true}else{O=false}return"OK"};h.set_ignore_in_brackets=function(ad){if(ad=="checked"){j=true}else{j=false}return"OK"};h.set_fix_glued_words=function(ad){if(ad=="checked"){H=true}else{H=false}return"OK"};h.set_insert_line_breaks_indents=function(ad){if(ad=="checked"){Y=true}else{Y=false}return"OK"};h.set_insert_line_breaks_indents2=function(ad){if(ad=="checked"){P=true}else{P=false}return"OK"};h.clear_claim_base_overrides=function(){t=[];z=[];return"OK"};h.set_claim_base_override=function(ad,af){var ae=parseInt(ad);if(ae<1){alert('Claim value "'+ad+'" out of bounds in claim base override!');return"Error"}af=af.split(/\s+/);af=af.join("");t.push(ae);z.push(af);return"OK"};h.clear_use_desc_overrides=function(){B=[];return"OK"};h.set_use_desc_override=function(ad){var ae=parseInt(ad);if(ae<1){alert('Claim value "'+ad+'" out of bounds in use description override!');return"Error"}B.push(ae);return"OK"};h.get_version=function(){return u};h.set_title=function(ad){E=ad;return"OK"};h.regenerate_title=function(){if(V!=""){E="'"+w+"' vs. '"+F+"'"}else{E="Difference"}return"OK"};h.set_header_orig=function(ad){F=ad;h.regenerate_title();return"OK"};h.set_header_new=function(ad){w=ad;h.regenerate_title();return"OK"};h.set_dossier_number=function(ad){V=ad;h.regenerate_title();return"OK"};h.filter_table_contents=function(ah){var am=/([\s\S]*?)<span class="tooltip">([\s\S]*?)<\/span>([\s\S]*)/;var af=/([\s\S]*?)<\/span>([\s\S]*)/;var ae=/([\s\S]*?)<div contenteditable="">([\s\S]*?)<\/div>([\s\S]*)/;var ad=/<table([\s\S]*)/;var ag,ak;ah=(ah.split(/ style="cursor: default;"/)).join("");ah=(ah.split(/ style="cursor: default; /)).join(' style="');var an=ah.split(/<\/table>/);if(an.length<1){return ah}var ao=an[0].split(/<tr/);for(row=1;row<ao.length;row++){var aj;if(row==1){aj=ao[row].split(/<th/)}else{aj=ao[row].split(/<td/)}if(aj.length>=5){aj[3]=aj.pop();if(aj.length==5){aj.pop()}if(row==1){ao[row]=aj.join("<th")}else{ao[row]=aj.join("<td")}}while((ag=am.exec(ao[row]))!=null){var ai=(ag[2].match(/\<span/g)||[]).length;var al=(ag[2].match(/\<\/span/g)||[]).length;while(ai!=al){if((ak=af.exec(ag[3]))!=null){ag[2]=ag[2]+"</span>"+ak[1];ag[3]=ak[2];ai=(ag[2].match(/\<span/g)||[]).length;al=(ag[2].match(/\<\/span/g)||[]).length}else{ai=al}}ao[row]=ag[1]+ag[3]}while((ag=ae.exec(ao[row]))!=null){ao[row]=ag[1]+ag[2]+ag[3]}}an[0]=ao.join("<tr");ah=an.join("</table>");return ah};h.filter_table_colours=function(ae){var ad=/([\s\S]*)<span style=\"background([\s\S]*?)>([\s\S]*?)<\/span>([\s\S]*)/;var ag;var af=ae.split(/<tr/);for(row=1;row<af.length;row++){while((ag=ad.exec(af[row]))!=null){af[row]=ag[1]+ag[3]+ag[4]}}ae=af.join("<tr");return ae};return h}());