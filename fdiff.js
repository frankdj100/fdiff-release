var fdiff=(function(){var h={};var u="4.81";var ab="<u>";var s="</u>";var C="<s>";var aa="</s>";var l="[[";var S="]]";var r="{{{";var b="}}}";var k=0;var m=0;var g=1;var d=2;var Y=3;var T=4;var K=5;var p=6;var y=7;var e=1;var V=7;var Q=15;var x=true;var A=true;var M=true;var o=true;var v=false;var W=false;var R=false;var L=false;var a=false;var N=false;var j=false;var Z=true;var H=true;var G=false;var X=false;var O=false;var t=[];var z=[];var B=[];var f=[];var F=[];var J=[];var D="Difference";var E="";var w="";var U="";h.fix_unclosed_brackets=function(ai){var ae;var ah,ac;var ag="";var ad="",af="";ae=ai.toString().split("");for(ac=0;ac<ae.length;ac++){ah=ae[ac];if(ag!==""){ag=ag+ah;if(ah===")"){if(j==false){ad=ad+ag}ag=""}}else{if(ah==="("){ag=ah;if(af!==""){ad=ad+af;af=""}}else{af=af+ah}}}if(ag!==""){return ad+"{"+ag.substr(1)}return ad+af};h.handle_reference_signs=function(ae){if(j==true){var ad;var ac=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ad=ac.exec(ae))!=null){ae=ad[1]+ad[3]}}return h.fix_unclosed_brackets(ae)};h.LCSubStr2=function(am,aj,af,ad){var ae,ac,ao,an;var ai=new Array(-1,-1,-1,-1);var al=[];var ak=0;var ah,ag;for(ao=0;ao<af.length;ao++){ae=af[ao];al[ao]=[];for(an=0;an<ad.length;an++){ac=ad[an];if(am[ae]===aj[ac]){if((ao===0)||(an===0)){al[ao][an]=1}else{al[ao][an]=al[ao-1][an-1]+1}if(al[ao][an]>ak){ak=al[ao][an];ai[0]=af[ao-ak+1];ai[1]=af[ao];ai[2]=ad[an-ak+1];ai[3]=ad[an]}}else{al[ao][an]=0}}}return ai};h.recurse=function(au,at,ai,aF){var an,az,am,ay,ax,aw;var ah=[];var aC=[];var al=[];var aG=[];var ar=[];var ag=[];var aj;var ae,ad,ao,av;var aq,af,aA,ak;var aH,aE;var aB=/\s/;if(au.length<=0){if(at.length>=1){return[ab].concat(at,s)}else{return[""]}}else{if(at.length<=0){return[C].concat(au,aa)}}if(a){var aD=[],ac=[];for(var ap=0;ap<au.length;ap++){aD.push(au[ap].toUpperCase())}for(var ap=0;ap<at.length;ap++){ac.push(at[ap].toUpperCase())}aj=h.LCSubStr2(aD,ac,ai,aF)}else{aj=h.LCSubStr2(au,at,ai,aF)}ae=aj[0];ad=aj[1];ao=aj[2];av=aj[3];if(ae<0){aq=[];while((au.length>0)&&(at.length>0)&&(au[0]===at[0])){aq.push(au.shift());at.shift()}af=[];while((au.length>0)&&(at.length>0)&&(au[au.length-1]===at[at.length-1])){af.unshift(au.pop());at.pop()}if(au.length>0){aA=[C];aA=aA.concat(au);aA.push(aa)}else{aA=[]}if(at.length>0){ak=[ab];ak=ak.concat(at);ak.push(s)}else{ak=[]}return aq.concat(aA,ak,af)}if((ae===0)&&(ad===au.length-1)&&(ao===0)&&(av===at.length-1)){return at}an=au.splice(0,ae);az=at.splice(0,ao);ax=au.splice(0,ad-ae+1);aw=at.splice(0,av-ao+1);am=au;ay=at;for(aE=0;aE<ai.length;aE++){aH=ai[aE];if(aH>ad){aC.push(aH-ad-1)}if(aH<ae){ah.push(aH)}}for(aE=0;aE<aF.length;aE++){aH=aF[aE];if(aH>av){aG.push(aH-av-1)}if(aH<ao){al.push(aH)}}for(aH=0;aH<ax.length;aH++){if(!aB.test(ax[aH])){ar.push(aH)}}for(aH=0;aH<aw.length;aH++){if(!aB.test(aw[aH])){ag.push(aH)}}return(h.recurse(an,az,ah,al)).concat(h.recurse(ax,aw,ar,ag),h.recurse(am,ay,aC,aG))};h.find_keyword_indices=function(ag){var af=[];var ad;var ae;var ac=/[\s,;:?!"'\-&\/()]/;for(ad=0;ad<ag.length;ad++){ae=ag[ad];if(ae===""){continue}if(ac.test(ae)){continue}af.push(ad)}return af};h.split_punctuation=function(an){var am;var ak=[];var ah="";var ag,ac="",aj;var ao=/[\s,.;:?!"'\-\/]/;var ae=/[a-z,A-Z,\#,0-9]/;var ad=/(.*?)([+\-Â±\s]+)(\d+\.\d+)(\s+)(.*)/;var af=/\d+\.\d+/;var ai;am=[];if(af.test(an)){while((ai=ad.exec(an))!=null){am=am.concat(ai[1].toString().split(""));am=am.concat(ai[2].toString().split(""));am.push(ai[3]);am=am.concat(ai[4].toString().split(""));an=ai[5]}}if(an!==""){am=am.concat(an.toString().split(""))}for(aj=0;aj<am.length;aj++){ag=am[aj];if(ah!==""){ah=ah+ag;if(ag===")"){if(j==false){ak.push(ah)}else{if((ak.length>0)&&(ak[ak.length-1]===" ")){ak.pop()}}ah=""}}else{if(ag==="("){ah=ag;if(ac!==""){ak.push(ac);ac=""}}else{if(ao.test(ag)){if(ac!==""){ak.push(ac)}ak.push(ag);ac=""}else{if(ag==="&"){if(ac!==""){ak.push(ac)}ac="&";for(var al=aj+1;al<am.length;al++){if(ae.test(am[al])){ac=ac+am[al]}else{break}}if((al<am.length)&&(am[al]===";")&&(al>aj+1)){ak.push(ac+";");aj=al}else{ak.push("&")}ac=""}else{ac=ac+ag}}}}}if(ac!==""){ak.push(ac)}return ak};h.remove_deleted_tabs=function(ae){var ad=false;for(var ac=0;ac<ae.length;ac++){if(ae[ac]==C){ad=true}else{if(ad==true){if(ae[ac]==aa){ad=false}else{if(ae[ac]=="\t"){ae[ac]=" "}}}}}for(var ac=0;ac<ae.length-2;ac++){if((ae[ac]==C)&&(ae[ac+1]==" ")&&(ae[ac+2]==aa)){ae.splice(ac,3);ac=ac-1}}for(var ac=0;ac<ae.length-2;ac++){if((ae[ac]==ab)&&(ae[ac+2]==s)&&((ae[ac+1]==" ")||(ae[ac+1]=="\t"))){ae.splice(ac+2,1);ae.splice(ac,1)}}return ae};h.fdiff3=function(ai,ah){var ag,ae;var ad,ac;var af;ag=h.split_punctuation(ai);ae=h.split_punctuation(ah);ad=h.find_keyword_indices(ag);ac=h.find_keyword_indices(ae);af=h.recurse(ag,ae,ad,ac);return h.remove_deleted_tabs(af)};h.detect_language=function(ai){var ad=0,ac=0,af=0;var ah="X";var ag,ae;ac=1+(ai.split(/claim/i)).length-1+(ai.split(/characteri/i)).length-1+(ai.split(/according/i)).length-1;ad=1+(ai.split(/revendication/i)).length-1+(ai.split(/caract.ris/i)).length-1+(ai.split(/selon/i)).length-1;af=1+(ai.split(/anspr.ch/i)).length-1+(ai.split(/gekennzeich/i)).length-1+(ai.split(/nach/i)).length-1;if(ac>=af){ag=ac;ae=af}else{ag=af;ae=ac}if(ad>=ag){ae=ag;ag=ad}else{if(ad>=ae){ae=ad}}if((ag/ae)>=3){if(ag==ac){ah="E"}else{if(ag==af){ah="D"}else{ah="F"}}}return ah};h.correct_missing_spaces=function(ai){var ah;ah=h.detect_language(ai);ai=ai.split(/\:/);ai=ai.join(": ");ai=ai.split(/\;/);ai=ai.join("; ");ai=ai.split(/\,/);ai=ai.join(", ");if(ah=="E"){ai=ai.split(/ ofa /);ai=ai.join(" of a ");ai=ai.split(/ wherein/);ai=ai.join(" wherein ");ai=ai.split(/ wherein :/);ai=ai.join(" wherein:");ai=ai.split(/ said/);ai=ai.join(" said ");ai=ai.split(/ and\/or/);ai=ai.join(" ANDSLASHOR ");ai=ai.split(/ and\,/);ai=ai.join(" ANDCOMMA ");ai=ai.split(/ and/);ai=ai.join(" and ");ai=ai.split(/ ANDSLASHOR /);ai=ai.join(" and/or");ai=ai.split(/ ANDCOMMA /);ai=ai.join(" and, ");ai=ai.split(/inthat/);ai=ai.join("in that");ai=ai.split(/ that/);ai=ai.join(" that ");ai=ai.split(/ that :/);ai=ai.join(" that:");ai=ai.split(/orfurther/);ai=ai.join("or further");ai=ai.split(/orwhere/);ai=ai.join("or where");ai=ai.split(/orthat/);ai=ai.join("or that")}if(ah=="E"){var ad=/(claim)(\d)/i;var ac=/(claims)(\d)/i;var ag;if((ag=ad.exec(ai))!=null){var ae=/([\s\S]*)(claim)(\d+)([\s\S]*)/i;while((ag=ae.exec(ai))!=null){ai=ag[1]+ag[2]+" "+ag[3]+ag[4]}}if((ag=ac.exec(ai))!=null){var af=/([\s\S]*)(claims)(\d+)([\s\S]*)/i;while((ag=af.exec(ai))!=null){ai=ag[1]+ag[2]+" "+ag[3]+ag[4]}}}return ai};h.ocr_cleanup=function(ae){if(H==true){ae=h.correct_missing_spaces(ae)}ae=h.handle_reference_signs(ae);if(N==true){ae=ae.split(/\s+\)/);ae=ae.join(")");ae=ae.split(/\(\s+/);ae=ae.join("(");ae=ae.split(/\s+\]/);ae=ae.join("]");ae=ae.split(/\[\s+/);ae=ae.join("[");ae=ae.split(/\s+\,/);ae=ae.join(",");ae=ae.split(/\s+\;/);ae=ae.join(";");ae=ae.split(/\s+\:/);ae=ae.join(":");ae=ae.split(/\s+\./);ae=ae.join(".")}ae=ae.split("<RTI>");ae=ae.join("");ae=ae.split("<RTIgt;");ae=ae.join("");ae=ae.split("</RTI>");ae=ae.join("");ae=ae.replace(/\&/g,"AMPERSANDFOOBAR");ae=ae.replace(/\;/g,"&#59;");ae=ae.replace(/\:/g,"&#58;");ae=ae.replace(/AMPERSANDFOOBAR/g,"&amp;");ae=ae.replace(/\u2013|\u2014/g,"-");ae=ae.replace(/\u2018|\u2019|\u201A|\u0060/g,"'");ae=ae.replace(/\u201c|\u201d|\u201e/g,'"');ae=ae.split("<");ae=ae.join("&lt;");ae=ae.split(">");ae=ae.join("&gt;");if(L==true){ae=ae.replace(/\u00df/g,"ss")}ae=ae.split(/[ \t]+/);ae=ae.join(" ");ae=ae.split(/[\n\f\r]+/);ae=ae.join("\t");if(R==true){var ac=/(.*[a-zA-Z\u00e9\u00e8\u00f6\u00fc]+)\-\s*(\w+.*)/;var ad;while((ad=ac.exec(ae))!=null){ae=ad[1]+ad[2]}}return ae};h.ocr_cleanup_desc=function(af){var ac=j;var ad=R;var ae;j=false;R=false;ae=h.ocr_cleanup(af);j=ac;R=ad;return ae};h.form_claim_reg_exp=function(ae){var ad;var ac;ae=ae.toString();ad=ae.split("");re="";for(ac=0;ac<ad.length;ac++){if(ac>0){re=re+"\\s{0,1}"}if(ad[ac]==1){pat="[1,l,I,i]"}else{if(ad[ac]==2){pat="[2,Z,z]"}else{if(ad[ac]==5){pat="[5,S,s]"}else{if(ad[ac]==0){pat="[0,O,o]"}else{pat=ad[ac]}}}}re=re+pat}return re};h.handle_strict_patterns=function(af,ar,ak,ai,at,am){var ag;var ae;var ap=0;var ad=100000;var au=[];var ah;var ao;var al;var an=false;var aj=[];if(typeof(am)=="undefined"){am=""}ag=new RegExp("(.*\\.\\s*)("+ar+")(\\d+)("+ak+")(.*)$",am);while((ae=ag.exec(af))!=null){claim_no=parseInt(ae[3],10);if(typeof au[claim_no]!="undefined"){an=true;aj.push(claim_no)}au[claim_no]=ae[2]+ae[3]+ae[4]+ae[5];af=ae[1];if(ap<claim_no){ap=claim_no}if(ad>claim_no){ad=claim_no}}v2="";ag=new RegExp("^(.*?)("+ar+")(\\d+)("+ak+")(.*)$",am);while((ae=ag.exec(af))!=null){claim_no=parseInt(ae[3],10);af=ae[1];v2=ae[2]+ae[3]+ae[4]+ae[5]+v2;if((claim_no<ad)&&(claim_no>0)){au[claim_no]=v2;v2="";ad=claim_no}if(ap<claim_no){ap=claim_no}}if(an==true){var aq="Warning: the following claims/paragraphs have been found multiple times:\n";aq=aq+aj.pop();while(aj.length>0){aq=aq+", "+aj.pop()}alert(aq+".\nPlease check the text in the input window.")}au[0]=af;if(ap>1000){var ac=ap;ap=1000;while((ap>0)&&(typeof(au[ap])=="undefined")){ap--}alert("Something probably went wrong.\nHighest claim number detected: "+ac+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ap+".")}al=0;for(c=1;c<=ap+3;c++){if(typeof au[c]=="undefined"){ag=new RegExp(h.form_claim_reg_exp(c));if(ag.test(au[al])){ag=new RegExp(ai+h.form_claim_reg_exp(c)+at);if(ag.test(au[al])){if(al==0){ag=new RegExp("(.*?)("+ai+h.form_claim_reg_exp(c)+at+")(.*)",am)}else{ag=new RegExp("(.*?[\\.\\s]+)("+ai+h.form_claim_reg_exp(c)+at+")(.*)",am)}if((ae=ag.exec(au[al]))!=null){au[al]=ae[1];au[c]=ae[2]+ae[3];al=c;if(c>ap){ap=c}}}}}else{al=c}}au.unshift(ap);return au};h.handle_square_brackets_type_claims=function(ac){return h.handle_strict_patterns(ac,"\\[","\\]","\\[[0oO\\s]*","\\s{0,1}\\]")};h.handle_siemens_type_claims=function(ad){var ac=h.detect_language(ad);if(ac=="E"){return h.handle_strict_patterns(ad,"\\[claim\\s+","\\]","\\[claim\\s+","\\s{0,1}\\]","i")}else{if(ac=="D"){return h.handle_strict_patterns(ad,"\\[anspruch\\s+","\\]","\\[anspruch\\s+","\\s{0,1}\\]","i")}else{if(ac=="F"){return h.handle_strict_patterns(ad,"\\[revendication\\s+","\\]","\\[revendication\\s+","\\s{0,1}\\]","i")}else{return[0,ad]}}}};h.handle_claim_type_claims=function(ad){var ac=h.detect_language(ad);if(ac=="E"){return h.handle_strict_patterns(ad,"claim\\s+","\\.","claim\\s+","\\s{0,1}\\.","i")}else{if(ac=="D"){return h.handle_strict_patterns(ad,"anspruch\\s+","\\.","anspruch\\s+","\\s{0,1}\\.","i")}else{if(ac=="F"){return h.handle_strict_patterns(ad,"revendication\\s+","\\.","revendication\\s+","\\s{0,1}\\.","i")}else{return[0,ad]}}}};h.count_matches=function(af,ac){var ae;var ad=0;while((ae=ac.exec(af))!=null){ad=ad+1;af=ae[1]}return ad};h.detect_claim_numbering_style=function(ag){var av=/\.\s*\d+\.(.*)/;var ah=/^\d+\./;var au=/\[\d+\]\s+(.*)/;var ad=/\[\s*anspruch\s+\d+\s*\](.*)/i;var ac=/\[\s*revendication\s+\d+\s*\](.*)/i;var ax=/\[\s*claim\s+\d+\s*\](.*)/i;var ar=/\.\s*\d+\/(.*)/;var ai=/^\d+\//;var aq=/\.\s*\d+\s{0,1}\-(.*)/;var am=/^\d+\s{0,1}\-/;var ao=/\.\s*\d+\)(.*)/;var ae=/^\d+\)/;var ap=/\.\s*anspruch\s+\d+\.(.*)/i;var an=/\.\s*revendication\s+\d+\.(.*)/i;var al=/\.\s*claim\s+\d+\.(.*)/i;var aj=[0,0,0,0,0,0,0,0,0,0,0,0];var af;aj[g]=h.count_matches(ag,av);if((matches=ah.exec(ag))!=null){aj[g]=aj[g]+1}aj[d]=h.count_matches(ag,au);aj[Y]=h.count_matches(ag,ad)+h.count_matches(ag,ac)+h.count_matches(ag,ax);aj[y]=h.count_matches(ag,ap)+h.count_matches(ag,an)+h.count_matches(ag,al);aj[T]=h.count_matches(ag,ar);if((matches=ai.exec(ag))!=null){aj[T]=aj[T]+1}aj[K]=h.count_matches(ag,aq);if((matches=am.exec(ag))!=null){aj[K]=aj[K]+1}var aw=j;j=true;var ak=h.split_punctuation(ag);af=ak.join("");j=aw;aj[p]=h.count_matches(af,ao);if((matches=ae.exec(af))!=null){aj[p]=aj[p]+1}largest_score=aj[e];largest_score_style=e;second_largest_score=0;second_largest_score_style=m;for(var at=e+1;at<=V;at++){if(aj[at]>second_largest_score){if(aj[at]>largest_score){second_largest_score=largest_score;second_largest_score_style=largest_score_style;largest_score=aj[at];largest_score_style=at}else{second_largest_score=aj[at];second_largest_score_style=at}}}if((largest_score_style==d)&&(largest_score>=10)){claim_style=largest_score_style}else{if((second_largest_score!=0)&&(largest_score<2*second_largest_score)){claim_style=m}else{claim_style=largest_score_style}}return claim_style};h.split_claims=function(ak){var an;var ae;var aq=0;var ai=100000;var ag=[];var ar;var ap;var aj;var af=false;var ao=[];if(Z==true){ar=h.detect_claim_numbering_style(ak)}else{ar=m}var ah="\\.";var am="[.,]";var ac="\\s{0,1}\\.";if(ar==d){return h.handle_square_brackets_type_claims(ak)}else{if(ar==Y){return h.handle_siemens_type_claims(ak)}else{if(ar==y){return h.handle_claim_type_claims(ak)}else{if(ar==T){ah="\\/";am=ah;ac="\\s{0,1}\\/"}else{if(ar==K){ah="\\s{0,1}\\-";am=ah;ac=ah}else{if(ar==p){ah="\\)";am=ah;ac="\\s{0,1}\\)"}}}}}}an=new RegExp("(.*\\.\\s+)(\\d+)("+ah+")(.*)$");while((ae=an.exec(ak))!=null){claim_no=parseInt(ae[2],10);if(claim_no>1000){ak=ae[1]+"["+ae[2]+"]"+ae[3]+ae[4];continue}if(typeof ag[claim_no]!="undefined"){af=true;ao.push(claim_no)}ag[claim_no]=""+claim_no+ae[3]+ae[4];ak=ae[1];if(aq<claim_no){aq=claim_no}if(ai>claim_no){ai=claim_no}}v2="";an=new RegExp("^(.*?)(\\d+)("+ah+")(\\s+.*)$");while((ae=an.exec(ak))!=null){claim_no=parseInt(ae[2],10);ak=ae[1];v2=""+claim_no+ae[3]+ae[4]+v2;if((claim_no<ai)&&(claim_no>0)){ag[claim_no]=v2;v2="";ai=claim_no}if(aq<claim_no){aq=claim_no}}if(af==true){var al="Warning: the following claims/paragraphs have been found multiple times:\n";al=al+ao.pop();while(ao.length>0){al=al+", "+ao.pop()}alert(al+".\nPlease check the text in the input window.")}ag[0]=ak;if(typeof ag[1]=="undefined"){if((c=ag[0].indexOf("1 "))==0){ag[1]=ag[0];ag[0]=""}else{if((c=ag[0].indexOf(" 1 "))!==-1){ag[1]=ag[0].substring(c);ag[0]=ag[0].substring(0,c)}else{an=new RegExp("^("+h.form_claim_reg_exp(1)+ac+")(.*)");if((ae=an.exec(ag[0]))!=null){ag[0]="";ag[1]=ae[1]+ae[2]}}}}if(aq>1000){var ad=aq;aq=1000;while((aq>0)&&(typeof(ag[aq])=="undefined")){aq--}alert("Something probably went wrong.\nHighest claim number detected: "+ad+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+aq+".")}aj=0;for(c=1;c<=aq+15;c++){if(typeof ag[c]=="undefined"){if(ag[aj].indexOf("."+c)!==-1){an=new RegExp("(.*?\\.)("+c+ah+")(\\s+.*)");if((ae=an.exec(ag[aj]))!=null){ag[aj]=ae[1];ag[c]=ae[2]+ae[3];aj=c;if(c>aq){aq=c}}}}else{aj=c}}aj=0;for(c=1;c<=aq+3;c++){if(typeof ag[c]=="undefined"){if(ag[aj].indexOf(c)!==-1){an=new RegExp("(.*?\\.\\s*)("+c+")(\\s+.*)");if((ae=an.exec(ag[aj]))!=null){if((ae[1].length>=2)&&((ae[1].charAt(ae[1].length-2)>="0")&&(ae[1].charAt(ae[1].length-2)<="9"))){}else{ag[aj]=ae[1];ag[c]=ae[2]+ae[3];aj=c;if(c>aq){aq=c}}}}}else{aj=c}}aj=0;for(c=1;c<=aq+3;c++){if(typeof ag[c]=="undefined"){an=new RegExp(h.form_claim_reg_exp(c));if(an.test(ag[aj])){an=new RegExp("(.*?\\.\\s+)("+h.form_claim_reg_exp(c)+am+")(.*)");if((ae=an.exec(ag[aj]))!=null){ag[aj]=ae[1];ag[c]=ae[2]+ae[3];aj=c;if(c>aq){aq=c}}}}else{aj=c}}if(ar==g){aj=0;for(c=1;c<=aq+3;c++){if(typeof ag[c]=="undefined"){an=new RegExp(h.form_claim_reg_exp(c));if(an.test(ag[aj])){an=new RegExp("(.*?\\s+)("+c+ah+"\\s{0,1})(\\D.*)");if((ae=an.exec(ag[aj]))!=null){ag[aj]=ae[1];ag[c]=ae[2]+ae[3];aj=c;if(c>aq){aq=c}}}}else{aj=c}}}aj=0;for(c=1;c<=aq+3;c++){if(typeof ag[c]=="undefined"){an=new RegExp(h.form_claim_reg_exp(c));if(an.test(ag[aj])){an=new RegExp("(.*?\\s+)("+h.form_claim_reg_exp(c)+ac+")(.*)");if((ae=an.exec(ag[aj]))!=null){ag[aj]=ae[1];ag[c]=ae[2]+ae[3];aj=c;if(c>aq){aq=c}}}}else{aj=c}}for(c=1;c<=aq;c++){if(typeof ag[c]!="undefined"){ag[c]=h.fix_unclosed_brackets(ag[c])}}ag.unshift(aq);return ag};h.handle_double_paragraphs=function(ai){var ak=/\[\d+\][^\S\t]+\[\d+\](.*)/;var ae=/(.*?)\t(\[\d+\])([ ]+)(\[\d+\])(.*)/;var ac=/(.*?)(\[\d+\])(.*)/;var af="";var ad="";if(ai==""){return ai}if(h.count_matches(ai,ak)>=1){while((matches=ae.exec(ai))!=null){var ah=matches[1];var aj=matches[2];var ag=matches[4];ai=matches[5];while((matches=ac.exec(ah))!=null){ah=matches[1]+matches[3];af=af+matches[2]}ad=ad+ah+"\t"+ag;af=af+aj}while((matches=ac.exec(ai))!=null){ai=matches[1]+matches[3];af=af+matches[2]}ad=ad+ai;return ad}return ai};h.split_desc=function(ag){if(ag==""){return[0,ag]}else{var ad;var ac=/\.\s*\[\d+\](.*)/;var af=h.ocr_cleanup_desc(ag);if(h.count_matches(af,ac)>=2){af=h.handle_double_paragraphs(af);ad=h.handle_square_brackets_type_claims(af)}else{ad=af.split(/[\t]+/);while((ad.length>0)&&(ad[ad.length-1]=="")){ad.pop()}ad.unshift("");ad.unshift(ad.length-1)}for(var ae=1;ae<ad.length;ae++){if(typeof ad[ae]!="undefined"){ad[ae]=h.fix_unclosed_brackets(ad[ae])}}return ad}};h.calculate_score_for_word=function(ac){if((ac=="claim")||(ac=="claims")||(ac=="according")||(ac=="characterised")||(ac=="characterized")||(ac=="Anspruch")||(ac=="AnsprÃ¼che")||(ac=="gekennzeichnet")||(ac=="revendication")||(ac=="revendications")||(ac=="caractÃ©risÃ©")||(ac=="caractÃ©risÃ©e")){return 0}else{return ac.length}};h.count_added=function(af){var ad=0;var ae=0;var ac;for(ac=0;ac<af.length;ac++){if(af[ac]==ab){ae=1}else{if(af[ac]==s){ae=0}else{if(af[ac]==C){ae=2}else{if(af[ac]==aa){ae=0}else{if(ae==1){ad=ad+h.calculate_score_for_word(af[ac])}}}}}}return ad};h.count_unchanged=function(af){var ae=0;var ad=0;var ac;for(ac=0;ac<af.length;ac++){if(af[ac]==ab){ad=1}else{if(af[ac]==s){ad=0}else{if(af[ac]==C){ad=2}else{if(af[ac]==aa){ad=0;ae=ae-1}else{if(ad==0){ae=ae+h.calculate_score_for_word(af[ac])}}}}}}if(ae>0){return ae}else{return 0}};h.is_short_word=function(ad){var ae=["the","a"," ","of","in","and","to","is","that","der","die","das","dem","des","den","im","und","le","la","dans","que","de"];for(var ac=0;ac<ae.length;ac++){if(ad==ae[ac]){return 1}}return 0};h.cross_out_deleted=function(ae){var ad=0;var af=[];for(var ac=0;ac<ae.length;ac++){if(ae[ac]==C){ad=1}else{if(ae[ac]==aa){ad=0}else{if(ae[ac]==ab){ad=2}else{if(ae[ac]==s){ad=0}else{if(ad==0){af.push(ae[ac])}else{if(ad==1){if(ae[ac]==" "){af.push(" ")}else{af.push(Array(1+ae[ac].length).join("-"))}}}}}}}}return af};h.alert_array=function(ac){var ad=ac.join("-");alert(ad)};h.reset_feature_blocks=function(){f=[];F=[];J=[]};h.add_feature_for_claim=function(ad,ae,ac){f.push(ad);F.push(ae);J.push(ac)};h.find_feature_block_marker=function(af,ac){var ae=af.indexOf(l,ac);var ad=af.indexOf(S,ac);if((ae<0)&&(ad>=0)){return ad}if((ad<0)&&(ae>=0)){return ae}if(ae<ad){return ae}else{return ad}};h.find_feature_blocks=function(ag,ah){var ae=0;var ac=0,af=0,aj=0;while((ae=h.find_feature_block_marker(ah,ae))>=0){if(ah.substr(ae,2)==l){aj=aj+1}else{if(ah.substr(ae,2)==S){aj=aj-1}}if(aj>ac){ac=aj}if(aj<af){af=aj}ae=ae+2}if((ac>1)||(af<0)||(aj!=0)){alert("Unbalanced feature brackets [[ ... ]] found in claim "+ag+" -- ignoring all brackets");return ah}if((ac==0)&&(af==0)){return ah}var ad=/(.*)\[\[(.*?)\]\](.*)/;var ai=0;while((matches=ad.exec(ah))!=null){h.add_feature_for_claim(ag,ai,matches[2]);ah=matches[1]+" "+r+ai+b+" "+matches[3];ai=ai+1}ah=(ah.split("  ")).join(" ");return ah};h.replace_feature_markers=function(ag){var ac=/(.*)\{\{\{(\d+)\}\}\}(.*)/;var ae;var ad;var af=0;if(ac.exec(ag.join(""))==null){return ag}ad=[];for(loop=0;loop<ag.length;loop++){if(ag[loop]==ab){af=1}else{if(ag[loop]==s){af=0}}if((ae=ac.exec(ag[loop]))!=null){if(ae[1].length>0){ad.push(ae[1])}if(af==1){ad.push(s);ad.push(ab)}if(ae[2]<=f.length){atoms=J[ae[2]].split(" ");for(i=0;i<atoms.length;i++){ad.push(atoms[i]);if(i!=atoms.length){ad.push(" ")}}}if(af==1){ad.push(s);ad.push(ab)}if(ae[3].length>0){ad.push(ae[3])}}else{ad.push(ag[loop])}}return ad};h.collect_deleted_parts=function(ah){var ag=0;var ai,ae,aj,ac=-1;var ak;for(ai=ah.length-1;ai>=0;ai--){if(ah[ai]==aa){ac=ai}else{if(ah[ai]==C){for(ae=ai-1;ae>=0;ae--){if(h.is_short_word(ah[ae])){continue}else{if(ah[ae]==s){for(aj=ae-1;aj>=0;aj--){if(ah[aj]==ab){break}}if((aj>=0)&&(ac>0)){if(ai-ae>1){short_words=ah.splice(ae+1,ai-ae-1);Array.prototype.splice.apply(ah,[ae,0].concat(short_words));ae=ae+short_words.length;Array.prototype.splice.apply(ah,[ai+1,0].concat(short_words));ac=ac+short_words.length}var ad=ae-aj+1;added_block=ah.splice(aj,ad);ai=ai-ad;ae=ai;ac=ac-ad;Array.prototype.splice.apply(ah,[ac+1,0].concat(added_block))}else{alert("Warning: this should not happen (E101)");return ah}}else{if(ah[ae]==aa){if(ae==ai-1){for(start_other_del=ae-1;start_other_del>=0;start_other_del--){if(ah[start_other_del]==C){break}}if(start_other_del>=0){ah.splice(ae,2);ai=start_other_del;ae=ai;ac=ac-2}}else{break}}else{break}}}}}}}for(var af=0;af<ah.length-1;af++){if(((ah[af]==aa)&&(ah[af+1]==C))||((ah[af]==s)&&(ah[af+1]==ab))){ah.splice(af,2)}}return ah};h.remove_deleted=function(ae){var ad=0;var af=[];for(var ac=0;ac<ae.length;ac++){if(ae[ac]==C){ad=1}else{if(ae[ac]==aa){ad=0}else{if(ad==0){af.push(ae[ac])}}}}return af};h.remove_short_unchanged=function(ae){var af=[];for(var ad=0;ad<ae.length;ad++){if(ae[ad]==ab){for(var ac=af.length-1;ac>=0;ac--){if(!h.is_short_word(af[ac])||af[ac]==s){break}}if(ac<0){af.unshift(ab);continue}else{if(af[ac]==s){af.splice(ac,1);continue}}}af.push(ae[ad])}for(var ac=af.length-1;ac>=0;ac--){if(!h.is_short_word(af[ac])||af[ac]==s){break}}if((ac>=0)&&(af[ac]==s)){af.splice(ac,1);af.push(s)}return af};h.remove_tags=function(ac){ac=(ac.split(ab)).join("");ac=(ac.split(s)).join("");ac=(ac.split(C)).join("");ac=(ac.split(aa)).join("");return ac};h.get_color_string=function(ad){var ac=["yellow","cyan","lime","orange","lightskyblue","lightgreen","coral","gold","violet","silver","pink","lightsalmon","tomato"];max_color=12;if(ad==0){the_color=0}else{the_color=1+((ad-1)%max_color)}return'<span style="BACKGROUND-COLOR: '+ac[the_color]+'">'};h.get_color_string_end=function(){return"</span>"};h.get_color_string_and_update_legend_for_claim=function(ad,ac){var ae=new RegExp('BACKGROUND-COLOR: (\\w+)">'+ad+h.get_color_string_end());for(leg=1;leg<ac.length;leg++){if(ae.exec(ac[leg])!=null){break}}if(leg==ac.length){ac.push(" "+h.get_color_string(leg)+ad+h.get_color_string_end())}return h.get_color_string(leg)};h.make_single_added=function(ad){var ac;var ae=[];for(ac=0;ac<ad.length;ac++){if((ad[ac]!=ab)&&(ad[ac]!=s)){ae.push(ad[ac])}}if(ae.length>0){ae.unshift(ab);ae.push(s)}while(ad.length>0){ad.pop()}while(ae.length>0){ad.push(ae.shift())}return};h.format_claim_span=function(ag,ak){var ac="";var aj=-1;var al=-1;var ah=[];var ai=[];var ad=false;for(var af=1;af<=ak;af++){if(typeof ag[af]!="undefined"){ah.push(af)}else{ad=true}}if(ah.length==0){return"None"}for(var ae=0;ae<ah.length;ae++){if((ah[ae]-al==1)){al=ah[ae]}else{if(aj>0){if((al-aj)>=2){ac=ac+aj+"-"+al+","}else{if((al-aj)==1){ac=ac+aj+","+al+","}else{ac=ac+aj+","}}}aj=ah[ae];al=ah[ae]}}if((al-aj)>=2){ac=ac+aj+"-"+al}else{if((al-aj)==1){ac=ac+aj+","+al}else{ac=ac+aj}}if(ad){ac=ac+" (Warning: irregularly numbered set, please check input)"}return ac};h.split_into_added_unchanged_added=function(ak,ag,aq,ao){var am,al;var ah,ad;var an,af,ap;var ac,aj,ae;var ai;ap=0;an=0;af=0;ae=0;ac=0;aj=0;ad=0;ah=0;for(am=0;am<ak.length;am++){if(ak[am]==ab){ai=true;ah=am;ad=0}else{if(ak[am]==s){if(ad>Q){aj=ah-1;if(ae>ap){an=ac;af=aj;ap=ae}ac=am+1;aj=am+1;ae=0}else{aj=am}ai=false}else{if(ai){ad=ad+ak[am].length}else{ae=ae+ak[am].length;aj=am}}}}if(ae>ap){an=ac;af=aj;ap=ae}for(am=0;am<an;am++){ag.push(ak[am])}for(am=an;am<=af;am++){aq.push(ak[am])}for(am=af+1;am<ak.length;am++){ao.push(ak[am])}h.make_single_added(ag);h.make_single_added(ao);return};h.recode_added_parts=function(ai,ak,ac,ad){var al,aj,am,aq,av;var af,an;var au,ao;var ae;al=aj=am=aq=af=an=[];ao=0;k++;if(o==true){ae="|"}else{ae=""}for(au=0;au<ac.length;au++){if(ac[au]==ab){ao=1;aj=[];if(k==1){aq.push(ac[au])}continue}else{if(ac[au]==s){ao=2;coded_yet=0;if(h.count_added([ab].concat(aj,s))>Q){max_score=0;av=0;var ar,ah;for(var ap=1;ap<=ak;ap++){if(typeof ai[ap]=="undefined"){continue}ar=h.fdiff3(ai[ap],aj.join(""));ar=h.remove_deleted(ar);if((diff_score=h.count_unchanged(ar))>max_score){av=ap;max_score=diff_score}}if(max_score>Q){var ag,aw,at;ar=h.fdiff3(ai[av],aj.join(""));ar=h.remove_deleted(ar);ag=[];aw=[];at=[];h.split_into_added_unchanged_added(ar,ag,aw,at);af=h.recode_added_parts(ai,ak,ag,ad);aq=aq.concat(af);aq.push("<SPAN>"+ae);if(o){aq.push(h.get_color_string_and_update_legend_for_claim(av,ad))}else{aq.push(h.get_color_string(ad.length));ad.push(" "+h.get_color_string(ad.length)+av+h.get_color_string_end())}mode2=0;for(d2=0;d2<aw.length;d2++){if(aw[d2]==C){mode2=1;alert("This should not happen. Code 1.")}else{if(aw[d2]==aa){mode2=0;alert("This should not happen. Code 2.")}else{if(aw[d2]==ab){aq.push(h.get_color_string(0))}else{if(aw[d2]==s){aq.push(h.get_color_string_end())}else{if(mode2==0){aq.push(aw[d2])}}}}}}aq.push(h.get_color_string_end());ah=h.fdiff3(ai[av],h.remove_tags(aw.join("")));aq.push(ae+'</SPAN><SPAN class="tooltip">'+ah.join("")+"</SPAN>");an=h.recode_added_parts(ai,ak,at,ad);aq=aq.concat(an);coded_yet=1}}if(!coded_yet){aq.push(h.get_color_string(0));aq=aq.concat(aj);aq.push(h.get_color_string_end())}if(k==1){aq.push(s)}}}if(ao==0){aq.push(ac[au])}else{if(ao==1){aj.push(ac[au])}else{if(ao==2){ao=0}}}}k--;return aq};h.get_main_base_claim=function(ad){for(var ae=0;ae<t.length;ae++){if(t[ae]==ad){var ac=/^(\d+)/;var af;if((af=ac.exec(z[ae]))!=null){var ag=parseInt(af[1]);if(ag<0){alert('Base value "'+base+'"out of bounds');return -1}else{return ag}}}}return -1};h.get_claim_base_exclusions=function(ap,av,ai,ah){var ak=0;var af;var ad=false;if(ah==false){ai=0;af=z}else{af=z.slice(0)}for(var aj=0;aj<t.length;aj++){if(t[aj]==ap){if((af[aj].search("!")>=0)&&(af[aj].search("&")>=0)){alert("Error in base override for claim "+ap+"\nCan't both include (&) and exclude (!) claims");return[]}var ao=/(.*)\[(\d+)\](.*)/;var ae;while((ae=ao.exec(af[aj]))!=null){if((Math.round(ae[2])<=ai)&&(Math.round(ae[2])!=0)){af[aj]=ae[1]+(av+parseInt(ae[2]))+ae[3];ad=true}else{if(ah==true){alert("Error in base override for claim "+ap+"\nInvalid paragraph number ["+ae[2]+"] encountered.")}else{if(af[aj].search("&")>=0){alert("Error in base override for claim "+ap+":\nuse of description not selected.")}}af[aj]=ae[1]+ae[3]}}var aq=af[aj].split(/[0-9!&\-\,]+/);if((aq=aq.join(""))!==""){alert("Error in base override for claim "+ap+"\nInvalid character(s) "+aq+' encountered.\n\nValid examples: "5!8,9,12-15,38-40" or "&8,9,12-15,38-40"');return[]}var at=af[aj];var ac=/(.*?)(\d+)\-(\d+)(.*)/;var ae,ag,an;while((ae=ac.exec(at))!=null){ag=parseInt(ae[2]);an=parseInt(ae[3]);if(ag>=an){alert("Invalid base override range ("+ae[2]+"-"+ae[3]+") for claim "+ap+".");return[]}at=""+ae[1]+ae[2];for(var au=ag+1;au<=an;au++){at=at+","+au}at=at+ae[4]}at=at.split(/[!&,]/);at.shift();if(af[aj].search("!")>=0){return at}else{if(af[aj].search("&")>=0){if((ad==false)&&(ah==true)){ai=0}var ar=[];for(var am=1;am<=av+ai;am++){for(var al=0;al<at.length;al++){if(at[al]==am){break}}if(al==at.length){ar.push(am)}}return ar}}break}}return[]};h.get_base_text_for_claim=function(ac){for(var ad=0;ad<t.length;ad++){if(t[ad]==ac){return z[ad]}}return""};h.insert_in_score_list=function(ad,ac,ae){ad.push(ac);ad.push(ae);for(var af=(ad.length/2)-2;af>=0;af--){if(ae<=ad[af*2+1]){break}ad[(af+1)*2]=ad[af*2];ad[(af+1)*2+1]=ad[af*2+1];ad[af*2]=ac;ad[af*2+1]=ae}return};h.show_dependency_table=function(ae,ah){var ad="<B>Claim dependency table:</B><BR>";var ac;for(var af=1;af<=ah;af++){if(typeof(ae[af])=="undefined"){continue}ac="    "+af+": ";ad=ad+ac.substr(-5);for(var ag=1;ag<=af;ag++){if(af==ag){ad=ad+"x "}else{if(typeof(ae[af][ag])=="undefined"){ad=ad+"- "}else{ad=ad+ae[af][ag]+" "}}}ad=ad+"<BR>"}return ad};h.format_claim_tree_recursive=function(al,ah,ak,ae,ad,ai){if(typeof(al[ah])=="undefined"){return ad}if(ad.indexOf("-"+ah+"-")>=0){return ad}var aj="";if(typeof(ai)!="undefined"){if(typeof(ai[ah])!="undefined"){aj="<SUP>("+ai[ah]+")</SUP>"}}for(var af=1;af<ae;af++){ad=ad+"| "}if(ae>0){ad=ad+"+ "}else{if(ae==0){ad=ad+"<BR>"}}if(ae==0){ad=ad+"<BR>-<B>"+ah+"</B>-"+aj+"<BR>"}else{ad=ad+"-"+ah+"-"+aj+"<BR>"}for(var ag=ah+1;ag<=ak;ag++){if(ad.indexOf("-"+ag+"-")>=0){continue}else{if(typeof(al[ag])=="undefined"){continue}else{if(al[ag][ah]==1){for(var ac=ah-1;ac>0;ac--){if(al[ag][ac]==1){break}}if(ac==0){if(typeof(ai)!="undefined"){if(typeof(ai[ag])!="undefined"){if(typeof(ai[ah])!="undefined"){ai[ag]=ai[ag]+";"+ai[ah]}}}ad=h.format_claim_tree_recursive(al,ag,ak,ae+1,ad,ai)}}}}}return ad};h.format_claim_tree=function(ac,au,ah){var ai="";for(var am=1;am<=au;am++){ai=h.format_claim_tree_recursive(ac,am,au,0,ai,ah)}var al=ai.split("<BR>");while((al.length>0)&&(al[0]=="")){al.shift()}for(var am=1;am<al.length;am++){al[am]=al[am].split(" ")}for(var an=0;an<au;an++){last="";for(var am=al.length-1;am>=1;am--){if(typeof(al[am][an])=="undefined"){last="";continue}else{if(al[am][an]=="|"){if(last==""){al[am][an]=" "}}else{if(al[am][an]=="+"){last="+"}else{last=""}}}}}for(var am=1;am<al.length;am++){al[am]=al[am].join(" ")}ai=al.join("<BR>");ai=ai.split("-");ai=ai.join("");ai=ai.split("+ ");ai=ai.join("+-");var aq=/(.*)<SUP>\((.*?)\)<\/SUP>(.*)/;var ak=/(.*?)\;(.*)/;var aj=/(\d+)/;var af,at;while((af=aq.exec(ai))!=null){if((at=ak.exec(af[2]))!=null){base_and_support=at[1].split(",")}else{base_and_support=af[2].split(",")}base_and_support[0]="<b><u>"+base_and_support[0]+"</u></b>";for(var ao=1;ao<base_and_support.length;ao++){base_and_support[ao]="<b>"+base_and_support[ao]+"</b>"}if(at!=null){af[2]=base_and_support.join(",")+","+at[2]}else{af[2]=base_and_support.join(",")}af[2]=af[2].split(";");af[2]=af[2].join(",");var ad=[];var ag=[];var ar;var ae=af[2].split(",");for(var ap=0;ap<ae.length;ap++){if((ar=aj.exec(ae[ap]))!=null){value=Math.round(ar[1]);for(var ao=0;ao<ad.length;ao++){if(ad[ao]>=value){break}}if((ao==ad.length)||(ad[ao]!=value)){ad.splice(ao,0,value);ag.splice(ao,0,ae[ap])}}}af[2]=ag.join(",");ai=af[1]+"<sup>("+af[2]+")</sup>"+af[3]}return ai};h.remove_claim_tree_deps=function(ac){var ad=/(.*)\((.*?)\)(.*)/;var af;while((af=ad.exec(ac))!=null){var ag=[];legend=af[2].split(/,/);for(var ae=0;ae<legend.length;ae++){if(legend[ae].indexOf("<b>")>=0){ag.push(legend[ae])}}ac=af[1]+"{"+ag.join(",")+"}"+af[3]}ac=ac.split(/\{/);ac=ac.join("(");ac=ac.split(/\}/);ac=ac.join(")");return ac};h.remove_claim_tree_deps_and_support=function(ac){var ad=/(.*)<sup>\((.*?)\)<\/sup>(.*)/;var ae;while((ae=ad.exec(ac))!=null){ac=ae[1]+ae[3]}return ac};h.do_claim_tree_analysis=function(al,ad,at,ai){var ap=/(\w+)(\s+)([C,c]laim)([s]*)(and|or|\s|\,|\-|\d)+(\w+)/;var am=" to - zu bis Ã  ";var an=" or , and oder ou ";var ah;var aq=[];var ar=[];var ac="";var ak=0;var ao;ar=new Array(ad+1);for(var ag=1;ag<=ad;ag++){if(typeof(al[ag])=="undefined"){continue}ao=false;ar[ag]=new Array(ag);for(var af=0;af<ag;af++){ar[ag][af]=0}words=h.split_punctuation(al[ag]);for(w1=2;w1<words.length;w1++){var aj=words[w1].toLowerCase();if(((aj.indexOf("claim")>=0)&&(aj.indexOf("claimed")<0))||(aj.indexOf("anspruch")>=0)||(aj.indexOf("ansprÃ¼che")>=0)||(aj.indexOf("revendication")>=0)){w1++;break}}var ae=false;ak=-1;for(;w1<words.length;w1++){if(words[w1].charAt(0)==" "){continue}the_number=parseInt(words[w1],10);if(the_number>0){if(the_number==ag){alert(at+ag+" refers back to itself")}else{if(the_number>ag){alert(at+ag+" refers back to a higher claim")}else{ar[ag][the_number]=1;if(ae==false){ak=the_number}else{to_number=the_number;if(to_number<=ak){alert(at+ag+" has a malformed dependency range ("+ak+" to "+to_number+")")}else{for(d1=ak+1;d1<=to_number;d1++){ar[ag][d1]=1}}ae=false}}}ao=true}else{if((ak>0)&&(am.indexOf(words[w1])>=0)){ae=true}else{if(an.indexOf(words[w1])<0){break}}}}if(ao==false){lower_claim=al[ag].toLowerCase();lower_claim=lower_claim.replace(/\s+/g," ");lower_claim=lower_claim.replace(/voranstehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorangehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorhergehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgenannt/g,"vorstehend");lower_claim=lower_claim.replace(/vorangegangen/g,"vorstehend");lower_claim=lower_claim.replace(/vorherig/g,"vorstehend");lower_claim=lower_claim.replace(/bisherig/g,"vorstehend");if((lower_claim.indexOf("preceding claims")>=0)||(lower_claim.indexOf("previous claims")>=0)||(lower_claim.indexOf("above claims")>=0)||(lower_claim.indexOf("foregoing claims")>=0)||(lower_claim.indexOf("revendications pr")>=0)||(lower_claim.indexOf("den vorstehenden anspr")>=0)){for(d1=1;d1<ag;d1++){ar[ag][d1]=1}}else{if((lower_claim.indexOf("the preceding claim")>=0)||(lower_claim.indexOf("the previous claim")>=0)||(lower_claim.indexOf("the above claim")>=0)||(lower_claim.indexOf("the foregoing claim")>=0)||(lower_claim.indexOf("la revendication pr")>=0)||(lower_claim.indexOf("dem vorstehenden anspr")>=0)){ar[ag][ag-1]=1}else{if((lower_claim.indexOf("preceding claim")>=0)||(lower_claim.indexOf("previous claim")>=0)||(lower_claim.indexOf("above claim")>=0)||(lower_claim.indexOf("foregoing claim")>=0)||(lower_claim.indexOf("revendication pr")>=0)||(lower_claim.indexOf("vorstehenden anspr")>=0)){for(d1=1;d1<ag;d1++){ar[ag][d1]=1}}else{if((lower_claim.indexOf("claim")>=0)||(lower_claim.indexOf("revendication")>=0)||(lower_claim.indexOf("anspr")>=0)){if(lower_claim.indexOf("claim sets")<0){alert(at+ag+"'s dependency not understood, treating as independent.")}}}}}}}ac="<PRE><CODE>"+h.format_claim_tree(ar,ad,ai)+"</CODE></PRE>";return ac};var I=[];var P=0;var n=0;h.reset_score_matrix=function(ac,ad){I=[];P=0;n=0;return};h.set_score_matrix_value=function(ae,ac,ad){if(typeof(I[ae])=="undefined"){I[ae]=[]}if(ae>P){P=ae}if(ac>n){n=ac}I[ae][ac]=ad;return};var q=["#808080","#909090","#a0a0a0","#b0b0b0","#c0c0c0","#d0d0d0","#e0e0e0","#f0f0f0","#ffff00","#f0ff00","#d0ff00","#b0ff00","#90ff00","#80ff00","#60ff00","#40ff00","#00ff00"];h.score_matrix_score_colour=function(ac){if(ac>=100){return q[16]}if(ac<=0){return q[0]}return q[Math.floor(ac*16/100)]};h.format_score_matrix=function(){var ac="";var ad;for(let row=1;row<=P;row++){if(typeof(I[row])=="undefined"){continue}ad=1;for(let col=1;col<=n;col++){if(typeof(I[row][col])!="undefined"){if(I[row][col]>ad){ad=I[row][col]}}}for(let col=1;col<=n;col++){if(typeof(I[row][col])!="undefined"){I[row][col]=100*I[row][col]/ad}}}ac=ac+"<BR><H2>Score matrix</H2>";ac=ac+"<TABLE class='fdiff4' BORDER=1><TR><TH style='width:30px'>%</TH>";for(col=1;col<=n;col++){ac=ac+"<TH style='width:30px'>"+col+"</TH>"}ac=ac+"<TH>old</TH>";ac=ac+"</TR>";for(row=1;row<=P;row++){if(typeof(I[row])!="undefined"){ac=ac+"<TR><TD><B>"+row+"</B></TD>";for(col=1;col<=n;col++){if(typeof(I[row][col])!="undefined"){ac=ac+"<TD bgcolor='"+h.score_matrix_score_colour(I[row][col])+"'>"+I[row][col].toFixed(0)+"</TD>"}else{ac=ac+"<TD>&nbsp;</TD>"}}ac=ac+"<TD>&nbsp;</TB></TR>"}}ac=ac+"<TR><TD><B>new</B></TD>";for(col=1;col<=n;col++){ac=ac+"<TD>&nbsp;</TD>"}ac=ac+"</TR>";ac=ac+"</TABLE>";if(false){ac=ac+"<TABLE>";ac=ac+"<TR>";for(let col=0;col<=16;col++){ac=ac+"<TD bgcolor='"+q[col]+"'>&nbsp;</TD>"}ac=ac+"</TR>";ac=ac+"</TABLE>"}return ac};h.insert_line_breaks=function(ad,ai){if((X==false)&&(O==false)){ad=ad.split(/\t/);ad=ad.join("<BR>\n");return ad}if(X==true){ad=ad.split("&#59;");ad=ad.join("&#59;<BR>");ad=ad.split("&#58;");ad=ad.join("&#58;<BR>")}if(O==true){ad=ad.split(",");ad=ad.join(",<BR>")}var ah;var aj="OPEN_BRACKET_FOO_FOO_FOO";var ae="CLOSE_BRACKET_FOO_FOO_FOO";var ag=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ah=ag.exec(ad))!=null){var ac=ah[2].split("<BR>");ac=ac.join("");ad=ah[1]+aj+ac+ae+ah[3]}ad=ad.split(aj);ad=ad.join("(");ad=ad.split(ae);ad=ad.join(")");ad=ad.split("<BR> <BR>");ad=ad.join("<BR>");ad=ad.split("<BR><BR>");ad=ad.join("<BR>");ad=ad.split("<BR><BR>");ad=ad.join("<BR>");ad=ad.split(" <BR>");ad=ad.join("<BR>");ad=ad.split("<BR>");ad=ad.join("<BR>&nbsp;&nbsp;&nbsp;");if(ai){ad=ad.replace(/\d+\./g,function af(ak){return"<BR><BR>"+ak})}return ad};h.post_cleanup=function(ae,ah){if(G==true){deleted_parts=ae.split(C);if(deleted_parts.length>0){var ag,ad,ac;ad=new RegExp(C+"([A-Za-zÃ-Ã¿]+)(\\s+)([A-Za-zÃ-Ã¿]+)"+aa+ab+h.get_color_string(0)+"([A-Za-zÃ-Ã¿]+)"+h.get_color_string_end()+s+"([\\S\\s]*)");ac=new RegExp(C+"([A-Za-zÃ-Ã¿]+)"+aa+ab+h.get_color_string(0)+"([A-Za-zÃ-Ã¿]+)(\\s+)([A-Za-zÃ-Ã¿]+)"+h.get_color_string_end()+s+"([\\S\\s]*)");ae=deleted_parts[0];for(var af=1;af<deleted_parts.length;af++){deleted_parts[af]=C+deleted_parts[af];if((ag=ad.exec(deleted_parts[af]))!=null){if(ag[4]===(ag[1]+ag[3])){deleted_parts[af]=ag[1]+ag[2]+ag[3]+ag[5]}}if((ag=ac.exec(deleted_parts[af]))!=null){if(ag[1]===(ag[2]+ag[4])){deleted_parts[af]=ag[2]+ag[3]+ag[4]+ag[5]}}ae=ae+deleted_parts[af]}}}if(ah==false){if(A==true){highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+C}else{highlight_and_rem_start='<span style="BACKGROUND-COLOR: LightGrey">'+C}highlight_and_rem_end=aa+h.get_color_string_end();ae=(ae.split(C)).join(highlight_and_rem_start);ae=(ae.split(aa)).join(highlight_and_rem_end)}if((ah==true)&&(x==true)){highlight_and_add_start=h.get_color_string(0)+ab;highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+C;highlight_and_add_end=s+h.get_color_string_end();highlight_and_rem_end=aa+h.get_color_string_end();ae=(ae.split(ab)).join(highlight_and_add_start);ae=(ae.split(C)).join(highlight_and_rem_start);ae=(ae.split(s)).join(highlight_and_add_end);ae=(ae.split(aa)).join(highlight_and_rem_end)}ae=h.insert_line_breaks(ae,ah);return ae};h.split_and_diff=function(aP,aO,aM){var aG,aE,ai;var aw,av,al;var aN,aj;var ap;var ax;var ad;var az,ak;var ar="";var aK,aI,aH;var an;var aL=aP;var aJ=aO;var at="text";var au=[];var ay=/\[\d+\]/;if(aM=="DESCMAGICFOO"){at="para";aG=h.split_desc(aP);aE=h.split_desc(aO);aw=aG.shift();av=aE.shift();if(aw<1){return"No original description paragraph(s) detected -- doing whole text comparison <HR>\n"+h.diff(aL,aJ)}aM=""}else{at="claim";aP=h.ocr_cleanup(aP);aO=h.ocr_cleanup(aO);aG=h.split_claims(aP);aE=h.split_claims(aO);aw=aG.shift();av=aE.shift();if(aw<1){return"No original claim number(s) detected -- doing whole text comparison <HR>\n"+h.diff(aL,aJ)}if(B.length>0){aN=h.split_desc(aM);aj=aN.shift()}else{aN=[];aj=0}}ar=ar+"<TABLE class='fdiff4' BORDER=1><TR class='fdiff4'><TH class='fdiff4'>New<BR>"+at+"</TH><TH class='fdiff4'>Old<BR>"+at+"</TH><TH class='fdiff4 noprint'>Base<BR>override</TH>";if(at=="claim"){ar=ar+"<TH class='fdiff4 noprint'>Use<BR>desc</TH>"}ar=ar+"<TH class='fdiff4'><DIV contenteditable>"+D+"</DIV></TH></TR>\n";if((typeof aE[0]!="undefined")&&(aE[0]!="")){ar=ar+"<TR class='fdiff4'><TD class='fdiff4'></TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD>";if(at=="claim"){ar=ar+"<TD class='fdiff noprint'>&nbsp;</TD>"}ar=ar+"<TD class='fdiff4'>"+aE[0]+"</TD></TR>\n"}h.reset_feature_blocks();h.reset_score_matrix();for(c2=1;c2<=av;c2++){first_absent=c2;while((c2<av)&&((typeof aE[c2]=="undefined")||(aE[c2]==""))){c2++}if(c2>first_absent){ar=ar+"<TR class='fdiff4'><TD class='fdiff4'>"+first_absent;if(c2>(first_absent+1)){ar=ar+"-"+(c2-1)}ar=ar+"</TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD><TD class='fdiff4'></TD></TR>\n"}an=Q;score_list=[];best_claim=-1;az=false;if((best_claim=h.get_main_base_claim(c2))>=0){if((best_claim>0)&&(typeof aG[best_claim]=="undefined")){alert("Base "+at+" "+best_claim+" for "+at+" "+c2+" not found in original "+at+"s!");best_claim=-1}else{az=true}}ak=false;for(var ad=0;ad<B.length;ad++){if(B[ad]==c2){ak=true;break}}if(ak==false){for(var aC=0;aC<t.length;aC++){if(t[aC]==c2){if(z[aC].search(ay)>=0){ak=true;if(aj==0&&aM!=""){aN=h.split_desc(aM);aj=aN.shift()}}}}}aE[c2]=h.find_feature_blocks(c2,aE[c2]);if(best_claim<0){for(var ah=1;ah<=aw;ah++){if(typeof aG[ah]=="undefined"){continue}ap=h.fdiff3(aG[ah],aE[c2]);diff_score=h.count_unchanged(ap);if(diff_score>an){best_claim=ah;an=diff_score}h.insert_in_score_list(score_list,ah,diff_score);h.set_score_matrix_value(c2,ah,diff_score)}}ai=aG.slice();var ag=h.get_claim_base_exclusions(c2,aw,aj,ak);al=aw;if((aj>0)&&(ak==true)){for(var ad=1;ad<=aj;ad++){ai[aw+ad]=aN[ad]}al=aw+aj}for(var ae=0;ae<ag.length;ae++){ah=ag[ae];if((ah>0)&&(ah<=al)){ai[ah]=undefined;az=true}else{if(ah==0){for(ah=0;ah<=al;ah++){ai[ah]=undefined}az=true}}}if(best_claim>0){ax=[best_claim];ap=h.fdiff3(aG[best_claim],aE[c2])}else{ax=["N/A"];ap=h.fdiff3("",aE[c2])}ap=h.replace_feature_markers(ap);ap=h.collect_deleted_parts(ap);ap=h.recode_added_parts(ai,al,ap,ax);ar=ar+"<TR class='fdiff4'><TD class='fdiff4'>"+c2+"</TD><TD class='fdiff4'>";if(best_claim>0){ar=ar+"<SPAN>"+ax[0]+'</SPAN><SPAN class="tooltip">'+aG[best_claim]+"</SPAN>"}else{ar=ar+ax[0]}claim_tree_legend=""+ax[0];for(ad=1;ad<ax.length;ad++){var aq=/([\S\s]+>)(\d+)(<[\s\S]+)/;var ac,ao;var am=ax[ad];if((ac=aq.exec(ax[ad]))!=null){ao=parseInt(ac[2]);if(ao>aw){desc_para=ao-aw;am="<SPAN>"+ac[1]+"["+desc_para+"]"+ac[3]+'</SPAN><SPAN class="tooltip">'+ai[ao]+"</SPAN>";claim_tree_legend_text=",["+desc_para+"]"}else{am="<SPAN>"+ax[ad]+'</SPAN><SPAN class="tooltip">'+aG[ao]+"</SPAN>";claim_tree_legend_text=","+ao}if((ao!=ax[0])&&(claim_tree_legend.indexOf(claim_tree_legend_text)<0)){claim_tree_legend=claim_tree_legend+claim_tree_legend_text}}ar=ar+am}au[c2]=claim_tree_legend;ar=ar+"</TD><TD class='fdiff4 noprint' align='center'>";if(az==true){ar=ar+'<INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'" value="'+h.get_base_text_for_claim(c2)+'">'}else{ar=ar+' <INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'">'}loop_end=score_list.length/2;if(loop_end>3){loop_end=3}for(ad=1;ad<loop_end;ad++){ar=ar+'<BR><span style="font-size:smaller">'+score_list[ad*2]+"="+Math.round((score_list[ad*2+1]*100)/score_list[1])+"% </span>"}if(at=="claim"){ar=ar+"</TD><TD class='fdiff4 noprint' align='center'>";if(ak==true){ar=ar+'<INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'" checked>'}else{ar=ar+' <INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'">'}}ar=ar+"</TD><TD class='fdiff4'><DIV contenteditable>";var af="";for(ad=0;ad<ap.length;ad++){af=af+ap[ad]}ar=ar+h.post_cleanup(af,0)+"</DIV></TD></TR>\n"}ar=ar+"</TABLE>\n";aK=h.format_claim_span(aG,aw);aI=h.format_claim_span(aE,av);ar=ar+"<p>Original "+at+"s detected: "+aK+"<br>Amended "+at+"s detected: "+aI;if((M==true)&&((aK.search("Warn")>-1)||(aI.search("Warn")>-1))){alert("At least one of the detected "+at+" sets has irregular numbering.\nPlease verify that all "+at+" are properly identified and edit the text if necessary.\n\nYou can turn this message off by de-selecting the option below.")}if(at=="claim"){if(B.length>0){aH=h.format_claim_span(aN,aj);ar=ar+"<br>Original description paragraphs detected: "+aH}else{ar=ar+"<br>(Description not analyzed)"}if(v==true){var aF=h.do_claim_tree_analysis(aG,aw,"Original claim ");var aD=h.do_claim_tree_analysis(aE,av,"Amended claim ",au);var aB=h.remove_claim_tree_deps(aD);var aA=h.remove_claim_tree_deps_and_support(aD);ar=ar+"<BR><H2>Claim trees</H2>";ar=ar+"<TABLE class='fdiff4' cellpadding='10' border=1><TR class='fdiff4'><TH class='fdiff4'> Original </TH><TH class='fdiff4'> Amended </TH><TH class='fdiff4'> Amended (+supt)</TH><TH class='fdiff4'> Amended (+supt +deps)</TH></TR><TR class='fdiff4'><TD valign='top' style='vertical-align: top !important'>";ar+=aF;ar+="</TD><TD valign='top' style='vertical-align: top !important'>";ar+=aA;ar+="</TD><TD valign='top' style='vertical-align: top !important'>";ar+=aB;ar+="</TD><TD valign='top' style='vertical-align: top !important'>";ar+=aD;ar+="<BR><BR>&nbsp;&nbsp;<U>Legend:</U><BR>&nbsp;&nbsp;<SUP>(<B><U>2</U></B>)</SUP> base claim<BR>&nbsp;&nbsp;<SUP>(<B>3</B>)</SUP> support claim<BR>&nbsp;&nbsp;<SUP>(4)</SUP> inherited from parent";ar=ar+"</TD></TR></TABLE>"}if(W==true){ar=ar+h.format_score_matrix()}}return ar};h.diff=function(aj,ai){var ah;var ac;var ae,ad;var ag,af;aj=h.ocr_cleanup(aj);ai=h.ocr_cleanup(ai);ah=h.fdiff3(aj,ai);output="";for(ac=0;ac<ah.length;ac++){output=output+ah[ac]}output=h.post_cleanup(output,1);return output};h.insert_new_lines=function(ae){var af="fj1423lkfnsfdsghdh32342";var ad=new RegExp("^([\\s\\S]*\\.)[ \\t]+([\\s\\S]*)");var ac=new RegExp("^([\\s\\S]*\\d+\\.)$");while((matches=ad.exec(ae))!=null){if(ac.test(matches[1])){ae=matches[1]+af+matches[2]}else{ae=matches[1]+"\n\n"+matches[2]}}ae=ae.split(af);ae=ae.join(" ");return ae};h.set_basis_threshold=function(ac){if((ac>=5)&&(ac<=50)){Q=ac;return"OK"}else{return"Value out of bounds"}};h.set_fdiff3_highlights=function(ac){if(ac=="checked"){x=true}else{x=false}return"OK"};h.set_fdiff4_strikeout_highlights=function(ac){if(ac=="checked"){A=true}else{A=false}return"OK"};h.set_fdiff4_warn_claims=function(ac){if(ac=="checked"){M=true}else{M=false}return"OK"};h.set_fdiff4_simplify_legend=function(ac){if(ac=="checked"){o=true}else{o=false}return"OK"};h.set_fdiff4_tree_analysis=function(ac){if(ac=="checked"){v=true}else{v=false}return"OK"};h.set_fdiff4_score_matrix=function(ac){if(ac=="checked"){W=true}else{W=false}return"OK"};h.set_convert_claim_styles=function(ac){if(ac=="checked"){Z=true}else{Z=false}return"OK"};h.set_ignore_hyphenation=function(ac){if(ac=="checked"){R=true}else{R=false}return"OK"};h.set_eszett_normalization=function(ac){if(ac=="checked"){L=true}else{L=false}return"OK"};h.set_ignore_case=function(ac){if(ac=="checked"){a=true}else{a=false}return"OK"};h.set_ignore_spaces=function(ac){if(ac=="checked"){N=true}else{N=false}return"OK"};h.set_ignore_in_brackets=function(ac){if(ac=="checked"){j=true}else{j=false}return"OK"};h.set_fix_glued_words=function(ac){if(ac=="checked"){G=true}else{G=false}return"OK"};h.set_insert_line_breaks_indents=function(ac){if(ac=="checked"){X=true}else{X=false}return"OK"};h.set_insert_line_breaks_indents2=function(ac){if(ac=="checked"){O=true}else{O=false}return"OK"};h.clear_claim_base_overrides=function(){t=[];z=[];return"OK"};h.set_claim_base_override=function(ac,ae){var ad=parseInt(ac);if(ad<1){alert('Claim value "'+ac+'" out of bounds in claim base override!');return"Error"}ae=ae.split(/\s+/);ae=ae.join("");t.push(ad);z.push(ae);return"OK"};h.clear_use_desc_overrides=function(){B=[];return"OK"};h.set_use_desc_override=function(ac){var ad=parseInt(ac);if(ad<1){alert('Claim value "'+ac+'" out of bounds in use description override!');return"Error"}B.push(ad);return"OK"};h.get_version=function(){return u};h.set_title=function(ac){D=ac;return"OK"};h.regenerate_title=function(){if(U!=""){D="'"+w+"' vs. '"+E+"'"}else{D="Difference"}return"OK"};h.set_header_orig=function(ac){E=ac;h.regenerate_title();return"OK"};h.set_header_new=function(ac){w=ac;h.regenerate_title();return"OK"};h.set_dossier_number=function(ac){U=ac;h.regenerate_title();return"OK"};h.filter_table_contents=function(ag){var al=/([\s\S]*?)<span class="tooltip">([\s\S]*?)<\/span>([\s\S]*)/;var ae=/([\s\S]*?)<\/span>([\s\S]*)/;var ad=/([\s\S]*?)<div contenteditable="">([\s\S]*?)<\/div>([\s\S]*)/;var ac=/<table([\s\S]*)/;var af,aj;ag=(ag.split(/ style="cursor: default;"/)).join("");ag=(ag.split(/ style="cursor: default; /)).join(' style="');var am=ag.split(/<\/table>/);if(am.length<1){return ag}var an=am[0].split(/<tr/);for(row=1;row<an.length;row++){var ai;if(row==1){ai=an[row].split(/<th/)}else{ai=an[row].split(/<td/)}if(ai.length>=5){ai[3]=ai.pop();if(ai.length==5){ai.pop()}if(row==1){an[row]=ai.join("<th")}else{an[row]=ai.join("<td")}}while((af=al.exec(an[row]))!=null){var ah=(af[2].match(/\<span/g)||[]).length;var ak=(af[2].match(/\<\/span/g)||[]).length;while(ah!=ak){if((aj=ae.exec(af[3]))!=null){af[2]=af[2]+"</span>"+aj[1];af[3]=aj[2];ah=(af[2].match(/\<span/g)||[]).length;ak=(af[2].match(/\<\/span/g)||[]).length}else{ah=ak}}an[row]=af[1]+af[3]}while((af=ad.exec(an[row]))!=null){an[row]=af[1]+af[2]+af[3]}}am[0]=an.join("<tr");ag=am.join("</table>");return ag};h.filter_table_colours=function(ad){var ac=/([\s\S]*)<span style=\"background([\s\S]*?)>([\s\S]*?)<\/span>([\s\S]*)/;var af;var ae=ad.split(/<tr/);for(row=1;row<ae.length;row++){while((af=ac.exec(ae[row]))!=null){ae[row]=af[1]+af[3]+af[4]}}ad=ae.join("<tr");return ad};return h}());