var fdiff=(function(){var f={};var m="4.73";var O="<u>";var l="</u>";var v="<s>";var N="</s>";var h=0;var i=0;var e=1;var b=2;var L=3;var H=4;var A=5;var k=6;var r=7;var d=1;var J=7;var F=15;var q=true;var s=true;var C=true;var j=true;var o=false;var G=false;var B=false;var a=false;var D=false;var g=false;var M=true;var y=true;var z=false;var K=false;var E=false;var n=[];var t=[];var u=[];var w="Difference";var x="";var p="";var I="";f.fix_unclosed_brackets=function(V){var R;var U,P;var T="";var Q="",S="";R=V.toString().split("");for(P=0;P<R.length;P++){U=R[P];if(T!==""){T=T+U;if(U===")"){if(g==false){Q=Q+T}T=""}}else{if(U==="("){T=U;if(S!==""){Q=Q+S;S=""}}else{S=S+U}}}if(T!==""){return Q+"{"+T.substr(1)}return Q+S};f.handle_reference_signs=function(R){if(g==true){var Q;var P=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((Q=P.exec(R))!=null){R=Q[1]+Q[3]}}return f.fix_unclosed_brackets(R)};f.LCSubStr2=function(Z,W,S,Q){var R,P,ab,aa;var V=new Array(-1,-1,-1,-1);var Y=[];var X=0;var U,T;for(ab=0;ab<S.length;ab++){R=S[ab];Y[ab]=[];for(aa=0;aa<Q.length;aa++){P=Q[aa];if(Z[R]===W[P]){if((ab===0)||(aa===0)){Y[ab][aa]=1}else{Y[ab][aa]=Y[ab-1][aa-1]+1}if(Y[ab][aa]>X){X=Y[ab][aa];V[0]=S[ab-X+1];V[1]=S[ab];V[2]=Q[aa-X+1];V[3]=Q[aa]}}else{Y[ab][aa]=0}}}return V};f.recurse=function(ag,af,V,ar){var aa,al,Z,ak,aj,ai;var U=[];var ao=[];var Y=[];var at=[];var ae=[];var T=[];var W;var R,Q,ab,ah;var ad,S,am,X;var au,aq;var an=/\s/;if(ag.length<=0){if(af.length>=1){return[O].concat(af,l)}else{return[""]}}else{if(af.length<=0){return[v].concat(ag,N)}}if(a){var ap=[],P=[];for(var ac=0;ac<ag.length;ac++){ap.push(ag[ac].toUpperCase())}for(var ac=0;ac<af.length;ac++){P.push(af[ac].toUpperCase())}W=f.LCSubStr2(ap,P,V,ar)}else{W=f.LCSubStr2(ag,af,V,ar)}R=W[0];Q=W[1];ab=W[2];ah=W[3];if(R<0){ad=[];while((ag.length>0)&&(af.length>0)&&(ag[0]===af[0])){ad.push(ag.shift());af.shift()}S=[];while((ag.length>0)&&(af.length>0)&&(ag[ag.length-1]===af[af.length-1])){S.unshift(ag.pop());af.pop()}if(ag.length>0){am=[v];am=am.concat(ag);am.push(N)}else{am=[]}if(af.length>0){X=[O];X=X.concat(af);X.push(l)}else{X=[]}return ad.concat(am,X,S)}if((R===0)&&(Q===ag.length-1)&&(ab===0)&&(ah===af.length-1)){return af}aa=ag.splice(0,R);al=af.splice(0,ab);aj=ag.splice(0,Q-R+1);ai=af.splice(0,ah-ab+1);Z=ag;ak=af;for(aq=0;aq<V.length;aq++){au=V[aq];if(au>Q){ao.push(au-Q-1)}if(au<R){U.push(au)}}for(aq=0;aq<ar.length;aq++){au=ar[aq];if(au>ah){at.push(au-ah-1)}if(au<ab){Y.push(au)}}for(au=0;au<aj.length;au++){if(!an.test(aj[au])){ae.push(au)}}for(au=0;au<ai.length;au++){if(!an.test(ai[au])){T.push(au)}}return(f.recurse(aa,al,U,Y)).concat(f.recurse(aj,ai,ae,T),f.recurse(Z,ak,ao,at))};f.find_keyword_indices=function(T){var S=[];var Q;var R;var P=/[\s,;:?!"'\-&\/()]/;for(Q=0;Q<T.length;Q++){R=T[Q];if(R===""){continue}if(P.test(R)){continue}S.push(Q)}return S};f.split_punctuation=function(aa){var Z;var X=[];var U="";var T,P="",W;var ab=/[\s,.;:?!"'\-\/]/;var R=/[a-z,A-Z,\#,0-9]/;var Q=/(.*?)([+\-±\s]+)(\d+\.\d+)(\s+)(.*)/;var S=/\d+\.\d+/;var V;Z=[];if(S.test(aa)){while((V=Q.exec(aa))!=null){Z=Z.concat(V[1].toString().split(""));Z=Z.concat(V[2].toString().split(""));Z.push(V[3]);Z=Z.concat(V[4].toString().split(""));aa=V[5]}}if(aa!==""){Z=Z.concat(aa.toString().split(""))}for(W=0;W<Z.length;W++){T=Z[W];if(U!==""){U=U+T;if(T===")"){if(g==false){X.push(U)}else{if((X.length>0)&&(X[X.length-1]===" ")){X.pop()}}U=""}}else{if(T==="("){U=T;if(P!==""){X.push(P);P=""}}else{if(ab.test(T)){if(P!==""){X.push(P)}X.push(T);P=""}else{if(T==="&"){if(P!==""){X.push(P)}P="&";for(var Y=W+1;Y<Z.length;Y++){if(R.test(Z[Y])){P=P+Z[Y]}else{break}}if((Y<Z.length)&&(Z[Y]===";")&&(Y>W+1)){X.push(P+";");W=Y}else{X.push("&")}P=""}else{P=P+T}}}}}if(P!==""){X.push(P)}return X};f.remove_deleted_tabs=function(R){var Q=false;for(var P=0;P<R.length;P++){if(R[P]==v){Q=true}else{if(Q==true){if(R[P]==N){Q=false}else{if(R[P]=="\t"){R[P]=" "}}}}}for(var P=0;P<R.length-2;P++){if((R[P]==v)&&(R[P+1]==" ")&&(R[P+2]==N)){R.splice(P,3);P=P-1}}for(var P=0;P<R.length-2;P++){if((R[P]==O)&&(R[P+2]==l)&&((R[P+1]==" ")||(R[P+1]=="\t"))){R.splice(P+2,1);R.splice(P,1)}}return R};f.fdiff3=function(V,U){var T,R;var Q,P;var S;T=f.split_punctuation(V);R=f.split_punctuation(U);Q=f.find_keyword_indices(T);P=f.find_keyword_indices(R);S=f.recurse(T,R,Q,P);return f.remove_deleted_tabs(S)};f.detect_language=function(V){var Q=0,P=0,S=0;var U="X";var T,R;P=1+(V.split(/claim/i)).length-1+(V.split(/characteri/i)).length-1+(V.split(/according/i)).length-1;Q=1+(V.split(/revendication/i)).length-1+(V.split(/caract.ris/i)).length-1+(V.split(/selon/i)).length-1;S=1+(V.split(/anspr.ch/i)).length-1+(V.split(/gekennzeich/i)).length-1+(V.split(/nach/i)).length-1;if(P>=S){T=P;R=S}else{T=S;R=P}if(Q>=T){R=T;T=Q}else{if(Q>=R){R=Q}}if((T/R)>=3){if(T==P){U="E"}else{if(T==S){U="D"}else{U="F"}}}return U};f.correct_missing_spaces=function(V){var U;U=f.detect_language(V);V=V.split(/\:/);V=V.join(": ");V=V.split(/\;/);V=V.join("; ");V=V.split(/\,/);V=V.join(", ");if(U=="E"){V=V.split(/ ofa /);V=V.join(" of a ");V=V.split(/ wherein/);V=V.join(" wherein ");V=V.split(/ wherein :/);V=V.join(" wherein:");V=V.split(/ said/);V=V.join(" said ");V=V.split(/ and\/or/);V=V.join(" ANDSLASHOR ");V=V.split(/ and\,/);V=V.join(" ANDCOMMA ");V=V.split(/ and/);V=V.join(" and ");V=V.split(/ ANDSLASHOR /);V=V.join(" and/or");V=V.split(/ ANDCOMMA /);V=V.join(" and, ");V=V.split(/inthat/);V=V.join("in that");V=V.split(/ that/);V=V.join(" that ");V=V.split(/ that :/);V=V.join(" that:");V=V.split(/orfurther/);V=V.join("or further");V=V.split(/orwhere/);V=V.join("or where");V=V.split(/orthat/);V=V.join("or that")}if(U=="E"){var Q=/(claim)(\d)/i;var P=/(claims)(\d)/i;var T;if((T=Q.exec(V))!=null){var R=/([\s\S]*)(claim)(\d+)([\s\S]*)/i;while((T=R.exec(V))!=null){V=T[1]+T[2]+" "+T[3]+T[4]}}if((T=P.exec(V))!=null){var S=/([\s\S]*)(claims)(\d+)([\s\S]*)/i;while((T=S.exec(V))!=null){V=T[1]+T[2]+" "+T[3]+T[4]}}}return V};f.ocr_cleanup=function(R){if(y==true){R=f.correct_missing_spaces(R)}R=f.handle_reference_signs(R);if(D==true){R=R.split(/\s+\)/);R=R.join(")");R=R.split(/\(\s+/);R=R.join("(");R=R.split(/\s+\]/);R=R.join("]");R=R.split(/\[\s+/);R=R.join("[");R=R.split(/\s+\,/);R=R.join(",");R=R.split(/\s+\;/);R=R.join(";");R=R.split(/\s+\:/);R=R.join(":");R=R.split(/\s+\./);R=R.join(".")}R=R.split("<RTI>");R=R.join("");R=R.split("<RTIgt;");R=R.join("");R=R.split("</RTI>");R=R.join("");R=R.replace(/\&/g,"AMPERSANDFOOBAR");R=R.replace(/\;/g,"&#59;");R=R.replace(/\:/g,"&#58;");R=R.replace(/AMPERSANDFOOBAR/g,"&amp;");R=R.replace(/\u2013|\u2014/g,"-");R=R.replace(/\u2018|\u2019|\u201A|\u0060/g,"'");R=R.replace(/\u201c|\u201d|\u201e/g,'"');R=R.split("<");R=R.join("&lt;");R=R.split(">");R=R.join("&gt;");if(B==true){R=R.replace(/\u00df/g,"ss")}R=R.split(/[ \t]+/);R=R.join(" ");R=R.split(/[\n\f\r]+/);R=R.join("\t");if(G==true){var P=/(.*[a-zA-Z\u00e9\u00e8\u00f6\u00fc]+)\-\s*(\w+.*)/;var Q;while((Q=P.exec(R))!=null){R=Q[1]+Q[2]}}return R};f.ocr_cleanup_desc=function(S){var P=g;var Q=G;var R;g=false;G=false;R=f.ocr_cleanup(S);g=P;G=Q;return R};f.form_claim_reg_exp=function(R){var Q;var P;R=R.toString();Q=R.split("");re="";for(P=0;P<Q.length;P++){if(P>0){re=re+"\\s{0,1}"}if(Q[P]==1){pat="[1,l,I,i]"}else{if(Q[P]==2){pat="[2,Z,z]"}else{if(Q[P]==5){pat="[5,S,s]"}else{if(Q[P]==0){pat="[0,O,o]"}else{pat=Q[P]}}}}re=re+pat}return re};f.handle_strict_patterns=function(S,ae,X,V,af,Z){var T;var R;var ac=0;var Q=100000;var ag=[];var U;var ab;var Y;var aa=false;var W=[];if(typeof(Z)=="undefined"){Z=""}T=new RegExp("(.*\\.\\s*)("+ae+")(\\d+)("+X+")(.*)$",Z);while((R=T.exec(S))!=null){claim_no=parseInt(R[3],10);if(typeof ag[claim_no]!="undefined"){aa=true;W.push(claim_no)}ag[claim_no]=R[2]+R[3]+R[4]+R[5];S=R[1];if(ac<claim_no){ac=claim_no}if(Q>claim_no){Q=claim_no}}v2="";T=new RegExp("^(.*?)("+ae+")(\\d+)("+X+")(.*)$",Z);while((R=T.exec(S))!=null){claim_no=parseInt(R[3],10);S=R[1];v2=R[2]+R[3]+R[4]+R[5]+v2;if((claim_no<Q)&&(claim_no>0)){ag[claim_no]=v2;v2="";Q=claim_no}if(ac<claim_no){ac=claim_no}}if(aa==true){var ad="Warning: the following claims/paragraphs have been found multiple times:\n";ad=ad+W.pop();while(W.length>0){ad=ad+", "+W.pop()}alert(ad+".\nPlease check the text in the input window.")}ag[0]=S;if(ac>1000){var P=ac;ac=1000;while((ac>0)&&(typeof(ag[ac])=="undefined")){ac--}alert("Something probably went wrong.\nHighest claim number detected: "+P+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ac+".")}Y=0;for(c=1;c<=ac+3;c++){if(typeof ag[c]=="undefined"){T=new RegExp(f.form_claim_reg_exp(c));if(T.test(ag[Y])){T=new RegExp(V+f.form_claim_reg_exp(c)+af);if(T.test(ag[Y])){if(Y==0){T=new RegExp("(.*?)("+V+f.form_claim_reg_exp(c)+af+")(.*)",Z)}else{T=new RegExp("(.*?[\\.\\s]+)("+V+f.form_claim_reg_exp(c)+af+")(.*)",Z)}if((R=T.exec(ag[Y]))!=null){ag[Y]=R[1];ag[c]=R[2]+R[3];Y=c;if(c>ac){ac=c}}}}}else{Y=c}}ag.unshift(ac);return ag};f.handle_square_brackets_type_claims=function(P){return f.handle_strict_patterns(P,"\\[","\\]","\\[[0oO\\s]*","\\s{0,1}\\]")};f.handle_siemens_type_claims=function(Q){var P=f.detect_language(Q);if(P=="E"){return f.handle_strict_patterns(Q,"\\[claim\\s+","\\]","\\[claim\\s+","\\s{0,1}\\]","i")}else{if(P=="D"){return f.handle_strict_patterns(Q,"\\[anspruch\\s+","\\]","\\[anspruch\\s+","\\s{0,1}\\]","i")}else{if(P=="F"){return f.handle_strict_patterns(Q,"\\[revendication\\s+","\\]","\\[revendication\\s+","\\s{0,1}\\]","i")}else{return[0,Q]}}}};f.handle_claim_type_claims=function(Q){var P=f.detect_language(Q);if(P=="E"){return f.handle_strict_patterns(Q,"claim\\s+","\\.","claim\\s+","\\s{0,1}\\.","i")}else{if(P=="D"){return f.handle_strict_patterns(Q,"anspruch\\s+","\\.","anspruch\\s+","\\s{0,1}\\.","i")}else{if(P=="F"){return f.handle_strict_patterns(Q,"revendication\\s+","\\.","revendication\\s+","\\s{0,1}\\.","i")}else{return[0,Q]}}}};f.count_matches=function(S,P){var R;var Q=0;while((R=P.exec(S))!=null){Q=Q+1;S=R[1]}return Q};f.detect_claim_numbering_style=function(T){var ah=/\.\s*\d+\.(.*)/;var U=/^\d+\./;var ag=/\[\d+\]\s+(.*)/;var Q=/\[\s*anspruch\s+\d+\s*\](.*)/i;var P=/\[\s*revendication\s+\d+\s*\](.*)/i;var aj=/\[\s*claim\s+\d+\s*\](.*)/i;var ae=/\.\s*\d+\/(.*)/;var V=/^\d+\//;var ad=/\.\s*\d+\s{0,1}\-(.*)/;var Z=/^\d+\s{0,1}\-/;var ab=/\.\s*\d+\)(.*)/;var R=/^\d+\)/;var ac=/\.\s*anspruch\s+\d+\.(.*)/i;var aa=/\.\s*revendication\s+\d+\.(.*)/i;var Y=/\.\s*claim\s+\d+\.(.*)/i;var W=[0,0,0,0,0,0,0,0,0,0,0,0];var S;W[e]=f.count_matches(T,ah);if((matches=U.exec(T))!=null){W[e]=W[e]+1}W[b]=f.count_matches(T,ag);W[L]=f.count_matches(T,Q)+f.count_matches(T,P)+f.count_matches(T,aj);W[r]=f.count_matches(T,ac)+f.count_matches(T,aa)+f.count_matches(T,Y);W[H]=f.count_matches(T,ae);if((matches=V.exec(T))!=null){W[H]=W[H]+1}W[A]=f.count_matches(T,ad);if((matches=Z.exec(T))!=null){W[A]=W[A]+1}var ai=g;g=true;var X=f.split_punctuation(T);S=X.join("");g=ai;W[k]=f.count_matches(S,ab);if((matches=R.exec(S))!=null){W[k]=W[k]+1}largest_score=W[d];largest_score_style=d;second_largest_score=0;second_largest_score_style=i;for(var af=d+1;af<=J;af++){if(W[af]>second_largest_score){if(W[af]>largest_score){second_largest_score=largest_score;second_largest_score_style=largest_score_style;largest_score=W[af];largest_score_style=af}else{second_largest_score=W[af];second_largest_score_style=af}}}if((largest_score_style==b)&&(largest_score>=10)){claim_style=largest_score_style}else{if((second_largest_score!=0)&&(largest_score<2*second_largest_score)){claim_style=i}else{claim_style=largest_score_style}}return claim_style};f.split_claims=function(X){var aa;var R;var ad=0;var V=100000;var T=[];var ae;var ac;var W;var S=false;var ab=[];if(M==true){ae=f.detect_claim_numbering_style(X)}else{ae=i}var U="\\.";var Z="[.,]";var P="\\s{0,1}\\.";if(ae==b){return f.handle_square_brackets_type_claims(X)}else{if(ae==L){return f.handle_siemens_type_claims(X)}else{if(ae==r){return f.handle_claim_type_claims(X)}else{if(ae==H){U="\\/";Z=U;P="\\s{0,1}\\/"}else{if(ae==A){U="\\s{0,1}\\-";Z=U;P=U}else{if(ae==k){U="\\)";Z=U;P="\\s{0,1}\\)"}}}}}}aa=new RegExp("(.*\\.\\s+)(\\d+)("+U+")(.*)$");while((R=aa.exec(X))!=null){claim_no=parseInt(R[2],10);if(claim_no>1000){X=R[1]+"["+R[2]+"]"+R[3]+R[4];continue}if(typeof T[claim_no]!="undefined"){S=true;ab.push(claim_no)}T[claim_no]=""+claim_no+R[3]+R[4];X=R[1];if(ad<claim_no){ad=claim_no}if(V>claim_no){V=claim_no}}v2="";aa=new RegExp("^(.*?)(\\d+)("+U+")(\\s+.*)$");while((R=aa.exec(X))!=null){claim_no=parseInt(R[2],10);X=R[1];v2=""+claim_no+R[3]+R[4]+v2;if((claim_no<V)&&(claim_no>0)){T[claim_no]=v2;v2="";V=claim_no}if(ad<claim_no){ad=claim_no}}if(S==true){var Y="Warning: the following claims/paragraphs have been found multiple times:\n";Y=Y+ab.pop();while(ab.length>0){Y=Y+", "+ab.pop()}alert(Y+".\nPlease check the text in the input window.")}T[0]=X;if(typeof T[1]=="undefined"){if((c=T[0].indexOf("1 "))==0){T[1]=T[0];T[0]=""}else{if((c=T[0].indexOf(" 1 "))!==-1){T[1]=T[0].substring(c);T[0]=T[0].substring(0,c)}else{aa=new RegExp("^("+f.form_claim_reg_exp(1)+P+")(.*)");if((R=aa.exec(T[0]))!=null){T[0]="";T[1]=R[1]+R[2]}}}}if(ad>1000){var Q=ad;ad=1000;while((ad>0)&&(typeof(T[ad])=="undefined")){ad--}alert("Something probably went wrong.\nHighest claim number detected: "+Q+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ad+".")}W=0;for(c=1;c<=ad+15;c++){if(typeof T[c]=="undefined"){if(T[W].indexOf("."+c)!==-1){aa=new RegExp("(.*?\\.)("+c+U+")(\\s+.*)");if((R=aa.exec(T[W]))!=null){T[W]=R[1];T[c]=R[2]+R[3];W=c;if(c>ad){ad=c}}}}else{W=c}}W=0;for(c=1;c<=ad+3;c++){if(typeof T[c]=="undefined"){if(T[W].indexOf(c)!==-1){aa=new RegExp("(.*?\\.\\s*)("+c+")(\\s+.*)");if((R=aa.exec(T[W]))!=null){if((R[1].length>=2)&&((R[1].charAt(R[1].length-2)>="0")&&(R[1].charAt(R[1].length-2)<="9"))){}else{T[W]=R[1];T[c]=R[2]+R[3];W=c;if(c>ad){ad=c}}}}}else{W=c}}W=0;for(c=1;c<=ad+3;c++){if(typeof T[c]=="undefined"){aa=new RegExp(f.form_claim_reg_exp(c));if(aa.test(T[W])){aa=new RegExp("(.*?\\.\\s+)("+f.form_claim_reg_exp(c)+Z+")(.*)");if((R=aa.exec(T[W]))!=null){T[W]=R[1];T[c]=R[2]+R[3];W=c;if(c>ad){ad=c}}}}else{W=c}}if(ae==e){W=0;for(c=1;c<=ad+3;c++){if(typeof T[c]=="undefined"){aa=new RegExp(f.form_claim_reg_exp(c));if(aa.test(T[W])){aa=new RegExp("(.*?\\s+)("+c+U+"\\s{0,1})(\\D.*)");if((R=aa.exec(T[W]))!=null){T[W]=R[1];T[c]=R[2]+R[3];W=c;if(c>ad){ad=c}}}}else{W=c}}}W=0;for(c=1;c<=ad+3;c++){if(typeof T[c]=="undefined"){aa=new RegExp(f.form_claim_reg_exp(c));if(aa.test(T[W])){aa=new RegExp("(.*?\\s+)("+f.form_claim_reg_exp(c)+P+")(.*)");if((R=aa.exec(T[W]))!=null){T[W]=R[1];T[c]=R[2]+R[3];W=c;if(c>ad){ad=c}}}}else{W=c}}for(c=1;c<=ad;c++){if(typeof T[c]!="undefined"){T[c]=f.fix_unclosed_brackets(T[c])}}T.unshift(ad);return T};f.handle_double_paragraphs=function(V){var X=/\[\d+\][^\S\t]+\[\d+\](.*)/;var R=/(.*?)\t(\[\d+\])([ ]+)(\[\d+\])(.*)/;var P=/(.*?)(\[\d+\])(.*)/;var S="";var Q="";if(V==""){return V}if(f.count_matches(V,X)>=1){while((matches=R.exec(V))!=null){var U=matches[1];var W=matches[2];var T=matches[4];V=matches[5];while((matches=P.exec(U))!=null){U=matches[1]+matches[3];S=S+matches[2]}Q=Q+U+"\t"+T;S=S+W}while((matches=P.exec(V))!=null){V=matches[1]+matches[3];S=S+matches[2]}Q=Q+V;return Q}return V};f.split_desc=function(T){if(T==""){return[0,T]}else{var Q;var P=/\.\s*\[\d+\](.*)/;var S=f.ocr_cleanup_desc(T);if(f.count_matches(S,P)>=2){S=f.handle_double_paragraphs(S);Q=f.handle_square_brackets_type_claims(S)}else{Q=S.split(/[\t]+/);while((Q.length>0)&&(Q[Q.length-1]=="")){Q.pop()}Q.unshift("");Q.unshift(Q.length-1)}for(var R=1;R<Q.length;R++){if(typeof Q[R]!="undefined"){Q[R]=f.fix_unclosed_brackets(Q[R])}}return Q}};f.calculate_score_for_word=function(P){if((P=="claim")||(P=="claims")||(P=="according")||(P=="characterised")||(P=="characterized")||(P=="Anspruch")||(P=="Ansprüche")||(P=="gekennzeichnet")||(P=="revendication")||(P=="revendications")||(P=="caractérisé")||(P=="caractérisée")){return 0}else{return P.length}};f.count_added=function(S){var Q=0;var R=0;var P;for(P=0;P<S.length;P++){if(S[P]==O){R=1}else{if(S[P]==l){R=0}else{if(S[P]==v){R=2}else{if(S[P]==N){R=0}else{if(R==1){Q=Q+f.calculate_score_for_word(S[P])}}}}}}return Q};f.count_unchanged=function(S){var R=0;var Q=0;var P;for(P=0;P<S.length;P++){if(S[P]==O){Q=1}else{if(S[P]==l){Q=0}else{if(S[P]==v){Q=2}else{if(S[P]==N){Q=0;R=R-1}else{if(Q==0){R=R+f.calculate_score_for_word(S[P])}}}}}}if(R>0){return R}else{return 0}};f.is_short_word=function(Q){var R=["the","a"," ","of","in","and","to","is","that","der","die","das","dem","des","den","im","und","le","la","dans","que","de"];for(var P=0;P<R.length;P++){if(Q==R[P]){return 1}}return 0};f.cross_out_deleted=function(R){var Q=0;var S=[];for(var P=0;P<R.length;P++){if(R[P]==v){Q=1}else{if(R[P]==N){Q=0}else{if(R[P]==O){Q=2}else{if(R[P]==l){Q=0}else{if(Q==0){S.push(R[P])}else{if(Q==1){if(R[P]==" "){S.push(" ")}else{S.push(Array(1+R[P].length).join("-"))}}}}}}}}return S};f.collect_deleted_parts=function(U){var T=0;var V,R,W,P=-1;var X;for(V=U.length-1;V>=0;V--){if(U[V]==N){P=V}else{if(U[V]==v){for(R=V-1;R>=0;R--){if(f.is_short_word(U[R])){continue}else{if(U[R]==l){for(W=R-1;W>=0;W--){if(U[W]==O){break}}if((W>=0)&&(P>0)){if(V-R>1){short_words=U.splice(R+1,V-R-1);Array.prototype.splice.apply(U,[R,0].concat(short_words));R=R+short_words.length;Array.prototype.splice.apply(U,[V+1,0].concat(short_words));P=P+short_words.length}var Q=R-W+1;added_block=U.splice(W,Q);V=V-Q;R=V;P=P-Q;Array.prototype.splice.apply(U,[P+1,0].concat(added_block))}else{alert("Warning: this should not happen (E101)");return U}}else{if(U[R]==N){if(R==V-1){for(start_other_del=R-1;start_other_del>=0;start_other_del--){if(U[start_other_del]==v){break}}if(start_other_del>=0){U.splice(R,2);V=start_other_del;R=V;P=P-2}}else{break}}else{break}}}}}}}for(var S=0;S<U.length-1;S++){if(((U[S]==N)&&(U[S+1]==v))||((U[S]==l)&&(U[S+1]==O))){U.splice(S,2)}}return U};f.remove_deleted=function(R){var Q=0;var S=[];for(var P=0;P<R.length;P++){if(R[P]==v){Q=1}else{if(R[P]==N){Q=0}else{if(Q==0){S.push(R[P])}}}}return S};f.remove_short_unchanged=function(R){var S=[];for(var Q=0;Q<R.length;Q++){if(R[Q]==O){for(var P=S.length-1;P>=0;P--){if(!f.is_short_word(S[P])||S[P]==l){break}}if(P<0){S.unshift(O);continue}else{if(S[P]==l){S.splice(P,1);continue}}}S.push(R[Q])}for(var P=S.length-1;P>=0;P--){if(!f.is_short_word(S[P])||S[P]==l){break}}if((P>=0)&&(S[P]==l)){S.splice(P,1);S.push(l)}return S};f.remove_tags=function(P){P=(P.split(O)).join("");P=(P.split(l)).join("");P=(P.split(v)).join("");P=(P.split(N)).join("");return P};f.get_color_string=function(Q){var P=["yellow","cyan","lime","orange","lightskyblue","lightgreen","coral","gold","violet","silver","pink","lightsalmon","tomato"];max_color=12;if(Q==0){the_color=0}else{the_color=1+((Q-1)%max_color)}return'<span style="BACKGROUND-COLOR: '+P[the_color]+'">'};f.get_color_string_end=function(){return"</span>"};f.get_color_string_and_update_legend_for_claim=function(Q,P){var R=new RegExp('BACKGROUND-COLOR: (\\w+)">'+Q+f.get_color_string_end());for(leg=1;leg<P.length;leg++){if(R.exec(P[leg])!=null){break}}if(leg==P.length){P.push(" "+f.get_color_string(leg)+Q+f.get_color_string_end())}return f.get_color_string(leg)};f.make_single_added=function(Q){var P;var R=[];for(P=0;P<Q.length;P++){if((Q[P]!=O)&&(Q[P]!=l)){R.push(Q[P])}}if(R.length>0){R.unshift(O);R.push(l)}while(Q.length>0){Q.pop()}while(R.length>0){Q.push(R.shift())}return};f.format_claim_span=function(T,X){var P="";var W=-1;var Y=-1;var U=[];var V=[];var Q=false;for(var S=1;S<=X;S++){if(typeof T[S]!="undefined"){U.push(S)}else{Q=true}}if(U.length==0){return"None"}for(var R=0;R<U.length;R++){if((U[R]-Y==1)){Y=U[R]}else{if(W>0){if((Y-W)>=2){P=P+W+"-"+Y+","}else{if((Y-W)==1){P=P+W+","+Y+","}else{P=P+W+","}}}W=U[R];Y=U[R]}}if((Y-W)>=2){P=P+W+"-"+Y}else{if((Y-W)==1){P=P+W+","+Y}else{P=P+W}}if(Q){P=P+" (Warning: irregularly numbered set, please check input)"}return P};f.split_into_added_unchanged_added=function(X,T,ad,ab){var Z,Y;var U,Q;var aa,S,ac;var P,W,R;var V;ac=0;aa=0;S=0;R=0;P=0;W=0;Q=0;U=0;for(Z=0;Z<X.length;Z++){if(X[Z]==O){V=true;U=Z;Q=0}else{if(X[Z]==l){if(Q>F){W=U-1;if(R>ac){aa=P;S=W;ac=R}P=Z+1;W=Z+1;R=0}else{W=Z}V=false}else{if(V){Q=Q+X[Z].length}else{R=R+X[Z].length;W=Z}}}}if(R>ac){aa=P;S=W;ac=R}for(Z=0;Z<aa;Z++){T.push(X[Z])}for(Z=aa;Z<=S;Z++){ad.push(X[Z])}for(Z=S+1;Z<X.length;Z++){ab.push(X[Z])}f.make_single_added(T);f.make_single_added(ab);return};f.recode_added_parts=function(V,X,P,Q){var Y,W,Z,ad,ah;var S,aa;var ag,ab;var R;Y=W=Z=ad=S=aa=[];ab=0;h++;if(j==true){R="|"}else{R=""}for(ag=0;ag<P.length;ag++){if(P[ag]==O){ab=1;W=[];if(h==1){ad.push(P[ag])}continue}else{if(P[ag]==l){ab=2;coded_yet=0;if(f.count_added([O].concat(W,l))>F){max_score=0;ah=0;var ae,U;for(var ac=1;ac<=X;ac++){if(typeof V[ac]=="undefined"){continue}ae=f.fdiff3(V[ac],W.join(""));ae=f.remove_deleted(ae);if((diff_score=f.count_unchanged(ae))>max_score){ah=ac;max_score=diff_score}}if(max_score>F){var T,ai,af;ae=f.fdiff3(V[ah],W.join(""));ae=f.remove_deleted(ae);T=[];ai=[];af=[];f.split_into_added_unchanged_added(ae,T,ai,af);S=f.recode_added_parts(V,X,T,Q);ad=ad.concat(S);ad.push("<SPAN>"+R);if(j){ad.push(f.get_color_string_and_update_legend_for_claim(ah,Q))}else{ad.push(f.get_color_string(Q.length));Q.push(" "+f.get_color_string(Q.length)+ah+f.get_color_string_end())}mode2=0;for(d2=0;d2<ai.length;d2++){if(ai[d2]==v){mode2=1;alert("This should not happen. Code 1.")}else{if(ai[d2]==N){mode2=0;alert("This should not happen. Code 2.")}else{if(ai[d2]==O){ad.push(f.get_color_string(0))}else{if(ai[d2]==l){ad.push(f.get_color_string_end())}else{if(mode2==0){ad.push(ai[d2])}}}}}}ad.push(f.get_color_string_end());U=f.fdiff3(V[ah],f.remove_tags(ai.join("")));ad.push(R+'</SPAN><SPAN class="tooltip">'+U.join("")+"</SPAN>");aa=f.recode_added_parts(V,X,af,Q);ad=ad.concat(aa);coded_yet=1}}if(!coded_yet){ad.push(f.get_color_string(0));ad=ad.concat(W);ad.push(f.get_color_string_end())}if(h==1){ad.push(l)}}}if(ab==0){ad.push(P[ag])}else{if(ab==1){W.push(P[ag])}else{if(ab==2){ab=0}}}}h--;return ad};f.get_main_base_claim=function(Q){for(var R=0;R<n.length;R++){if(n[R]==Q){var P=/^(\d+)/;var S;if((S=P.exec(t[R]))!=null){var T=parseInt(S[1]);if(T<0){alert('Base value "'+base+'"out of bounds');return -1}else{return T}}}}return -1};f.get_claim_base_exclusions=function(ac,ah,V,U){var X=0;var S;var Q=false;if(U==false){V=0;S=t}else{S=t.slice(0)}for(var W=0;W<n.length;W++){if(n[W]==ac){if((S[W].search("!")>=0)&&(S[W].search("&")>=0)){alert("Error in base override for claim "+ac+"\nCan't both include (&) and exclude (!) claims");return[]}var ab=/(.*)\[(\d+)\](.*)/;var R;while((R=ab.exec(S[W]))!=null){if((Math.round(R[2])<=V)&&(Math.round(R[2])!=0)){S[W]=R[1]+(ah+parseInt(R[2]))+R[3];Q=true}else{if(U==true){alert("Error in base override for claim "+ac+"\nInvalid paragraph number ["+R[2]+"] encountered.")}else{if(S[W].search("&")>=0){alert("Error in base override for claim "+ac+":\nuse of description not selected.")}}S[W]=R[1]+R[3]}}var ad=S[W].split(/[0-9!&\-\,]+/);if((ad=ad.join(""))!==""){alert("Error in base override for claim "+ac+"\nInvalid character(s) "+ad+' encountered.\n\nValid examples: "5!8,9,12-15,38-40" or "&8,9,12-15,38-40"');return[]}var af=S[W];var P=/(.*?)(\d+)\-(\d+)(.*)/;var R,T,aa;while((R=P.exec(af))!=null){T=parseInt(R[2]);aa=parseInt(R[3]);if(T>=aa){alert("Invalid base override range ("+R[2]+"-"+R[3]+") for claim "+ac+".");return[]}af=""+R[1]+R[2];for(var ag=T+1;ag<=aa;ag++){af=af+","+ag}af=af+R[4]}af=af.split(/[!&,]/);af.shift();if(S[W].search("!")>=0){return af}else{if(S[W].search("&")>=0){if((Q==false)&&(U==true)){V=0}var ae=[];for(var Z=1;Z<=ah+V;Z++){for(var Y=0;Y<af.length;Y++){if(af[Y]==Z){break}}if(Y==af.length){ae.push(Z)}}return ae}}break}}return[]};f.get_base_text_for_claim=function(P){for(var Q=0;Q<n.length;Q++){if(n[Q]==P){return t[Q]}}return""};f.insert_in_score_list=function(Q,P,R){Q.push(P);Q.push(R);for(var S=(Q.length/2)-2;S>=0;S--){if(R<=Q[S*2+1]){break}Q[(S+1)*2]=Q[S*2];Q[(S+1)*2+1]=Q[S*2+1];Q[S*2]=P;Q[S*2+1]=R}return};f.show_dependency_table=function(R,U){var Q="<B>Claim dependency table:</B><BR>";var P;for(var S=1;S<=U;S++){if(typeof(R[S])=="undefined"){continue}P="    "+S+": ";Q=Q+P.substr(-5);for(var T=1;T<=S;T++){if(S==T){Q=Q+"x "}else{if(typeof(R[S][T])=="undefined"){Q=Q+"- "}else{Q=Q+R[S][T]+" "}}}Q=Q+"<BR>"}return Q};f.format_claim_tree_recursive=function(Y,U,X,R,Q,V){if(typeof(Y[U])=="undefined"){return Q}if(Q.indexOf("-"+U+"-")>=0){return Q}var W="";if(typeof(V)!="undefined"){if(typeof(V[U])!="undefined"){W="<SUP>("+V[U]+")</SUP>"}}for(var S=1;S<R;S++){Q=Q+"| "}if(R>0){Q=Q+"+ "}else{if(R==0){Q=Q+"<BR>"}}if(R==0){Q=Q+"<BR>-<B>"+U+"</B>-"+W+"<BR>"}else{Q=Q+"-"+U+"-"+W+"<BR>"}for(var T=U+1;T<=X;T++){if(Q.indexOf("-"+T+"-")>=0){continue}else{if(typeof(Y[T])=="undefined"){continue}else{if(Y[T][U]==1){for(var P=U-1;P>0;P--){if(Y[T][P]==1){break}}if(P==0){if(typeof(V)!="undefined"){if(typeof(V[T])!="undefined"){if(typeof(V[U])!="undefined"){V[T]=V[T]+";"+V[U]}}}Q=f.format_claim_tree_recursive(Y,T,X,R+1,Q,V)}}}}}return Q};f.format_claim_tree=function(P,ag,U){var V="";for(var Z=1;Z<=ag;Z++){V=f.format_claim_tree_recursive(P,Z,ag,0,V,U)}var Y=V.split("<BR>");while((Y.length>0)&&(Y[0]=="")){Y.shift()}for(var Z=1;Z<Y.length;Z++){Y[Z]=Y[Z].split(" ")}for(var aa=0;aa<ag;aa++){last="";for(var Z=Y.length-1;Z>=1;Z--){if(typeof(Y[Z][aa])=="undefined"){last="";continue}else{if(Y[Z][aa]=="|"){if(last==""){Y[Z][aa]=" "}}else{if(Y[Z][aa]=="+"){last="+"}else{last=""}}}}}for(var Z=1;Z<Y.length;Z++){Y[Z]=Y[Z].join(" ")}V=Y.join("<BR>");V=V.split("-");V=V.join("");V=V.split("+ ");V=V.join("+-");var ad=/(.*)<SUP>\((.*?)\)<\/SUP>(.*)/;var X=/(.*?)\;(.*)/;var W=/(\d+)/;var S,af;while((S=ad.exec(V))!=null){if((af=X.exec(S[2]))!=null){base_and_support=af[1].split(",")}else{base_and_support=S[2].split(",")}base_and_support[0]="<b><u>"+base_and_support[0]+"</u></b>";for(var ab=1;ab<base_and_support.length;ab++){base_and_support[ab]="<b>"+base_and_support[ab]+"</b>"}if(af!=null){S[2]=base_and_support.join(",")+","+af[2]}else{S[2]=base_and_support.join(",")}S[2]=S[2].split(";");S[2]=S[2].join(",");var Q=[];var T=[];var ae;var R=S[2].split(",");for(var ac=0;ac<R.length;ac++){if((ae=W.exec(R[ac]))!=null){value=Math.round(ae[1]);for(var ab=0;ab<Q.length;ab++){if(Q[ab]>=value){break}}if((ab==Q.length)||(Q[ab]!=value)){Q.splice(ab,0,value);T.splice(ab,0,R[ac])}}}S[2]=T.join(",");V=S[1]+"<sup>("+S[2]+")</sup>"+S[3]}return V};f.remove_claim_tree_deps=function(P){var Q=/(.*)\((.*?)\)(.*)/;var S;while((S=Q.exec(P))!=null){var T=[];legend=S[2].split(/,/);for(var R=0;R<legend.length;R++){if(legend[R].indexOf("<b>")>=0){T.push(legend[R])}}P=S[1]+"{"+T.join(",")+"}"+S[3]}P=P.split(/\{/);P=P.join("(");P=P.split(/\}/);P=P.join(")");return P};f.remove_claim_tree_deps_and_support=function(P){var Q=/(.*)<sup>\((.*?)\)<\/sup>(.*)/;var R;while((R=Q.exec(P))!=null){P=R[1]+R[3]}return P};f.do_claim_tree_analysis=function(Y,Q,af,V){var ac=/(\w+)(\s+)([C,c]laim)([s]*)(and|or|\s|\,|\-|\d)+(\w+)/;var Z=" to - zu bis à ";var aa=" or , and oder ou ";var U;var ad=[];var ae=[];var P="";var X=0;var ab;ae=new Array(Q+1);for(var T=1;T<=Q;T++){if(typeof(Y[T])=="undefined"){continue}ab=false;ae[T]=new Array(T);for(var S=0;S<T;S++){ae[T][S]=0}words=f.split_punctuation(Y[T]);for(w1=2;w1<words.length;w1++){var W=words[w1].toLowerCase();if(((W.indexOf("claim")>=0)&&(W.indexOf("claimed")<0))||(W.indexOf("anspruch")>=0)||(W.indexOf("ansprüche")>=0)||(W.indexOf("revendication")>=0)){w1++;break}}var R=false;X=-1;for(;w1<words.length;w1++){if(words[w1].charAt(0)==" "){continue}the_number=parseInt(words[w1],10);if(the_number>0){if(the_number==T){alert(af+T+" refers back to itself")}else{if(the_number>T){alert(af+T+" refers back to a higher claim")}else{ae[T][the_number]=1;if(R==false){X=the_number}else{to_number=the_number;if(to_number<=X){alert(af+T+" has a malformed dependency range ("+X+" to "+to_number+")")}else{for(d1=X+1;d1<=to_number;d1++){ae[T][d1]=1}}R=false}}}ab=true}else{if((X>0)&&(Z.indexOf(words[w1])>=0)){R=true}else{if(aa.indexOf(words[w1])<0){break}}}}if(ab==false){lower_claim=Y[T].toLowerCase();lower_claim=lower_claim.replace(/\s+/g," ");lower_claim=lower_claim.replace(/voranstehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorangehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorhergehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgenannt/g,"vorstehend");lower_claim=lower_claim.replace(/vorangegangen/g,"vorstehend");lower_claim=lower_claim.replace(/vorherig/g,"vorstehend");lower_claim=lower_claim.replace(/bisherig/g,"vorstehend");if((lower_claim.indexOf("preceding claims")>=0)||(lower_claim.indexOf("previous claims")>=0)||(lower_claim.indexOf("above claims")>=0)||(lower_claim.indexOf("foregoing claims")>=0)||(lower_claim.indexOf("revendications pr")>=0)||(lower_claim.indexOf("den vorstehenden anspr")>=0)){for(d1=1;d1<T;d1++){ae[T][d1]=1}}else{if((lower_claim.indexOf("the preceding claim")>=0)||(lower_claim.indexOf("the previous claim")>=0)||(lower_claim.indexOf("the above claim")>=0)||(lower_claim.indexOf("the foregoing claim")>=0)||(lower_claim.indexOf("la revendication pr")>=0)||(lower_claim.indexOf("dem vorstehenden anspr")>=0)){ae[T][T-1]=1}else{if((lower_claim.indexOf("preceding claim")>=0)||(lower_claim.indexOf("previous claim")>=0)||(lower_claim.indexOf("above claim")>=0)||(lower_claim.indexOf("foregoing claim")>=0)||(lower_claim.indexOf("revendication pr")>=0)||(lower_claim.indexOf("vorstehenden anspr")>=0)){for(d1=1;d1<T;d1++){ae[T][d1]=1}}else{if((lower_claim.indexOf("claim")>=0)||(lower_claim.indexOf("revendication")>=0)||(lower_claim.indexOf("anspr")>=0)){if(lower_claim.indexOf("claim sets")<0){alert(af+T+"'s dependency not understood, treating as independent.")}}}}}}}P="<PRE>"+f.format_claim_tree(ae,Q,V)+"</PRE>";return P};f.insert_line_breaks=function(Q,V){if((K==false)&&(E==false)){Q=Q.split(/\t/);Q=Q.join("<BR>\n");return Q}if(K==true){Q=Q.split("&#59;");Q=Q.join("&#59;<BR>");Q=Q.split("&#58;");Q=Q.join("&#58;<BR>")}if(E==true){Q=Q.split(",");Q=Q.join(",<BR>")}var U;var W="OPEN_BRACKET_FOO_FOO_FOO";var R="CLOSE_BRACKET_FOO_FOO_FOO";var T=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((U=T.exec(Q))!=null){var P=U[2].split("<BR>");P=P.join("");Q=U[1]+W+P+R+U[3]}Q=Q.split(W);Q=Q.join("(");Q=Q.split(R);Q=Q.join(")");Q=Q.split("<BR> <BR>");Q=Q.join("<BR>");Q=Q.split("<BR><BR>");Q=Q.join("<BR>");Q=Q.split("<BR><BR>");Q=Q.join("<BR>");Q=Q.split(" <BR>");Q=Q.join("<BR>");Q=Q.split("<BR>");Q=Q.join("<BR>&nbsp;&nbsp;&nbsp;");if(V){Q=Q.replace(/\d+\./g,function S(X){return"<BR><BR>"+X})}return Q};f.post_cleanup=function(R,U){if(z==true){deleted_parts=R.split(v);if(deleted_parts.length>0){var T,Q,P;Q=new RegExp(v+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+N+O+f.get_color_string(0)+"([A-Za-zÀ-ÿ]+)"+f.get_color_string_end()+l+"([\\S\\s]*)");P=new RegExp(v+"([A-Za-zÀ-ÿ]+)"+N+O+f.get_color_string(0)+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+f.get_color_string_end()+l+"([\\S\\s]*)");R=deleted_parts[0];for(var S=1;S<deleted_parts.length;S++){deleted_parts[S]=v+deleted_parts[S];if((T=Q.exec(deleted_parts[S]))!=null){if(T[4]===(T[1]+T[3])){deleted_parts[S]=T[1]+T[2]+T[3]+T[5]}}if((T=P.exec(deleted_parts[S]))!=null){if(T[1]===(T[2]+T[4])){deleted_parts[S]=T[2]+T[3]+T[4]+T[5]}}R=R+deleted_parts[S]}}}if(U==false){if(s==true){highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+v}else{highlight_and_rem_start='<span style="BACKGROUND-COLOR: LightGrey">'+v}highlight_and_rem_end=N+f.get_color_string_end();R=(R.split(v)).join(highlight_and_rem_start);R=(R.split(N)).join(highlight_and_rem_end)}if((U==true)&&(q==true)){highlight_and_add_start=f.get_color_string(0)+O;highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+v;highlight_and_add_end=l+f.get_color_string_end();highlight_and_rem_end=N+f.get_color_string_end();R=(R.split(O)).join(highlight_and_add_start);R=(R.split(v)).join(highlight_and_rem_start);R=(R.split(l)).join(highlight_and_add_end);R=(R.split(N)).join(highlight_and_rem_end)}R=f.insert_line_breaks(R,U);return R};f.split_and_diff=function(aB,aA,ay){var ar,ap,V;var ai,ah,Y;var az,W;var ac;var aj;var Q;var ak,X;var ae="";var aw,au,at;var aa;var ax=aB;var av=aA;var af="text";var ag=[];if(ay=="DESCMAGICFOO"){af="para";ar=f.split_desc(aB);ap=f.split_desc(aA);ai=ar.shift();ah=ap.shift();if(ai<1){return"No original description paragraph(s) detected -- doing whole text comparison <HR>\n"+f.diff(ax,av)}ay=""}else{af="claim";aB=f.ocr_cleanup(aB);aA=f.ocr_cleanup(aA);ar=f.split_claims(aB);ap=f.split_claims(aA);ai=ar.shift();ah=ap.shift();if(ai<1){return"No original claim number(s) detected -- doing whole text comparison <HR>\n"+f.diff(ax,av)}if(u.length>0){az=f.split_desc(ay);W=az.shift()}else{az=[];W=0}}ae=ae+"<TABLE class='fdiff4' BORDER=1><TR class='fdiff4'><TH class='fdiff4'>New<BR>"+af+"</TH><TH class='fdiff4'>Old<BR>"+af+"</TH><TH class='fdiff4 noprint'>Base<BR>override</TH>";if(af=="claim"){ae=ae+"<TH class='fdiff4 noprint'>Use<BR>desc</TH>"}ae=ae+"<TH class='fdiff4'><DIV contenteditable>"+w+"</DIV></TH></TR>\n";if((typeof ap[0]!="undefined")&&(ap[0]!="")){ae=ae+"<TR class='fdiff4'><TD class='fdiff4'></TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD>";if(af=="claim"){ae=ae+"<TD class='fdiff noprint'>&nbsp;</TD>"}ae=ae+"<TD class='fdiff4'>"+ap[0]+"</TD></TR>\n"}for(c2=1;c2<=ah;c2++){first_absent=c2;while((c2<ah)&&((typeof ap[c2]=="undefined")||(ap[c2]==""))){c2++}if(c2>first_absent){ae=ae+"<TR class='fdiff4'><TD class='fdiff4'>"+first_absent;if(c2>(first_absent+1)){ae=ae+"-"+(c2-1)}ae=ae+"</TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD><TD class='fdiff4'></TD></TR>\n"}aa=F;score_list=[];best_claim=-1;ak=false;if((best_claim=f.get_main_base_claim(c2))>=0){if((best_claim>0)&&(typeof ar[best_claim]=="undefined")){alert("Base "+af+" "+best_claim+" for "+af+" "+c2+" not found in original "+af+"s!");best_claim=-1}else{ak=true}}X=false;for(var Q=0;Q<u.length;Q++){if(u[Q]==c2){X=true;break}}if(X==false){for(var an=0;an<n.length;an++){if(n[an]==c2){if(t[an].search("[\d+]")>=0){X=true;if(W==0&&ay!=""){az=f.split_desc(ay);W=az.shift()}}}}}if(best_claim<0){for(var U=1;U<=ai;U++){if(typeof ar[U]=="undefined"){continue}ac=f.fdiff3(ar[U],ap[c2]);diff_score=f.count_unchanged(ac);if(diff_score>aa){best_claim=U;aa=diff_score}f.insert_in_score_list(score_list,U,diff_score)}}V=ar.slice();var T=f.get_claim_base_exclusions(c2,ai,W,X);Y=ai;if((W>0)&&(X==true)){for(var Q=1;Q<=W;Q++){V[ai+Q]=az[Q]}Y=ai+W}for(var R=0;R<T.length;R++){U=T[R];if((U>0)&&(U<=Y)){V[U]=undefined;ak=true}else{if(U==0){for(U=0;U<=Y;U++){V[U]=undefined}ak=true}}}if(best_claim>0){aj=[best_claim];ac=f.fdiff3(ar[best_claim],ap[c2]);ac=f.collect_deleted_parts(ac)}else{aj=["N/A"];ac=f.fdiff3("",ap[c2]);ac=f.collect_deleted_parts(ac)}ac=f.recode_added_parts(V,Y,ac,aj);ae=ae+"<TR class='fdiff4'><TD class='fdiff4'>"+c2+"</TD><TD class='fdiff4'>";if(best_claim>0){ae=ae+"<SPAN>"+aj[0]+'</SPAN><SPAN class="tooltip">'+ar[best_claim]+"</SPAN>"}else{ae=ae+aj[0]}claim_tree_legend=""+aj[0];for(Q=1;Q<aj.length;Q++){var ad=/([\S\s]+>)(\d+)(<[\s\S]+)/;var P,ab;var Z=aj[Q];if((P=ad.exec(aj[Q]))!=null){ab=parseInt(P[2]);if(ab>ai){desc_para=ab-ai;Z="<SPAN>"+P[1]+"["+desc_para+"]"+P[3]+'</SPAN><SPAN class="tooltip">'+V[ab]+"</SPAN>";claim_tree_legend_text=",["+desc_para+"]"}else{Z="<SPAN>"+aj[Q]+'</SPAN><SPAN class="tooltip">'+ar[ab]+"</SPAN>";claim_tree_legend_text=","+ab}if((ab!=aj[0])&&(claim_tree_legend.indexOf(claim_tree_legend_text)<0)){claim_tree_legend=claim_tree_legend+claim_tree_legend_text}}ae=ae+Z}ag[c2]=claim_tree_legend;ae=ae+"</TD><TD class='fdiff4 noprint' align='center'>";if(ak==true){ae=ae+'<INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'" value="'+f.get_base_text_for_claim(c2)+'">'}else{ae=ae+' <INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'">'}loop_end=score_list.length/2;if(loop_end>3){loop_end=3}for(Q=1;Q<loop_end;Q++){ae=ae+'<BR><span style="font-size:smaller">'+score_list[Q*2]+"="+Math.round((score_list[Q*2+1]*100)/score_list[1])+"% </span>"}if(af=="claim"){ae=ae+"</TD><TD class='fdiff4 noprint' align='center'>";if(X==true){ae=ae+'<INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'" checked>'}else{ae=ae+' <INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'">'}}ae=ae+"</TD><TD class='fdiff4'><DIV contenteditable>";var S="";for(Q=0;Q<ac.length;Q++){S=S+ac[Q]}ae=ae+f.post_cleanup(S,0)+"</DIV></TD></TR>\n"}ae=ae+"</TABLE>\n";aw=f.format_claim_span(ar,ai);au=f.format_claim_span(ap,ah);ae=ae+"<p>Original "+af+"s detected: "+aw+"<br>Amended "+af+"s detected: "+au;if((C==true)&&((aw.search("Warn")>-1)||(au.search("Warn")>-1))){alert("At least one of the detected "+af+" sets has irregular numbering.\nPlease verify that all "+af+" are properly identified and edit the text if necessary.\n\nYou can turn this message off by de-selecting the option below.")}if(af=="claim"){if(u.length>0){at=f.format_claim_span(az,W);ae=ae+"<br>Original description paragraphs detected: "+at}else{ae=ae+"<br>(Description not analyzed)"}if(o==true){var aq=f.do_claim_tree_analysis(ar,ai,"Original claim ");var ao=f.do_claim_tree_analysis(ap,ah,"Amended claim ",ag);var am=f.remove_claim_tree_deps(ao);var al=f.remove_claim_tree_deps_and_support(ao);ae=ae+"<BR><TABLE class='fdiff4' cellpadding='10' border=1><TR class='fdiff4'><TH class='fdiff4' colspan='4'>Claim trees</TH></TR><TR class='fdiff4'><TH class='fdiff4'> Original </TH><TH class='fdiff4'> Amended </TH><TH class='fdiff4'> Amended (+supt)</TH><TH class='fdiff4'> Amended (+supt +deps)</TH></TR><TR class='fdiff4'><TD valign='top'>";ae+=aq;ae+="</TD><TD valign='top'>";ae+=al;ae+="</TD><TD valign='top'>";ae+=am;ae+="</TD><TD valign='top'>";ae+=ao;ae+="<BR><BR>&nbsp;&nbsp;<U>Legend:</U><BR>&nbsp;&nbsp;<SUP>(<B><U>2</U></B>)</SUP> base claim<BR>&nbsp;&nbsp;<SUP>(<B>3</B>)</SUP> support claim<BR>&nbsp;&nbsp;<SUP>(4)</SUP> inherited from parent";ae=ae+"</TD></TR></TABLE>"}}return ae};f.diff=function(W,V){var U;var P;var R,Q;var T,S;W=f.ocr_cleanup(W);V=f.ocr_cleanup(V);U=f.fdiff3(W,V);output="";for(P=0;P<U.length;P++){output=output+U[P]}output=f.post_cleanup(output,1);return output};f.insert_new_lines=function(R){var S="fj1423lkfnsfdsghdh32342";var Q=new RegExp("^([\\s\\S]*\\.)[ \\t]+([\\s\\S]*)");var P=new RegExp("^([\\s\\S]*\\d+\\.)$");while((matches=Q.exec(R))!=null){if(P.test(matches[1])){R=matches[1]+S+matches[2]}else{R=matches[1]+"\n\n"+matches[2]}}R=R.split(S);R=R.join(" ");return R};f.set_basis_threshold=function(P){if((P>=5)&&(P<=50)){F=P;return"OK"}else{return"Value out of bounds"}};f.set_fdiff3_highlights=function(P){if(P=="checked"){q=true}else{q=false}return"OK"};f.set_fdiff4_strikeout_highlights=function(P){if(P=="checked"){s=true}else{s=false}return"OK"};f.set_fdiff4_warn_claims=function(P){if(P=="checked"){C=true}else{C=false}return"OK"};f.set_fdiff4_simplify_legend=function(P){if(P=="checked"){j=true}else{j=false}return"OK"};f.set_fdiff4_tree_analysis=function(P){if(P=="checked"){o=true}else{o=false}return"OK"};f.set_convert_claim_styles=function(P){if(P=="checked"){M=true}else{M=false}return"OK"};f.set_ignore_hyphenation=function(P){if(P=="checked"){G=true}else{G=false}return"OK"};f.set_eszett_normalization=function(P){if(P=="checked"){B=true}else{B=false}return"OK"};f.set_ignore_case=function(P){if(P=="checked"){a=true}else{a=false}return"OK"};f.set_ignore_spaces=function(P){if(P=="checked"){D=true}else{D=false}return"OK"};f.set_ignore_in_brackets=function(P){if(P=="checked"){g=true}else{g=false}return"OK"};f.set_fix_glued_words=function(P){if(P=="checked"){z=true}else{z=false}return"OK"};f.set_insert_line_breaks_indents=function(P){if(P=="checked"){K=true}else{K=false}return"OK"};f.set_insert_line_breaks_indents2=function(P){if(P=="checked"){E=true}else{E=false}return"OK"};f.clear_claim_base_overrides=function(){n=[];t=[];return"OK"};f.set_claim_base_override=function(P,R){var Q=parseInt(P);if(Q<1){alert('Claim value "'+P+'" out of bounds in claim base override!');return"Error"}R=R.split(/\s+/);R=R.join("");n.push(Q);t.push(R);return"OK"};f.clear_use_desc_overrides=function(){u=[];return"OK"};f.set_use_desc_override=function(P){var Q=parseInt(P);if(Q<1){alert('Claim value "'+P+'" out of bounds in use description override!');return"Error"}u.push(Q);return"OK"};f.get_version=function(){return m};f.set_title=function(P){w=P;return"OK"};f.regenerate_title=function(){if(I!=""){w="'"+p+"' vs. '"+x+"'"}else{w="Difference"}return"OK"};f.set_header_orig=function(P){x=P;f.regenerate_title();return"OK"};f.set_header_new=function(P){p=P;f.regenerate_title();return"OK"};f.set_dossier_number=function(P){I=P;f.regenerate_title();return"OK"};f.filter_table_contents=function(T){var Y=/([\s\S]*?)<span class="tooltip">([\s\S]*?)<\/span>([\s\S]*)/;var R=/([\s\S]*?)<\/span>([\s\S]*)/;var Q=/([\s\S]*?)<div contenteditable="">([\s\S]*?)<\/div>([\s\S]*)/;var P=/<table([\s\S]*)/;var S,W;T=(T.split(/ style="cursor: default;"/)).join("");T=(T.split(/ style="cursor: default; /)).join(' style="');var Z=T.split(/<\/table>/);if(Z.length<1){return T}var aa=Z[0].split(/<tr/);for(row=1;row<aa.length;row++){var V;if(row==1){V=aa[row].split(/<th/)}else{V=aa[row].split(/<td/)}if(V.length>=5){V[3]=V.pop();if(V.length==5){V.pop()}if(row==1){aa[row]=V.join("<th")}else{aa[row]=V.join("<td")}}while((S=Y.exec(aa[row]))!=null){var U=(S[2].match(/\<span/g)||[]).length;var X=(S[2].match(/\<\/span/g)||[]).length;while(U!=X){if((W=R.exec(S[3]))!=null){S[2]=S[2]+"</span>"+W[1];S[3]=W[2];U=(S[2].match(/\<span/g)||[]).length;X=(S[2].match(/\<\/span/g)||[]).length}else{U=X}}aa[row]=S[1]+S[3]}while((S=Q.exec(aa[row]))!=null){aa[row]=S[1]+S[2]+S[3]}}Z[0]=aa.join("<tr");T=Z.join("</table>");return T};f.filter_table_colours=function(Q){var P=/([\s\S]*)<span style=\"background([\s\S]*?)>([\s\S]*?)<\/span>([\s\S]*)/;var S;var R=Q.split(/<tr/);for(row=1;row<R.length;row++){while((S=P.exec(R[row]))!=null){R[row]=S[1]+S[3]+S[4]}}Q=R.join("<tr");return Q};return f}());