var fdiff=(function(){var g={};var t="4.94";var ab="<u>";var r="</u>";var D="<s>";var aa="</s>";var k="[[";var S="]]";var q="{{{";var b="}}}";var j=0;var l=0;var f=1;var d=2;var Y=3;var T=4;var K=5;var o=6;var x=7;var e=1;var V=7;var Q=15;var w=true;var A=true;var M=true;var n=true;var u=false;var W=false;var R=false;var L=false;var a=false;var N=false;var h=false;var Z=true;var H=true;var G=false;var X=false;var O=false;var s=[];var z=[];var B=[];var J=[];var E="Difference";var F="";var v="";var U="";var y="";g.one_time_alert=function(ac){if(y==""){alert(ac+"\n\nFurther pop-ups of this type are suppressed,\nsee bottom of claim comparison output.");y="<br><b>The following errors were encountered:</b><BR>"}y=y+ac+"<BR>"};g.one_time_alert_get_log=function(){var ac=y;y="";return ac};g.fix_unclosed_brackets=function(ai){var ae;var ah,ac;var ag="";var ad="",af="";ae=ai.toString().split("");for(ac=0;ac<ae.length;ac++){ah=ae[ac];if(ag!==""){ag=ag+ah;if(ah===")"){if(h==false){ad=ad+ag}ag=""}}else{if(ah==="("){ag=ah;if(af!==""){ad=ad+af;af=""}}else{af=af+ah}}}if(ag!==""){return ad+"{"+ag.substr(1)}return ad+af};g.handle_reference_signs=function(ae){if(h==true){var ad;var ac=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ad=ac.exec(ae))!=null){ae=ad[1]+ad[3]}}return g.fix_unclosed_brackets(ae)};g.LCSubStr2=function(am,aj,af,ad){var ae,ac,ao,an;var ai=new Array(-1,-1,-1,-1);var al=[];var ak=0;var ah,ag;for(ao=0;ao<af.length;ao++){ae=af[ao];al[ao]=[];for(an=0;an<ad.length;an++){ac=ad[an];if(am[ae]===aj[ac]){if((ao===0)||(an===0)){al[ao][an]=1}else{al[ao][an]=al[ao-1][an-1]+1}if(al[ao][an]>ak){ak=al[ao][an];ai[0]=af[ao-ak+1];ai[1]=af[ao];ai[2]=ad[an-ak+1];ai[3]=ad[an]}}else{al[ao][an]=0}}}return ai};g.recurse=function(au,at,ai,aF){var an,az,am,ay,ax,aw;var ah=[];var aC=[];var al=[];var aG=[];var ar=[];var ag=[];var aj;var ae,ad,ao,av;var aq,af,aA,ak;var aH,aE;var aB=/\s/;if(au.length<=0){if(at.length>=1){return[ab].concat(at,r)}else{return[""]}}else{if(at.length<=0){return[D].concat(au,aa)}}if(a){var aD=[],ac=[];for(var ap=0;ap<au.length;ap++){aD.push(au[ap].toUpperCase())}for(var ap=0;ap<at.length;ap++){ac.push(at[ap].toUpperCase())}aj=g.LCSubStr2(aD,ac,ai,aF)}else{aj=g.LCSubStr2(au,at,ai,aF)}ae=aj[0];ad=aj[1];ao=aj[2];av=aj[3];if(ae<0){aq=[];while((au.length>0)&&(at.length>0)&&(au[0]===at[0])){aq.push(au.shift());at.shift()}af=[];while((au.length>0)&&(at.length>0)&&(au[au.length-1]===at[at.length-1])){af.unshift(au.pop());at.pop()}if(au.length>0){aA=[D];aA=aA.concat(au);aA.push(aa)}else{aA=[]}if(at.length>0){ak=[ab];ak=ak.concat(at);ak.push(r)}else{ak=[]}return aq.concat(aA,ak,af)}if((ae===0)&&(ad===au.length-1)&&(ao===0)&&(av===at.length-1)){return at}an=au.splice(0,ae);az=at.splice(0,ao);ax=au.splice(0,ad-ae+1);aw=at.splice(0,av-ao+1);am=au;ay=at;for(aE=0;aE<ai.length;aE++){aH=ai[aE];if(aH>ad){aC.push(aH-ad-1)}if(aH<ae){ah.push(aH)}}for(aE=0;aE<aF.length;aE++){aH=aF[aE];if(aH>av){aG.push(aH-av-1)}if(aH<ao){al.push(aH)}}for(aH=0;aH<ax.length;aH++){if(!aB.test(ax[aH])){ar.push(aH)}}for(aH=0;aH<aw.length;aH++){if(!aB.test(aw[aH])){ag.push(aH)}}return(g.recurse(an,az,ah,al)).concat(g.recurse(ax,aw,ar,ag),g.recurse(am,ay,aC,aG))};g.find_keyword_indices=function(ag){var af=[];var ad;var ae;var ac=/[\s,;:?!"'\-&\/()]/;for(ad=0;ad<ag.length;ad++){ae=ag[ad];if(ae===""){continue}if(ac.test(ae)){continue}af.push(ad)}return af};g.split_punctuation=function(an){var am;var ak=[];var ah="";var ag,ac="",aj;var ao=/[\s,.;:?!"'\-\/]/;var ae=/[a-z,A-Z,\#,0-9]/;var ad=/(.*?)([+\-Â±\s]+)(\d+\.\d+)(\s+)(.*)/;var af=/\d+\.\d+/;var ai;am=[];if(af.test(an)){while((ai=ad.exec(an))!=null){am=am.concat(ai[1].toString().split(""));am=am.concat(ai[2].toString().split(""));am.push(ai[3]);am=am.concat(ai[4].toString().split(""));an=ai[5]}}if(an!==""){am=am.concat(an.toString().split(""))}for(aj=0;aj<am.length;aj++){ag=am[aj];if(ah!==""){ah=ah+ag;if(ag===")"){if(h==false){ak.push(ah)}else{if((ak.length>0)&&(ak[ak.length-1]===" ")){ak.pop()}}ah=""}}else{if(ag==="("){ah=ag;if(ac!==""){ak.push(ac);ac=""}}else{if(ao.test(ag)){if(ac!==""){ak.push(ac)}ak.push(ag);ac=""}else{if(ag==="&"){if(ac!==""){ak.push(ac)}ac="&";for(var al=aj+1;al<am.length;al++){if(ae.test(am[al])){ac=ac+am[al]}else{break}}if((al<am.length)&&(am[al]===";")&&(al>aj+1)){ak.push(ac+";");aj=al}else{ak.push("&")}ac=""}else{ac=ac+ag}}}}}if(ac!==""){ak.push(ac)}return ak};g.remove_deleted_tabs=function(ae){var ad=false;for(var ac=0;ac<ae.length;ac++){if(ae[ac]==D){ad=true}else{if(ad==true){if(ae[ac]==aa){ad=false}else{if(ae[ac]=="\t"){ae[ac]=" "}}}}}for(var ac=0;ac<ae.length-2;ac++){if((ae[ac]==D)&&(ae[ac+1]==" ")&&(ae[ac+2]==aa)){ae.splice(ac,3);ac=ac-1}}for(var ac=0;ac<ae.length-2;ac++){if((ae[ac]==ab)&&(ae[ac+2]==r)&&((ae[ac+1]==" ")||(ae[ac+1]=="\t"))){ae.splice(ac+2,1);ae.splice(ac,1)}}return ae};g.fdiff3=function(ai,ah){var ag,ae;var ad,ac;var af;ag=g.split_punctuation(ai);ae=g.split_punctuation(ah);ad=g.find_keyword_indices(ag);ac=g.find_keyword_indices(ae);af=g.recurse(ag,ae,ad,ac);return g.remove_deleted_tabs(af)};g.detect_language=function(ai){var ad=0,ac=0,af=0;var ah="X";var ag,ae;ac=1+(ai.split(/claim/i)).length-1+(ai.split(/characteri/i)).length-1+(ai.split(/according/i)).length-1;ad=1+(ai.split(/revendication/i)).length-1+(ai.split(/caract.ris/i)).length-1+(ai.split(/selon/i)).length-1;af=1+(ai.split(/anspr.ch/i)).length-1+(ai.split(/gekennzeich/i)).length-1+(ai.split(/nach/i)).length-1;if(ac>=af){ag=ac;ae=af}else{ag=af;ae=ac}if(ad>=ag){ae=ag;ag=ad}else{if(ad>=ae){ae=ad}}if((ag/ae)>=3){if(ag==ac){ah="E"}else{if(ag==af){ah="D"}else{ah="F"}}}return ah};g.correct_missing_spaces=function(ai){var ah;ah=g.detect_language(ai);ai=ai.split(/\:/);ai=ai.join(": ");ai=ai.split(/\;/);ai=ai.join("; ");ai=ai.split(/\,/);ai=ai.join(", ");if(ah=="E"){ai=ai.split(/ ofa /);ai=ai.join(" of a ");ai=ai.split(/ wherein/);ai=ai.join(" wherein ");ai=ai.split(/ wherein :/);ai=ai.join(" wherein:");ai=ai.split(/ said/);ai=ai.join(" said ");ai=ai.split(/ and\/or/);ai=ai.join(" ANDSLASHOR ");ai=ai.split(/ and\,/);ai=ai.join(" ANDCOMMA ");ai=ai.split(/ and/);ai=ai.join(" and ");ai=ai.split(/ ANDSLASHOR /);ai=ai.join(" and/or");ai=ai.split(/ ANDCOMMA /);ai=ai.join(" and, ");ai=ai.split(/inthat/);ai=ai.join("in that");ai=ai.split(/ that/);ai=ai.join(" that ");ai=ai.split(/ that :/);ai=ai.join(" that:");ai=ai.split(/orfurther/);ai=ai.join("or further");ai=ai.split(/orwhere/);ai=ai.join("or where");ai=ai.split(/orthat/);ai=ai.join("or that")}if(ah=="E"){var ad=/(claim)(\d)/i;var ac=/(claims)(\d)/i;var ag;if((ag=ad.exec(ai))!=null){var ae=/([\s\S]*)(claim)(\d+)([\s\S]*)/i;while((ag=ae.exec(ai))!=null){ai=ag[1]+ag[2]+" "+ag[3]+ag[4]}}if((ag=ac.exec(ai))!=null){var af=/([\s\S]*)(claims)(\d+)([\s\S]*)/i;while((ag=af.exec(ai))!=null){ai=ag[1]+ag[2]+" "+ag[3]+ag[4]}}}return ai};g.ocr_cleanup=function(ae){if(H==true){ae=g.correct_missing_spaces(ae)}ae=g.handle_reference_signs(ae);if(N==true){ae=ae.split(/\s+\)/);ae=ae.join(")");ae=ae.split(/\(\s+/);ae=ae.join("(");ae=ae.split(/\s+\]/);ae=ae.join("]");ae=ae.split(/\[\s+/);ae=ae.join("[");ae=ae.split(/\s+\,/);ae=ae.join(",");ae=ae.split(/\s+\;/);ae=ae.join(";");ae=ae.split(/\s+\:/);ae=ae.join(":");ae=ae.split(/\s+\./);ae=ae.join(".")}ae=ae.split("<RTI>");ae=ae.join("");ae=ae.split("<RTIgt;");ae=ae.join("");ae=ae.split("</RTI>");ae=ae.join("");ae=ae.replace(/\&/g,"AMPERSANDFOOBAR");ae=ae.replace(/\;/g,"&#59;");ae=ae.replace(/\:/g,"&#58;");ae=ae.replace(/AMPERSANDFOOBAR/g,"&amp;");ae=ae.replace(/\u2013|\u2014/g,"-");ae=ae.replace(/\u00ad/g,"");ae=ae.replace(/\u2018|\u2019|\u201A|\u0060/g,"'");ae=ae.replace(/\u201c|\u201d|\u201e/g,'"');ae=ae.split("<");ae=ae.join("&lt;");ae=ae.split(">");ae=ae.join("&gt;");if(L==true){ae=ae.replace(/\u00df/g,"ss")}ae=ae.split(/[ \t]+/);ae=ae.join(" ");ae=ae.split(/[\n\f\r]+/);ae=ae.join("\t");if(R==true){var ac=/(.*[a-zA-Z\u00e9\u00e8\u00f6\u00fc]+)\-\s*(\w+.*)/;var ad;while((ad=ac.exec(ae))!=null){ae=ad[1]+ad[2]}}return ae};g.ocr_cleanup_desc=function(af){var ac=h;var ad=R;var ae;h=false;R=false;ae=g.ocr_cleanup(af);h=ac;R=ad;return ae};g.form_claim_reg_exp=function(ae){var ad;var ac;ae=ae.toString();ad=ae.split("");re="";for(ac=0;ac<ad.length;ac++){if(ac>0){re=re+"\\s{0,1}"}if(ad[ac]==1){pat="[1,l,I,i]"}else{if(ad[ac]==2){pat="[2,Z,z]"}else{if(ad[ac]==5){pat="[5,S,s]"}else{if(ad[ac]==0){pat="[0,O,o]"}else{pat=ad[ac]}}}}re=re+pat}return re};g.handle_strict_patterns=function(af,ar,ak,ai,at,am){var ag;var ae;var ap=0;var ad=100000;var au=[];var ah;var ao;var al;var an=false;var aj=[];if(typeof(am)=="undefined"){am=""}ag=new RegExp("(.*\\.\\s*)("+ar+")(\\d+)("+ak+")(.*)$",am);while((ae=ag.exec(af))!=null){claim_no=parseInt(ae[3],10);if(typeof au[claim_no]!="undefined"){an=true;aj.push(claim_no)}au[claim_no]=ae[2]+ae[3]+ae[4]+ae[5];af=ae[1];if(ap<claim_no){ap=claim_no}if(ad>claim_no){ad=claim_no}}v2="";ag=new RegExp("^(.*?)("+ar+")(\\d+)("+ak+")(.*)$",am);while((ae=ag.exec(af))!=null){claim_no=parseInt(ae[3],10);af=ae[1];v2=ae[2]+ae[3]+ae[4]+ae[5]+v2;if((claim_no<ad)&&(claim_no>0)){au[claim_no]=v2;v2="";ad=claim_no}if(ap<claim_no){ap=claim_no}}if(an==true){var aq="Warning: the following claims/paragraphs have been found multiple times:\n";aq=aq+aj.pop();while(aj.length>0){aq=aq+", "+aj.pop()}alert(aq+".\nPlease check the text in the input window.")}au[0]=af;if(ap>1000){var ac=ap;ap=1000;while((ap>0)&&(typeof(au[ap])=="undefined")){ap--}alert("Something probably went wrong.\nHighest claim number detected: "+ac+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ap+".")}al=0;for(c=1;c<=ap+3;c++){if(typeof au[c]=="undefined"){ag=new RegExp(g.form_claim_reg_exp(c));if(ag.test(au[al])){ag=new RegExp(ai+g.form_claim_reg_exp(c)+at);if(ag.test(au[al])){if(al==0){ag=new RegExp("(.*?)("+ai+g.form_claim_reg_exp(c)+at+")(.*)",am)}else{ag=new RegExp("(.*?[\\.\\s]+)("+ai+g.form_claim_reg_exp(c)+at+")(.*)",am)}if((ae=ag.exec(au[al]))!=null){au[al]=ae[1];au[c]=ae[2]+ae[3];al=c;if(c>ap){ap=c}}}}}else{al=c}}au.unshift(ap);return au};g.handle_square_brackets_type_claims=function(ac){return g.handle_strict_patterns(ac,"\\[","\\]","\\[[0oO\\s]*","\\s{0,1}\\]")};g.handle_siemens_type_claims=function(ad){var ac=g.detect_language(ad);if(ac=="E"){return g.handle_strict_patterns(ad,"\\[claim\\s+","\\]","\\[claim\\s+","\\s{0,1}\\]","i")}else{if(ac=="D"){return g.handle_strict_patterns(ad,"\\[anspruch\\s+","\\]","\\[anspruch\\s+","\\s{0,1}\\]","i")}else{if(ac=="F"){return g.handle_strict_patterns(ad,"\\[revendication\\s+","\\]","\\[revendication\\s+","\\s{0,1}\\]","i")}else{return[0,ad]}}}};g.handle_claim_type_claims=function(ad){var ac=g.detect_language(ad);if(ac=="E"){return g.handle_strict_patterns(ad,"claim\\s+","\\.","claim\\s+","\\s{0,1}\\.","i")}else{if(ac=="D"){return g.handle_strict_patterns(ad,"anspruch\\s+","\\.","anspruch\\s+","\\s{0,1}\\.","i")}else{if(ac=="F"){return g.handle_strict_patterns(ad,"revendication\\s+","\\.","revendication\\s+","\\s{0,1}\\.","i")}else{return[0,ad]}}}};g.count_matches=function(af,ac){var ae;var ad=0;while((ae=ac.exec(af))!=null){ad=ad+1;af=ae[1]}return ad};g.detect_claim_numbering_style=function(ag){var av=/\.\s*\d+\.(.*)/;var ah=/^\d+\./;var au=/\[\d+\]\s+(.*)/;var ad=/\[\s*anspruch\s+\d+\s*\](.*)/i;var ac=/\[\s*revendication\s+\d+\s*\](.*)/i;var ax=/\[\s*claim\s+\d+\s*\](.*)/i;var ar=/\.\s*\d+\/(.*)/;var ai=/^\d+\//;var aq=/\.\s*\d+\s{0,1}\-(.*)/;var am=/^\d+\s{0,1}\-/;var ao=/\.\s*\d+\)(.*)/;var ae=/^\d+\)/;var ap=/\.\s*anspruch\s+\d+\.(.*)/i;var an=/\.\s*revendication\s+\d+\.(.*)/i;var al=/\.\s*claim\s+\d+\.(.*)/i;var aj=[0,0,0,0,0,0,0,0,0,0,0,0];var af;aj[f]=g.count_matches(ag,av);if((matches=ah.exec(ag))!=null){aj[f]=aj[f]+1}aj[d]=g.count_matches(ag,au);aj[Y]=g.count_matches(ag,ad)+g.count_matches(ag,ac)+g.count_matches(ag,ax);aj[x]=g.count_matches(ag,ap)+g.count_matches(ag,an)+g.count_matches(ag,al);aj[T]=g.count_matches(ag,ar);if((matches=ai.exec(ag))!=null){aj[T]=aj[T]+1}aj[K]=g.count_matches(ag,aq);if((matches=am.exec(ag))!=null){aj[K]=aj[K]+1}var aw=h;h=true;var ak=g.split_punctuation(ag);af=ak.join("");h=aw;aj[o]=g.count_matches(af,ao);if((matches=ae.exec(af))!=null){aj[o]=aj[o]+1}largest_score=aj[e];largest_score_style=e;second_largest_score=0;second_largest_score_style=l;for(var at=e+1;at<=V;at++){if(aj[at]>second_largest_score){if(aj[at]>largest_score){second_largest_score=largest_score;second_largest_score_style=largest_score_style;largest_score=aj[at];largest_score_style=at}else{second_largest_score=aj[at];second_largest_score_style=at}}}if((largest_score_style==d)&&(largest_score>=10)){claim_style=largest_score_style}else{if((second_largest_score!=0)&&(largest_score<2*second_largest_score)){claim_style=l}else{claim_style=largest_score_style}}return claim_style};g.split_claims=function(af,at){var ag;var ae;var ap=0;var ad=100000;var au=[];var ah;var am;var ak;var al=false;var aj=[];var ai=100000;if(Z==true){ah=g.detect_claim_numbering_style(af)}else{ah=l}var aq="\\.";var an="[.,]";var ao="\\s{0,1}\\.";if(ah==d){return g.handle_square_brackets_type_claims(af)}else{if(ah==Y){return g.handle_siemens_type_claims(af)}else{if(ah==x){return g.handle_claim_type_claims(af)}else{if(ah==T){aq="\\/";an=aq;ao="\\s{0,1}\\/"}else{if(ah==K){aq="\\s{0,1}\\-";an=aq;ao=aq}else{if(ah==o){aq="\\)";an=aq;ao="\\s{0,1}\\)"}}}}}}ag=new RegExp("(.*\\.\\s+)(\\d+)("+aq+")(.*)$");while((ae=ag.exec(af))!=null){claim_no=parseInt(ae[2],10);if(claim_no>1000){af=ae[1]+"["+ae[2]+"]"+ae[3]+ae[4];continue}if(typeof au[claim_no]!="undefined"){al=true;aj.push(claim_no)}if(claim_no>ai){g.one_time_alert("Warning: "+at+" claim "+claim_no+" was found before claim "+ai+".")}au[claim_no]=""+claim_no+ae[3]+ae[4];ai=claim_no;af=ae[1];if(ap<claim_no){ap=claim_no}if(ad>claim_no){ad=claim_no}}v2="";ag=new RegExp("^(.*?)(\\d+)("+aq+")(\\s+.*)$");while((ae=ag.exec(af))!=null){claim_no=parseInt(ae[2],10);af=ae[1];v2=""+claim_no+ae[3]+ae[4]+v2;if((claim_no<ad)&&(claim_no>0)){au[claim_no]=v2;v2="";ad=claim_no}if(ap<claim_no){ap=claim_no}}if(al==true){var ar="Warning: the following claims/paragraphs have been found multiple times:\n";ar=ar+aj.pop();while(aj.length>0){ar=ar+", "+aj.pop()}alert(ar+".\nPlease check the text in the input window.")}au[0]=af;if(typeof au[1]=="undefined"){if((c=au[0].indexOf("1 "))==0){au[1]=au[0];au[0]=""}else{if((c=au[0].indexOf(" 1 "))!==-1){au[1]=au[0].substring(c);au[0]=au[0].substring(0,c)}else{ag=new RegExp("^("+g.form_claim_reg_exp(1)+ao+")(.*)");if((ae=ag.exec(au[0]))!=null){au[0]="";au[1]=ae[1]+ae[2]}}}}if(ap>1000){var ac=ap;ap=1000;while((ap>0)&&(typeof(au[ap])=="undefined")){ap--}alert("Something probably went wrong.\nHighest claim number detected: "+ac+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ap+".")}ak=0;for(c=1;c<=ap+15;c++){if(typeof au[c]=="undefined"){if(au[ak].indexOf("."+c)!==-1){ag=new RegExp("(.*?\\.)("+c+aq+")(\\s+.*)");if((ae=ag.exec(au[ak]))!=null){au[ak]=ae[1];au[c]=ae[2]+ae[3];ak=c;if(c>ap){ap=c}}}}else{ak=c}}ak=0;for(c=1;c<=ap+3;c++){if(typeof au[c]=="undefined"){if(au[ak].indexOf(c)!==-1){ag=new RegExp("(.*?\\.\\s*)("+c+")(\\s+.*)");if((ae=ag.exec(au[ak]))!=null){if((ae[1].length>=2)&&((ae[1].charAt(ae[1].length-2)>="0")&&(ae[1].charAt(ae[1].length-2)<="9"))){}else{au[ak]=ae[1];au[c]=ae[2]+ae[3];ak=c;if(c>ap){ap=c}}}}}else{ak=c}}ak=0;for(c=1;c<=ap+3;c++){if(typeof au[c]=="undefined"){ag=new RegExp(g.form_claim_reg_exp(c));if(ag.test(au[ak])){ag=new RegExp("(.*?\\.\\s+)("+g.form_claim_reg_exp(c)+an+")(.*)");if((ae=ag.exec(au[ak]))!=null){au[ak]=ae[1];au[c]=ae[2]+ae[3];ak=c;if(c>ap){ap=c}}}}else{ak=c}}if(ah==f){ak=0;for(c=1;c<=ap+3;c++){if(typeof au[c]=="undefined"){ag=new RegExp(g.form_claim_reg_exp(c));if(ag.test(au[ak])){ag=new RegExp("(.*?\\s+)("+c+aq+"\\s{0,1})(\\D.*)");if((ae=ag.exec(au[ak]))!=null){au[ak]=ae[1];au[c]=ae[2]+ae[3];ak=c;if(c>ap){ap=c}}}}else{ak=c}}}ak=0;for(c=1;c<=ap+3;c++){if(typeof au[c]=="undefined"){ag=new RegExp(g.form_claim_reg_exp(c));if(ag.test(au[ak])){ag=new RegExp("(.*?\\s+)("+g.form_claim_reg_exp(c)+ao+")(.*)");if((ae=ag.exec(au[ak]))!=null){au[ak]=ae[1];au[c]=ae[2]+ae[3];ak=c;if(c>ap){ap=c}}}}else{ak=c}}for(c=1;c<=ap;c++){if(typeof au[c]!="undefined"){au[c]=g.fix_unclosed_brackets(au[c])}}au.unshift(ap);return au};g.handle_double_paragraphs=function(ai){var ak=/\[\d+\][^\S\t]+\[\d+\](.*)/;var ae=/(.*?)\t(\[\d+\])([ ]+)(\[\d+\])(.*)/;var ac=/(.*?)(\[\d+\])(.*)/;var af="";var ad="";if(ai==""){return ai}if(g.count_matches(ai,ak)>=1){while((matches=ae.exec(ai))!=null){var ah=matches[1];var aj=matches[2];var ag=matches[4];ai=matches[5];while((matches=ac.exec(ah))!=null){ah=matches[1]+matches[3];af=af+matches[2]}ad=ad+ah+"\t"+ag;af=af+aj}while((matches=ac.exec(ai))!=null){ai=matches[1]+matches[3];af=af+matches[2]}ad=ad+ai;return ad}return ai};g.split_desc=function(ag){if(ag==""){return[0,ag]}else{var ad;var ac=/\.\s*\[\d+\](.*)/;var af=g.ocr_cleanup_desc(ag);if(g.count_matches(af,ac)>=2){af=g.handle_double_paragraphs(af);ad=g.handle_square_brackets_type_claims(af)}else{ad=af.split(/[\t]+/);while((ad.length>0)&&(ad[ad.length-1]=="")){ad.pop()}ad.unshift("");ad.unshift(ad.length-1)}for(var ae=1;ae<ad.length;ae++){if(typeof ad[ae]!="undefined"){ad[ae]=g.fix_unclosed_brackets(ad[ae])}}return ad}};g.calculate_score_for_word=function(ac){if((ac=="claim")||(ac=="claims")||(ac=="according")||(ac=="characterised")||(ac=="characterized")||(ac=="Anspruch")||(ac=="AnsprÃ¼che")||(ac=="gekennzeichnet")||(ac=="revendication")||(ac=="revendications")||(ac=="caractÃ©risÃ©")||(ac=="caractÃ©risÃ©e")){return 0}else{return ac.length}};g.count_added=function(af){var ad=0;var ae=0;var ac;for(ac=0;ac<af.length;ac++){if(af[ac]==ab){ae=1}else{if(af[ac]==r){ae=0}else{if(af[ac]==D){ae=2}else{if(af[ac]==aa){ae=0}else{if(ae==1){ad=ad+g.calculate_score_for_word(af[ac])}}}}}}return ad};g.count_unchanged=function(af){var ae=0;var ad=0;var ac;for(ac=0;ac<af.length;ac++){if(af[ac]==ab){ad=1}else{if(af[ac]==r){ad=0}else{if(af[ac]==D){ad=2}else{if(af[ac]==aa){ad=0;ae=ae-1}else{if(ad==0){ae=ae+g.calculate_score_for_word(af[ac])}}}}}}if(ae>0){return ae}else{return 0}};g.is_short_word=function(ad){var ae=["the","a"," ","of","in","and","to","is","that","der","die","das","dem","des","den","im","und","le","la","dans","que","de"];for(var ac=0;ac<ae.length;ac++){if(ad==ae[ac]){return 1}}return 0};g.cross_out_deleted=function(ae){var ad=0;var af=[];for(var ac=0;ac<ae.length;ac++){if(ae[ac]==D){ad=1}else{if(ae[ac]==aa){ad=0}else{if(ae[ac]==ab){ad=2}else{if(ae[ac]==r){ad=0}else{if(ad==0){af.push(ae[ac])}else{if(ad==1){if(ae[ac]==" "){af.push(" ")}else{af.push(Array(1+ae[ac].length).join("-"))}}}}}}}}return af};g.alert_array=function(ac){var ad=ac.join("-");alert(ad)};g.reset_feature_blocks=function(){J=[]};g.add_feature=function(ac){J.push(ac);return J.length-1};g.find_feature_block_marker=function(af,ac){var ae=af.indexOf(k,ac);var ad=af.indexOf(S,ac);if((ae<0)&&(ad>=0)){return ad}if((ad<0)&&(ae>=0)){return ae}if(ae<ad){return ae}else{return ad}};g.find_feature_blocks=function(ag,ah){var ae=0;var ac=0,af=0,aj=0;while((ae=g.find_feature_block_marker(ah,ae))>=0){if(ah.substr(ae,2)==k){aj=aj+1}else{if(ah.substr(ae,2)==S){aj=aj-1}}if(aj>ac){ac=aj}if(aj<af){af=aj}ae=ae+2}if((ac>1)||(af<0)||(aj!=0)){alert("Unbalanced feature brackets [[ ... ]] found in claim "+ag+" -- ignoring all brackets");return ah}if((ac==0)&&(af==0)){return ah}var ad=/(.*)\[\[(.*?)\]\](.*)/;while((matches=ad.exec(ah))!=null){var ai=g.add_feature(matches[2]);ah=matches[1]+" "+q+ai+b+" "+matches[3]}ah=(ah.split("  ")).join(" ");return ah};g.replace_feature_markers=function(ag){var ac=/(.*)\{\{\{(\d+)\}\}\}(.*)/;var ae;var ad;var af=0;if(ac.exec(ag.join(""))==null){return ag}ad=[];for(loop=0;loop<ag.length;loop++){if(ag[loop]==ab){af=1}else{if(ag[loop]==r){af=0}}if((ae=ac.exec(ag[loop]))!=null){if(ae[1].length>0){ad.push(ae[1])}if(af==1){ad.push(r);ad.push(ab)}if(ae[2]<J.length){atoms=J[ae[2]].split(" ");for(i=0;i<atoms.length;i++){ad.push(atoms[i]);if(i!=atoms.length){ad.push(" ")}}}if(af==1){ad.push(r);ad.push(ab)}if(ae[3].length>0){ad.push(ae[3])}}else{ad.push(ag[loop])}}return ad};g.collect_deleted_parts=function(ah){var ag=0;var ai,ae,aj,ac=-1;var ak;for(ai=ah.length-1;ai>=0;ai--){if(ah[ai]==aa){ac=ai}else{if(ah[ai]==D){for(ae=ai-1;ae>=0;ae--){if(g.is_short_word(ah[ae])){continue}else{if(ah[ae]==r){for(aj=ae-1;aj>=0;aj--){if(ah[aj]==ab){break}}if((aj>=0)&&(ac>0)){if(ai-ae>1){short_words=ah.splice(ae+1,ai-ae-1);Array.prototype.splice.apply(ah,[ae,0].concat(short_words));ae=ae+short_words.length;Array.prototype.splice.apply(ah,[ai+1,0].concat(short_words));ac=ac+short_words.length}var ad=ae-aj+1;added_block=ah.splice(aj,ad);ai=ai-ad;ae=ai;ac=ac-ad;Array.prototype.splice.apply(ah,[ac+1,0].concat(added_block))}else{alert("Warning: this should not happen (E101)");return ah}}else{if(ah[ae]==aa){if(ae==ai-1){for(start_other_del=ae-1;start_other_del>=0;start_other_del--){if(ah[start_other_del]==D){break}}if(start_other_del>=0){ah.splice(ae,2);ai=start_other_del;ae=ai;ac=ac-2}}else{break}}else{break}}}}}}}for(var af=0;af<ah.length-1;af++){if(((ah[af]==aa)&&(ah[af+1]==D))||((ah[af]==r)&&(ah[af+1]==ab))){ah.splice(af,2)}}return ah};g.remove_deleted=function(ae){var ad=0;var af=[];for(var ac=0;ac<ae.length;ac++){if(ae[ac]==D){ad=1}else{if(ae[ac]==aa){ad=0}else{if(ad==0){af.push(ae[ac])}}}}return af};g.remove_short_unchanged=function(ae){var af=[];for(var ad=0;ad<ae.length;ad++){if(ae[ad]==ab){for(var ac=af.length-1;ac>=0;ac--){if(!g.is_short_word(af[ac])||af[ac]==r){break}}if(ac<0){af.unshift(ab);continue}else{if(af[ac]==r){af.splice(ac,1);continue}}}af.push(ae[ad])}for(var ac=af.length-1;ac>=0;ac--){if(!g.is_short_word(af[ac])||af[ac]==r){break}}if((ac>=0)&&(af[ac]==r)){af.splice(ac,1);af.push(r)}return af};g.remove_tags=function(ac){ac=(ac.split(ab)).join("");ac=(ac.split(r)).join("");ac=(ac.split(D)).join("");ac=(ac.split(aa)).join("");return ac};g.get_color_string=function(ad){var ac=["yellow","cyan","lime","orange","lightskyblue","lightgreen","coral","gold","violet","silver","pink","lightsalmon","tomato"];max_color=12;if(ad==0){the_color=0}else{the_color=1+((ad-1)%max_color)}return'<span style="background-color: '+ac[the_color]+'">'};g.get_color_string_end=function(){return"</span>"};g.get_color_string_and_update_legend_for_claim=function(ad,ac){var ae=new RegExp('background-color: (\\w+)">'+ad+g.get_color_string_end());for(leg=1;leg<ac.length;leg++){if(ae.exec(ac[leg])!=null){break}}if(leg==ac.length){ac.push(" "+g.get_color_string(leg)+ad+g.get_color_string_end())}return g.get_color_string(leg)};g.make_single_added=function(ad){var ac;var ae=[];for(ac=0;ac<ad.length;ac++){if((ad[ac]!=ab)&&(ad[ac]!=r)){ae.push(ad[ac])}}if(ae.length>0){ae.unshift(ab);ae.push(r)}while(ad.length>0){ad.pop()}while(ae.length>0){ad.push(ae.shift())}return};g.format_claim_span=function(ag,ak){var ac="";var aj=-1;var al=-1;var ah=[];var ai=[];var ad=false;for(var af=1;af<=ak;af++){if(typeof ag[af]!="undefined"){ah.push(af)}else{ad=true}}if(ah.length==0){return"None"}for(var ae=0;ae<ah.length;ae++){if((ah[ae]-al==1)){al=ah[ae]}else{if(aj>0){if((al-aj)>=2){ac=ac+aj+"-"+al+","}else{if((al-aj)==1){ac=ac+aj+","+al+","}else{ac=ac+aj+","}}}aj=ah[ae];al=ah[ae]}}if((al-aj)>=2){ac=ac+aj+"-"+al}else{if((al-aj)==1){ac=ac+aj+","+al}else{ac=ac+aj}}if(ad){ac=ac+" (Warning: irregularly numbered set, please check input)"}return ac};g.split_into_added_unchanged_added=function(ak,ag,aq,ao){var am,al;var ah,ad;var an,af,ap;var ac,aj,ae;var ai;ap=0;an=0;af=0;ae=0;ac=0;aj=0;ad=0;ah=0;for(am=0;am<ak.length;am++){if(ak[am]==ab){ai=true;ah=am;ad=0}else{if(ak[am]==r){if(ad>Q){aj=ah-1;if(ae>ap){an=ac;af=aj;ap=ae}ac=am+1;aj=am+1;ae=0}else{aj=am}ai=false}else{if(ai){ad=ad+ak[am].length}else{ae=ae+ak[am].length;aj=am}}}}if(ae>ap){an=ac;af=aj;ap=ae}for(am=0;am<an;am++){ag.push(ak[am])}for(am=an;am<=af;am++){aq.push(ak[am])}for(am=af+1;am<ak.length;am++){ao.push(ak[am])}g.make_single_added(ag);g.make_single_added(ao);return};g.recode_added_parts=function(ai,ak,ac,ad){var al,aj,am,aq,av;var af,an;var au,ao;var ae;al=aj=am=aq=af=an=[];ao=0;j++;if(n==false){ae="|"}else{ae=""}for(au=0;au<ac.length;au++){if(ac[au]==ab){ao=1;aj=[];if(j==1){aq.push(ac[au])}continue}else{if(ac[au]==r){ao=2;coded_yet=0;if(g.count_added([ab].concat(aj,r))>Q){max_score=0;av=0;var ar,ah;for(var ap=1;ap<=ak;ap++){if(typeof ai[ap]=="undefined"){continue}ar=g.fdiff3(ai[ap],aj.join(""));ar=g.remove_deleted(ar);if((diff_score=g.count_unchanged(ar))>max_score){av=ap;max_score=diff_score}}if(max_score>Q){var ag,aw,at;ar=g.fdiff3(ai[av],aj.join(""));ar=g.remove_deleted(ar);ag=[];aw=[];at=[];g.split_into_added_unchanged_added(ar,ag,aw,at);af=g.recode_added_parts(ai,ak,ag,ad);aq=aq.concat(af);aq.push("<SPAN>"+ae);if(n){aq.push(g.get_color_string_and_update_legend_for_claim(av,ad))}else{aq.push(g.get_color_string(ad.length));ad.push(" "+g.get_color_string(ad.length)+av+g.get_color_string_end())}mode2=0;for(d2=0;d2<aw.length;d2++){if(aw[d2]==D){mode2=1;alert("This should not happen. Code 1.")}else{if(aw[d2]==aa){mode2=0;alert("This should not happen. Code 2.")}else{if(aw[d2]==ab){aq.push(g.get_color_string(0))}else{if(aw[d2]==r){aq.push(g.get_color_string_end())}else{if(mode2==0){aq.push(aw[d2])}}}}}}aq.push(g.get_color_string_end());ah=g.fdiff3(ai[av],g.remove_tags(aw.join("")));aq.push(ae+'</SPAN><SPAN class="tooltip">'+ah.join("")+"</SPAN>");an=g.recode_added_parts(ai,ak,at,ad);aq=aq.concat(an);coded_yet=1}}if(!coded_yet){aq.push(g.get_color_string(0));aq=aq.concat(aj);aq.push(g.get_color_string_end())}if(j==1){aq.push(r)}}}if(ao==0){aq.push(ac[au])}else{if(ao==1){aj.push(ac[au])}else{if(ao==2){ao=0}}}}j--;return aq};g.get_main_base_claim=function(ad){for(var ae=0;ae<s.length;ae++){if(s[ae]==ad){var ac=/^(\d+)/;var af;if((af=ac.exec(z[ae]))!=null){var ag=parseInt(af[1]);if(ag<0){alert('Base value "'+base+'"out of bounds');return -1}else{return ag}}}}return -1};g.get_claim_base_exclusions=function(ap,av,ai,ah){var ak=0;var af;var ad=false;if(ah==false){ai=0;af=z}else{af=z.slice(0)}for(var aj=0;aj<s.length;aj++){if(s[aj]==ap){if((af[aj].search("!")>=0)&&(af[aj].search("&")>=0)){alert("Error in base override for claim "+ap+"\nCan't both include (&) and exclude (!) claims");return[]}var ao=/(.*)\[(\d+)\](.*)/;var ae;while((ae=ao.exec(af[aj]))!=null){if((Math.round(ae[2])<=ai)&&(Math.round(ae[2])!=0)){af[aj]=ae[1]+(av+parseInt(ae[2]))+ae[3];ad=true}else{if(ah==true){alert("Error in base override for claim "+ap+"\nInvalid paragraph number ["+ae[2]+"] encountered.")}else{if(af[aj].search("&")>=0){alert("Error in base override for claim "+ap+":\nuse of description not selected.")}}af[aj]=ae[1]+ae[3]}}var aq=af[aj].split(/[0-9!&\-\,]+/);if((aq=aq.join(""))!==""){alert("Error in base override for claim "+ap+"\nInvalid character(s) "+aq+' encountered.\n\nValid examples: "5!8,9,12-15,38-40" or "&8,9,12-15,38-40"');return[]}var at=af[aj];var ac=/(.*?)(\d+)\-(\d+)(.*)/;var ae,ag,an;while((ae=ac.exec(at))!=null){ag=parseInt(ae[2]);an=parseInt(ae[3]);if(ag>=an){alert("Invalid base override range ("+ae[2]+"-"+ae[3]+") for claim "+ap+".");return[]}at=""+ae[1]+ae[2];for(var au=ag+1;au<=an;au++){at=at+","+au}at=at+ae[4]}at=at.split(/[!&,]/);at.shift();if(af[aj].search("!")>=0){return at}else{if(af[aj].search("&")>=0){if((ad==false)&&(ah==true)){ai=0}var ar=[];for(var am=1;am<=av+ai;am++){for(var al=0;al<at.length;al++){if(at[al]==am){break}}if(al==at.length){ar.push(am)}}return ar}}break}}return[]};g.get_base_text_for_claim=function(ac){for(var ad=0;ad<s.length;ad++){if(s[ad]==ac){return z[ad]}}return""};g.insert_in_score_list=function(ad,ac,ae){ad.push(ac);ad.push(ae);for(var af=(ad.length/2)-2;af>=0;af--){if(ae<=ad[af*2+1]){break}ad[(af+1)*2]=ad[af*2];ad[(af+1)*2+1]=ad[af*2+1];ad[af*2]=ac;ad[af*2+1]=ae}return};g.show_dependency_table=function(ae,ah){var ad="<B>Claim dependency table:</B><BR>";var ac;for(var af=1;af<=ah;af++){if(typeof(ae[af])=="undefined"){continue}ac="    "+af+": ";ad=ad+ac.substr(-5);for(var ag=1;ag<=af;ag++){if(af==ag){ad=ad+"x "}else{if(typeof(ae[af][ag])=="undefined"){ad=ad+"- "}else{ad=ad+ae[af][ag]+" "}}}ad=ad+"<BR>"}return ad};g.format_claim_tree_recursive=function(al,ah,ak,ae,ad,ai){if(typeof(al[ah])=="undefined"){return ad}if(ad.indexOf("-"+ah+"-")>=0){return ad}var aj="";if(typeof(ai)!="undefined"){if(typeof(ai[ah])!="undefined"){aj="<SUP>("+ai[ah]+")</SUP>"}}for(var af=1;af<ae;af++){ad=ad+"| "}if(ae>0){ad=ad+"+ "}else{if(ae==0){ad=ad+"<BR>"}}if(ae==0){ad=ad+"<BR>-<B>"+ah+"</B>-"+aj+"<BR>"}else{ad=ad+"-"+ah+"-"+aj+"<BR>"}for(var ag=ah+1;ag<=ak;ag++){if(ad.indexOf("-"+ag+"-")>=0){continue}else{if(typeof(al[ag])=="undefined"){continue}else{if(al[ag][ah]==1){for(var ac=ah-1;ac>0;ac--){if(al[ag][ac]==1){break}}if(ac==0){if(typeof(ai)!="undefined"){if(typeof(ai[ag])!="undefined"){if(typeof(ai[ah])!="undefined"){ai[ag]=ai[ag]+";"+ai[ah]}}}ad=g.format_claim_tree_recursive(al,ag,ak,ae+1,ad,ai)}}}}}return ad};g.format_claim_tree=function(ac,au,ah){var ai="";for(var am=1;am<=au;am++){ai=g.format_claim_tree_recursive(ac,am,au,0,ai,ah)}var al=ai.split("<BR>");while((al.length>0)&&(al[0]=="")){al.shift()}for(var am=1;am<al.length;am++){al[am]=al[am].split(" ")}for(var an=0;an<au;an++){last="";for(var am=al.length-1;am>=1;am--){if(typeof(al[am][an])=="undefined"){last="";continue}else{if(al[am][an]=="|"){if(last==""){al[am][an]=" "}}else{if(al[am][an]=="+"){last="+"}else{last=""}}}}}for(var am=1;am<al.length;am++){al[am]=al[am].join(" ")}ai=al.join("<BR>");ai=ai.split("-");ai=ai.join("");ai=ai.split("+ ");ai=ai.join("+-");var aq=/(.*)<SUP>\((.*?)\)<\/SUP>(.*)/;var ak=/(.*?)\;(.*)/;var aj=/(\d+)/;var af,at;while((af=aq.exec(ai))!=null){if((at=ak.exec(af[2]))!=null){base_and_support=at[1].split(",")}else{base_and_support=af[2].split(",")}base_and_support[0]="<b><u>"+base_and_support[0]+"</u></b>";for(var ao=1;ao<base_and_support.length;ao++){base_and_support[ao]="<b>"+base_and_support[ao]+"</b>"}if(at!=null){af[2]=base_and_support.join(",")+","+at[2]}else{af[2]=base_and_support.join(",")}af[2]=af[2].split(";");af[2]=af[2].join(",");var ad=[];var ag=[];var ar;var ae=af[2].split(",");for(var ap=0;ap<ae.length;ap++){if((ar=aj.exec(ae[ap]))!=null){value=Math.round(ar[1]);for(var ao=0;ao<ad.length;ao++){if(ad[ao]>=value){break}}if((ao==ad.length)||(ad[ao]!=value)){ad.splice(ao,0,value);ag.splice(ao,0,ae[ap])}}}af[2]=ag.join(",");ai=af[1]+"<sup>("+af[2]+")</sup>"+af[3]}return ai};g.remove_claim_tree_deps=function(ac){var ad=/(.*)\((.*?)\)(.*)/;var af;while((af=ad.exec(ac))!=null){var ag=[];legend=af[2].split(/,/);for(var ae=0;ae<legend.length;ae++){if(legend[ae].indexOf("<b>")>=0){ag.push(legend[ae])}}ac=af[1]+"{"+ag.join(",")+"}"+af[3]}ac=ac.split(/\{/);ac=ac.join("(");ac=ac.split(/\}/);ac=ac.join(")");return ac};g.remove_claim_tree_deps_and_support=function(ac){var ad=/(.*)<sup>\((.*?)\)<\/sup>(.*)/;var ae;while((ae=ad.exec(ac))!=null){ac=ae[1]+ae[3]}return ac};g.do_claim_tree_analysis=function(al,ad,at,ai){var ap=/(\w+)(\s+)([C,c]laim)([s]*)(and|or|\s|\,|\-|\d)+(\w+)/;var am=" to - zu bis Ã  ";var an=" or , and oder ou ";var ah;var aq=[];var ar=[];var ac="";var ak=0;var ao;ar=new Array(ad+1);for(var ag=1;ag<=ad;ag++){if(typeof(al[ag])=="undefined"){continue}ao=false;ar[ag]=new Array(ag);for(var af=0;af<ag;af++){ar[ag][af]=0}words=g.split_punctuation(al[ag]);for(w1=2;w1<words.length;w1++){var aj=words[w1].toLowerCase();if(((aj.indexOf("claim")>=0)&&(aj.indexOf("claimed")<0))||(aj.indexOf("anspruch")>=0)||(aj.indexOf("ansprÃ¼che")>=0)||(aj.indexOf("revendication")>=0)){w1++;break}}var ae=false;ak=-1;for(;w1<words.length;w1++){if(words[w1].charAt(0)==" "){continue}the_number=parseInt(words[w1],10);if(the_number>0){if(the_number==ag){g.one_time_alert(at+ag+" refers back to itself.")}else{if(the_number>ag){g.one_time_alert(at+ag+" refers back to a later claim.")}else{ar[ag][the_number]=1;if(ae==false){ak=the_number}else{to_number=the_number;if(to_number<=ak){g.one_time_alert(at+ag+" has a malformed dependency range ("+ak+" to "+to_number+").")}else{for(d1=ak+1;d1<=to_number;d1++){ar[ag][d1]=1}}ae=false}}}ao=true}else{if((ak>0)&&(am.indexOf(words[w1])>=0)){ae=true}else{if(an.indexOf(words[w1])<0){break}}}}if(ao==false){lower_claim=al[ag].toLowerCase();lower_claim=lower_claim.replace(/\s+/g," ");lower_claim=lower_claim.replace(/voranstehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorangehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorhergehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgenannt/g,"vorstehend");lower_claim=lower_claim.replace(/vorangegangen/g,"vorstehend");lower_claim=lower_claim.replace(/vorherig/g,"vorstehend");lower_claim=lower_claim.replace(/bisherig/g,"vorstehend");if((lower_claim.indexOf("preceding claims")>=0)||(lower_claim.indexOf("previous claims")>=0)||(lower_claim.indexOf("above claims")>=0)||(lower_claim.indexOf("foregoing claims")>=0)||(lower_claim.indexOf("revendications pr")>=0)||(lower_claim.indexOf("den vorstehenden anspr")>=0)){for(d1=1;d1<ag;d1++){ar[ag][d1]=1}}else{if((lower_claim.indexOf("the preceding claim")>=0)||(lower_claim.indexOf("the previous claim")>=0)||(lower_claim.indexOf("the above claim")>=0)||(lower_claim.indexOf("the foregoing claim")>=0)||(lower_claim.indexOf("la revendication pr")>=0)||(lower_claim.indexOf("dem vorstehenden anspr")>=0)){ar[ag][ag-1]=1}else{if((lower_claim.indexOf("preceding claim")>=0)||(lower_claim.indexOf("previous claim")>=0)||(lower_claim.indexOf("above claim")>=0)||(lower_claim.indexOf("foregoing claim")>=0)||(lower_claim.indexOf("revendication pr")>=0)||(lower_claim.indexOf("vorstehenden anspr")>=0)){for(d1=1;d1<ag;d1++){ar[ag][d1]=1}}else{if((lower_claim.indexOf("claim")>=0)||(lower_claim.indexOf("revendication")>=0)||(lower_claim.indexOf("anspr")>=0)){if(lower_claim.indexOf("claim sets")<0){g.one_time_alert(at+ag+"'s dependency not understood, treating as independent.")}}}}}}}ac="<PRE><CODE>"+g.format_claim_tree(ar,ad,ai)+"</CODE></PRE>";return ac};var I=[];var P=0;var m=0;var C=[];g.reset_score_matrix=function(ac,ad){I=[];P=0;m=0;return};g.set_score_matrix_max=function(ad,ac){C[ad]=ac};g.set_score_matrix_value=function(ae,ac,ad){if(typeof(I[ae])=="undefined"){I[ae]=[]}if(ae>P){P=ae}if(ac>m){m=ac}I[ae][ac]=ad;return};var p=["#808080","#909090","#a0a0a0","#b0b0b0","#c0c0c0","#d0d0d0","#e0e0e0","#f0f0f0","#ffff00","#f0ff00","#d0ff00","#b0ff00","#90ff00","#80ff00","#60ff00","#40ff00","#00ff00"];g.score_matrix_score_colour=function(ac){if(ac>=100){return p[16]}if(ac<=0){return p[0]}return p[Math.floor(ac*16/100)]};g.format_score_matrix=function(){var ad="";var ae;var ac=[];for(let row=1;row<=P;row++){if(typeof(I[row])=="undefined"){continue}ac[row]=[];ae=1;for(let col=1;col<=m;col++){if(typeof(I[row][col])!="undefined"){if(I[row][col]>ae){ae=I[row][col]}}}for(let col=1;col<=m;col++){if(typeof(I[row][col])!="undefined"){ac[row][col]=100*I[row][col]/ae;I[row][col]=100*I[row][col]/C[row]}}}ad=ad+"<BR><H2>Score matrix</H2>";ad=ad+"<TABLE class='fdiff4'><TR><TH style='width:30px'>sc</TH>";for(col=1;col<=m;col++){ad=ad+"<TH style='width:30px'>"+col+"</TH>"}ad=ad+"<TH>old</TH>";ad=ad+"</TR>";for(row=1;row<=P;row++){if(typeof(I[row])!="undefined"){ad=ad+"<TR><TD><B>"+row+"</B></TD>";for(col=1;col<=m;col++){if(typeof(I[row][col])!="undefined"){ad=ad+"<TD bgcolor='"+g.score_matrix_score_colour(ac[row][col])+"'>"+I[row][col].toFixed(0)+"</TD>"}else{ad=ad+"<TD>&nbsp;</TD>"}}ad=ad+"<TD>&nbsp;</TB></TR>"}}ad=ad+"<TR><TD><B>new</B></TD>";for(col=1;col<=m;col++){ad=ad+"<TD>&nbsp;</TD>"}ad=ad+"</TR>";ad=ad+"</TABLE>";if(false){ad=ad+"<TABLE>";ad=ad+"<TR>";for(let col=0;col<=16;col++){ad=ad+"<TD bgcolor='"+p[col]+"'>&nbsp;</TD>"}ad=ad+"</TR>";ad=ad+"</TABLE>"}return ad};g.insert_line_breaks=function(ad,ai){if((X==false)&&(O==false)){ad=ad.split(/\t/);ad=ad.join("<BR>\n");return ad}if(X==true){ad=ad.split("&#59;");ad=ad.join("&#59;<BR>");ad=ad.split("&#58;");ad=ad.join("&#58;<BR>")}if(O==true){ad=ad.split(",");ad=ad.join(",<BR>")}var ah;var aj="OPEN_BRACKET_FOO_FOO_FOO";var ae="CLOSE_BRACKET_FOO_FOO_FOO";var ag=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ah=ag.exec(ad))!=null){var ac=ah[2].split("<BR>");ac=ac.join("");ad=ah[1]+aj+ac+ae+ah[3]}ad=ad.split(aj);ad=ad.join("(");ad=ad.split(ae);ad=ad.join(")");ad=ad.split("<BR> <BR>");ad=ad.join("<BR>");ad=ad.split("<BR><BR>");ad=ad.join("<BR>");ad=ad.split("<BR><BR>");ad=ad.join("<BR>");ad=ad.split(" <BR>");ad=ad.join("<BR>");ad=ad.split("<BR>");ad=ad.join("<BR>&nbsp;&nbsp;&nbsp;");if(ai){ad=ad.replace(/\d+\./g,function af(ak){return"<BR><BR>"+ak})}return ad};g.post_cleanup=function(ae,ah){if(G==true){deleted_parts=ae.split(D);if(deleted_parts.length>0){var ag,ad,ac;ad=new RegExp(D+"([A-Za-zÃ-Ã¿]+)(\\s+)([A-Za-zÃ-Ã¿]+)"+aa+ab+g.get_color_string(0)+"([A-Za-zÃ-Ã¿]+)"+g.get_color_string_end()+r+"([\\S\\s]*)");ac=new RegExp(D+"([A-Za-zÃ-Ã¿]+)"+aa+ab+g.get_color_string(0)+"([A-Za-zÃ-Ã¿]+)(\\s+)([A-Za-zÃ-Ã¿]+)"+g.get_color_string_end()+r+"([\\S\\s]*)");ae=deleted_parts[0];for(var af=1;af<deleted_parts.length;af++){deleted_parts[af]=D+deleted_parts[af];if((ag=ad.exec(deleted_parts[af]))!=null){if(ag[4]===(ag[1]+ag[3])){deleted_parts[af]=ag[1]+ag[2]+ag[3]+ag[5]}}if((ag=ac.exec(deleted_parts[af]))!=null){if(ag[1]===(ag[2]+ag[4])){deleted_parts[af]=ag[2]+ag[3]+ag[4]+ag[5]}}ae=ae+deleted_parts[af]}}}if(ah==false){if(A==true){highlight_and_rem_start='<span style="background-color: OrangeRed">'+D}else{highlight_and_rem_start='<span style="background-color: LightGrey">'+D}highlight_and_rem_end=aa+g.get_color_string_end();ae=(ae.split(D)).join(highlight_and_rem_start);ae=(ae.split(aa)).join(highlight_and_rem_end)}if((ah==true)&&(w==true)){highlight_and_add_start=g.get_color_string(0)+ab;highlight_and_rem_start='<span style="background-color: OrangeRed">'+D;highlight_and_add_end=r+g.get_color_string_end();highlight_and_rem_end=aa+g.get_color_string_end();ae=(ae.split(ab)).join(highlight_and_add_start);ae=(ae.split(D)).join(highlight_and_rem_start);ae=(ae.split(r)).join(highlight_and_add_end);ae=(ae.split(aa)).join(highlight_and_rem_end)}ae=g.insert_line_breaks(ae,ah);return ae};g.split_and_diff=function(aP,aO,aM){var aG,aE,ai;var aw,av,al;var aN,aj;var ap;var ax;var ad;var az,ak;var ar="";var aK,aI,aH;var an;var aL=aP;var aJ=aO;var at="text";var au=[];var ay=/\[\d+\]/;if(aM=="DESCMAGICFOO"){at="para";aG=g.split_desc(aP);aE=g.split_desc(aO);aw=aG.shift();av=aE.shift();if(aw<1){return"No original description paragraph(s) detected -- doing whole text comparison <HR>\n"+g.diff(aL,aJ)}aM=""}else{at="claim";aP=g.ocr_cleanup(aP);aO=g.ocr_cleanup(aO);aG=g.split_claims(aP,"original");aE=g.split_claims(aO,"amended");aw=aG.shift();av=aE.shift();if(aw<1){return"No original claim number(s) detected -- doing whole text comparison <HR>\n"+g.diff(aL,aJ)}if(B.length>0){aN=g.split_desc(aM);aj=aN.shift()}else{aN=[];aj=0}}ar=ar+"<TABLE class='fdiff4'><TR class='fdiff4'><TH class='fdiff4'>New<BR>"+at+"</TH><TH class='fdiff4'>Old<BR>"+at+"</TH><TH class='fdiff4 noprint'>Base<BR>override</TH>";if(at=="claim"){ar=ar+"<TH class='fdiff4 noprint'>Use<BR>desc</TH>"}ar=ar+"<TH class='fdiff4'><DIV contenteditable>"+E+"</DIV></TH></TR>\n";if((typeof aE[0]!="undefined")&&(aE[0]!="")){ar=ar+"<TR class='fdiff4'><TD class='fdiff4'></TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD>";if(at=="claim"){ar=ar+"<TD class='fdiff noprint'>&nbsp;</TD>"}ar=ar+"<TD class='fdiff4'>"+aE[0]+"</TD></TR>\n"}g.reset_feature_blocks();g.reset_score_matrix();for(c2=1;c2<=av;c2++){first_absent=c2;while((c2<av)&&((typeof aE[c2]=="undefined")||(aE[c2]==""))){c2++}if(c2>first_absent){ar=ar+"<TR class='fdiff4'><TD class='fdiff4'>"+first_absent;if(c2>(first_absent+1)){ar=ar+"-"+(c2-1)}ar=ar+"</TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD><TD class='fdiff4'></TD></TR>\n"}an=Q;score_list=[];best_claim=-1;az=false;if((best_claim=g.get_main_base_claim(c2))>=0){if((best_claim>0)&&(typeof aG[best_claim]=="undefined")){alert("Base "+at+" "+best_claim+" for "+at+" "+c2+" not found in original "+at+"s!");best_claim=-1}else{az=true}}ak=false;for(var ad=0;ad<B.length;ad++){if(B[ad]==c2){ak=true;break}}if(ak==false){for(var aC=0;aC<s.length;aC++){if(s[aC]==c2){if(z[aC].search(ay)>=0){ak=true;g.set_use_desc_override(c2);if(aj==0&&aM!=""){aN=g.split_desc(aM);aj=aN.shift()}}}}}aE[c2]=g.find_feature_blocks(c2,aE[c2]);for(var ah=1;ah<=aw;ah++){if(typeof aG[ah]=="undefined"){continue}ap=g.fdiff3(aG[ah],aE[c2]);diff_score=g.count_unchanged(ap);if(diff_score>an){if(az==false){best_claim=ah}an=diff_score}g.insert_in_score_list(score_list,ah,diff_score);g.set_score_matrix_value(c2,ah,diff_score)}ap=g.fdiff3(aE[c2],aE[c2]);diff_score=g.count_unchanged(ap);g.set_score_matrix_max(c2,diff_score);ai=aG.slice();var ag=g.get_claim_base_exclusions(c2,aw,aj,ak);al=aw;if((aj>0)&&(ak==true)){for(var ad=1;ad<=aj;ad++){ai[aw+ad]=aN[ad]}al=aw+aj}for(var ae=0;ae<ag.length;ae++){ah=ag[ae];if((ah>0)&&(ah<=al)){ai[ah]=undefined;az=true}else{if(ah==0){for(ah=0;ah<=al;ah++){ai[ah]=undefined}az=true}}}if(best_claim>0){ax=[best_claim];ap=g.fdiff3(aG[best_claim],aE[c2])}else{ax=["N/A"];ap=g.fdiff3("",aE[c2])}ap=g.collect_deleted_parts(ap);ap=g.replace_feature_markers(ap);ap=g.recode_added_parts(ai,al,ap,ax);ar=ar+"<TR class='fdiff4'><TD class='fdiff4'>"+c2+"</TD><TD class='fdiff4'>";if(best_claim>0){ar=ar+"<SPAN>"+ax[0]+'</SPAN><SPAN class="tooltip">'+aG[best_claim]+"</SPAN>"}else{ar=ar+ax[0]}claim_tree_legend=""+ax[0];for(ad=1;ad<ax.length;ad++){var aq=/([\S\s]+>)(\d+)(<[\s\S]+)/;var ac,ao;var am=ax[ad];if((ac=aq.exec(ax[ad]))!=null){ao=parseInt(ac[2]);if(ao>aw){desc_para=ao-aw;am="<SPAN>"+ac[1]+"["+desc_para+"]"+ac[3]+'</SPAN><SPAN class="tooltip">'+ai[ao]+"</SPAN>";claim_tree_legend_text=",["+desc_para+"]"}else{am="<SPAN>"+ax[ad]+'</SPAN><SPAN class="tooltip">'+aG[ao]+"</SPAN>";claim_tree_legend_text=","+ao}if((ao!=ax[0])&&(claim_tree_legend.indexOf(claim_tree_legend_text)<0)){claim_tree_legend=claim_tree_legend+claim_tree_legend_text}}ar=ar+am}au[c2]=claim_tree_legend;ar=ar+"</TD><TD class='fdiff4 noprint' align='center'>";if(az==true){ar=ar+'<INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'" value="'+g.get_base_text_for_claim(c2)+'">'}else{ar=ar+' <INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'">'}loop_end=score_list.length/2;if(loop_end>3){loop_end=3}for(ad=1;ad<loop_end;ad++){ar=ar+'<BR><span style="font-size:smaller">'+score_list[ad*2]+"="+Math.round((score_list[ad*2+1]*100)/score_list[1])+"% </span>"}if(at=="claim"){ar=ar+"</TD><TD class='fdiff4 noprint' align='center'>";if(ak==true){ar=ar+'<INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'" checked>'}else{ar=ar+' <INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'">'}}ar=ar+"</TD><TD class='fdiff4'><DIV contenteditable>";var af="";for(ad=0;ad<ap.length;ad++){af=af+ap[ad]}ar=ar+g.post_cleanup(af,0)+"</DIV></TD></TR>\n"}ar=ar+"</TABLE>\n";aK=g.format_claim_span(aG,aw);aI=g.format_claim_span(aE,av);ar=ar+"<p>Original "+at+"s detected: "+aK+"<br>Amended "+at+"s detected: "+aI;if((M==true)&&((aK.search("Warn")>-1)||(aI.search("Warn")>-1))){alert("At least one of the detected "+at+" sets has irregular numbering.\nPlease verify that all "+at+" are properly identified and edit the text if necessary.\n\nYou can turn this message off by de-selecting the option below.")}if(at=="claim"){if(B.length>0){aH=g.format_claim_span(aN,aj);ar=ar+"<br>Original description paragraphs detected: "+aH}else{ar=ar+"<br>(Description not analyzed)"}if(u==true){var aF=g.do_claim_tree_analysis(aG,aw,"Original claim ");var aD=g.do_claim_tree_analysis(aE,av,"Amended claim ",au);var aB=g.remove_claim_tree_deps(aD);var aA=g.remove_claim_tree_deps_and_support(aD);ar=ar+"<BR><H2>Claim trees</H2>";ar=ar+"<TABLE class='fdiff4'><TR class='fdiff4'><TH class='fdiff4'> Original </TH><TH class='fdiff4'> Amended </TH><TH class='fdiff4'> Amended (+supt)</TH><TH class='fdiff4'> Amended (+supt +deps)</TH></TR><TR class='fdiff4'><TD valign='top' style='vertical-align: top !important'>";ar+=aF;ar+="</TD><TD valign='top' style='vertical-align: top !important'>";ar+=aA;ar+="</TD><TD valign='top' style='vertical-align: top !important'>";ar+=aB;ar+="</TD><TD valign='top' style='vertical-align: top !important'>";ar+=aD;ar+="<BR><BR>&nbsp;&nbsp;<U>Legend:</U><BR>&nbsp;&nbsp;<SUP>(<B><U>2</U></B>)</SUP> base claim<BR>&nbsp;&nbsp;<SUP>(<B>3</B>)</SUP> support claim<BR>&nbsp;&nbsp;<SUP>(4)</SUP> inherited from parent";ar=ar+"</TD></TR></TABLE>"}if(W==true){ar=ar+g.format_score_matrix()}}ar=ar+g.one_time_alert_get_log();return ar};g.diff=function(aj,ai){var ah;var ac;var ae,ad;var ag,af;aj=g.ocr_cleanup(aj);ai=g.ocr_cleanup(ai);ah=g.fdiff3(aj,ai);output="";for(ac=0;ac<ah.length;ac++){output=output+ah[ac]}output=g.post_cleanup(output,1);return output};g.insert_new_lines=function(ae){var af="fj1423lkfnsfdsghdh32342";var ad=new RegExp("^([\\s\\S]*\\.)[ \\t]+([\\s\\S]*)");var ac=new RegExp("^([\\s\\S]*\\d+\\.)$");while((matches=ad.exec(ae))!=null){if(ac.test(matches[1])){ae=matches[1]+af+matches[2]}else{ae=matches[1]+"\n\n"+matches[2]}}ae=ae.split(af);ae=ae.join(" ");return ae};g.set_basis_threshold=function(ac){if((ac>=5)&&(ac<=50)){Q=ac;return"OK"}else{return"Value out of bounds"}};g.set_fdiff3_highlights=function(ac){if(ac=="checked"){w=true}else{w=false}return"OK"};g.set_fdiff4_strikeout_highlights=function(ac){if(ac=="checked"){A=true}else{A=false}return"OK"};g.set_fdiff4_warn_claims=function(ac){if(ac=="checked"){M=true}else{M=false}return"OK"};g.set_fdiff4_simplify_legend=function(ac){if(ac=="checked"){n=true}else{n=false}return"OK"};g.set_fdiff4_tree_analysis=function(ac){if(ac=="checked"){u=true}else{u=false}return"OK"};g.set_fdiff4_score_matrix=function(ac){if(ac=="checked"){W=true}else{W=false}return"OK"};g.set_convert_claim_styles=function(ac){if(ac=="checked"){Z=true}else{Z=false}return"OK"};g.set_ignore_hyphenation=function(ac){if(ac=="checked"){R=true}else{R=false}return"OK"};g.set_eszett_normalization=function(ac){if(ac=="checked"){L=true}else{L=false}return"OK"};g.set_ignore_case=function(ac){if(ac=="checked"){a=true}else{a=false}return"OK"};g.set_ignore_spaces=function(ac){if(ac=="checked"){N=true}else{N=false}return"OK"};g.set_ignore_in_brackets=function(ac){if(ac=="checked"){h=true}else{h=false}return"OK"};g.set_fix_glued_words=function(ac){if(ac=="checked"){G=true}else{G=false}return"OK"};g.set_insert_line_breaks_indents=function(ac){if(ac=="checked"){X=true}else{X=false}return"OK"};g.set_insert_line_breaks_indents2=function(ac){if(ac=="checked"){O=true}else{O=false}return"OK"};g.clear_claim_base_overrides=function(){s=[];z=[];return"OK"};g.set_claim_base_override=function(ac,ae){var ad=parseInt(ac);if(ad<1){alert('Claim value "'+ac+'" out of bounds in claim base override!');return"Error"}ae=ae.split(/\s+/);ae=ae.join("");s.push(ad);z.push(ae);return"OK"};g.clear_use_desc_overrides=function(){B=[];return"OK"};g.set_use_desc_override=function(ac){var ad=parseInt(ac);if(ad<1){alert('Claim value "'+ac+'" out of bounds in use description override!');return"Error"}B.push(ad);return"OK"};g.get_version=function(){return t};g.set_title=function(ac){E=ac;return"OK"};g.regenerate_title=function(){if(U!=""){E="'"+v+"' vs. '"+F+"'"}else{E="Difference"}return"OK"};g.set_header_orig=function(ac){F=ac;g.regenerate_title();return"OK"};g.set_header_new=function(ac){v=ac;g.regenerate_title();return"OK"};g.set_dossier_number=function(ac){U=ac;g.regenerate_title();return"OK"};g.filter_table_contents=function(ah,ak){var an=/([\s\S]*?)<span class="tooltip">([\s\S]*?)<\/span>([\s\S]*)/;var af=/([\s\S]*?)<\/span>([\s\S]*)/;var ad=/([\s\S]*?)<div contenteditable="">([\s\S]*?)<\/div>([\s\S]*)/;var ac=/<table([\s\S]*)/;var ag,al;ah=(ah.split(/ style="cursor: default;"/)).join("");ah=(ah.split(/ style="cursor: default; /)).join(' style="');var ao=ah.split(/<\/table>/);if(ao.length<1){return ah}while(ao.length>1){ao.pop()}var aq=ao[0].split(/<tr/);for(var ap=1;ap<aq.length;ap++){var aj;if(ap==1){aj=aq[ap].split(/<th/)}else{aj=aq[ap].split(/<td/)}if(ak==true){for(var ae=1;ae<aj.length;ae++){aj[ae]=" style='text-align: left !important'"+aj[ae]}}if(aj.length>=5){aj[3]=aj.pop();if(aj.length==5){aj.pop()}if(ap==1){aq[ap]=aj.join("<th")}else{aq[ap]=aj.join("<td")}}while((ag=an.exec(aq[ap]))!=null){var ai=(ag[2].match(/\<span/g)||[]).length;var am=(ag[2].match(/\<\/span/g)||[]).length;while(ai!=am){if((al=af.exec(ag[3]))!=null){ag[2]=ag[2]+"</span>"+al[1];ag[3]=al[2];ai=(ag[2].match(/\<span/g)||[]).length;am=(ag[2].match(/\<\/span/g)||[]).length}else{ai=am}}aq[ap]=ag[1]+ag[3]}while((ag=ad.exec(aq[ap]))!=null){aq[ap]=ag[1]+ag[2]+ag[3]}}ao[0]=aq.join("<tr");if(ao.length>1){ah=ao.join("</table>")}else{ah=ao[0]+"</table>&nbsp;<br>"}return ah};g.filter_table_colours=function(ad){var ac=/([\s\S]*)<span style=\"background-color([\s\S]*?)>([\s\S]*?)<\/span>([\s\S]*)/;var af;var ae=ad.split(/<tr/);for(var ag=1;ag<ae.length;ag++){while((af=ac.exec(ae[ag]))!=null){ae[ag]=af[1]+af[3]+af[4]}}ad=ae.join("<tr");return ad};g.filter_table_basis=function(ag){var af;var ah="class='fdiff'";var ad="<tr "+ah+">";var ac="<td "+ah+">";var aj="<th "+ah+' colspan="2">';var an="<th "+ah+">";var ap=ag.split(/<tr/);if(ap.length>=1){var am="Basis for the amendments";var ak=/(.*)>(.*?)<\/th><\/tr>/;if((af=ak.exec(ap[1]))!=null){am=af[2]}ap[1]=ad+aj+am+"</th></tr>"+ad+an+"Claim</th>"+an+"Basis</th></tr>"}for(var ao=2;ao<ap.length;ao++){var al=ap[ao].split(/<\/td>/);var ae=/(.*?)<span>(\s*)([\[\]\d]+)<\/span>(.*)/;var ai="";while((af=ae.exec(al[1]))!=null){if(ai!=""){ai=ai+" + "}ai=ai+af[3];al[1]=af[1]+af[4]}al[1]=ac+ai;al[2]=al[3];al.pop();ap[ao]="<tr"+al.join("</td>")}ag=ap.join("");return ag};return g}());