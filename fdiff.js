var fdiff=(function(){var h={};var s="4.74";var W="<u>";var q="</u>";var A="<s>";var V="</s>";var l="[[";var O="]]";var p="{{{";var b="}}}";var k=0;var m=0;var g=1;var d=2;var T=3;var P=4;var H=5;var o=6;var w=7;var e=1;var R=7;var M=15;var v=true;var y=true;var J=true;var n=true;var t=false;var N=false;var I=false;var a=false;var K=false;var j=false;var U=true;var E=true;var F=false;var S=false;var L=false;var r=[];var x=[];var z=[];var f=[];var D=[];var G=[];var B="Difference";var C="";var u="";var Q="";h.fix_unclosed_brackets=function(ad){var Z;var ac,X;var ab="";var Y="",aa="";Z=ad.toString().split("");for(X=0;X<Z.length;X++){ac=Z[X];if(ab!==""){ab=ab+ac;if(ac===")"){if(j==false){Y=Y+ab}ab=""}}else{if(ac==="("){ab=ac;if(aa!==""){Y=Y+aa;aa=""}}else{aa=aa+ac}}}if(ab!==""){return Y+"{"+ab.substr(1)}return Y+aa};h.handle_reference_signs=function(Z){if(j==true){var Y;var X=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((Y=X.exec(Z))!=null){Z=Y[1]+Y[3]}}return h.fix_unclosed_brackets(Z)};h.LCSubStr2=function(ah,ae,aa,Y){var Z,X,aj,ai;var ad=new Array(-1,-1,-1,-1);var ag=[];var af=0;var ac,ab;for(aj=0;aj<aa.length;aj++){Z=aa[aj];ag[aj]=[];for(ai=0;ai<Y.length;ai++){X=Y[ai];if(ah[Z]===ae[X]){if((aj===0)||(ai===0)){ag[aj][ai]=1}else{ag[aj][ai]=ag[aj-1][ai-1]+1}if(ag[aj][ai]>af){af=ag[aj][ai];ad[0]=aa[aj-af+1];ad[1]=aa[aj];ad[2]=Y[ai-af+1];ad[3]=Y[ai]}}else{ag[aj][ai]=0}}}return ad};h.recurse=function(ao,an,ad,aA){var ai,au,ah,at,ar,aq;var ac=[];var ax=[];var ag=[];var aB=[];var am=[];var ab=[];var ae;var Z,Y,aj,ap;var al,aa,av,af;var aC,az;var aw=/\s/;if(ao.length<=0){if(an.length>=1){return[W].concat(an,q)}else{return[""]}}else{if(an.length<=0){return[A].concat(ao,V)}}if(a){var ay=[],X=[];for(var ak=0;ak<ao.length;ak++){ay.push(ao[ak].toUpperCase())}for(var ak=0;ak<an.length;ak++){X.push(an[ak].toUpperCase())}ae=h.LCSubStr2(ay,X,ad,aA)}else{ae=h.LCSubStr2(ao,an,ad,aA)}Z=ae[0];Y=ae[1];aj=ae[2];ap=ae[3];if(Z<0){al=[];while((ao.length>0)&&(an.length>0)&&(ao[0]===an[0])){al.push(ao.shift());an.shift()}aa=[];while((ao.length>0)&&(an.length>0)&&(ao[ao.length-1]===an[an.length-1])){aa.unshift(ao.pop());an.pop()}if(ao.length>0){av=[A];av=av.concat(ao);av.push(V)}else{av=[]}if(an.length>0){af=[W];af=af.concat(an);af.push(q)}else{af=[]}return al.concat(av,af,aa)}if((Z===0)&&(Y===ao.length-1)&&(aj===0)&&(ap===an.length-1)){return an}ai=ao.splice(0,Z);au=an.splice(0,aj);ar=ao.splice(0,Y-Z+1);aq=an.splice(0,ap-aj+1);ah=ao;at=an;for(az=0;az<ad.length;az++){aC=ad[az];if(aC>Y){ax.push(aC-Y-1)}if(aC<Z){ac.push(aC)}}for(az=0;az<aA.length;az++){aC=aA[az];if(aC>ap){aB.push(aC-ap-1)}if(aC<aj){ag.push(aC)}}for(aC=0;aC<ar.length;aC++){if(!aw.test(ar[aC])){am.push(aC)}}for(aC=0;aC<aq.length;aC++){if(!aw.test(aq[aC])){ab.push(aC)}}return(h.recurse(ai,au,ac,ag)).concat(h.recurse(ar,aq,am,ab),h.recurse(ah,at,ax,aB))};h.find_keyword_indices=function(ab){var aa=[];var Y;var Z;var X=/[\s,;:?!"'\-&\/()]/;for(Y=0;Y<ab.length;Y++){Z=ab[Y];if(Z===""){continue}if(X.test(Z)){continue}aa.push(Y)}return aa};h.split_punctuation=function(ai){var ah;var af=[];var ac="";var ab,X="",ae;var aj=/[\s,.;:?!"'\-\/]/;var Z=/[a-z,A-Z,\#,0-9]/;var Y=/(.*?)([+\-±\s]+)(\d+\.\d+)(\s+)(.*)/;var aa=/\d+\.\d+/;var ad;ah=[];if(aa.test(ai)){while((ad=Y.exec(ai))!=null){ah=ah.concat(ad[1].toString().split(""));ah=ah.concat(ad[2].toString().split(""));ah.push(ad[3]);ah=ah.concat(ad[4].toString().split(""));ai=ad[5]}}if(ai!==""){ah=ah.concat(ai.toString().split(""))}for(ae=0;ae<ah.length;ae++){ab=ah[ae];if(ac!==""){ac=ac+ab;if(ab===")"){if(j==false){af.push(ac)}else{if((af.length>0)&&(af[af.length-1]===" ")){af.pop()}}ac=""}}else{if(ab==="("){ac=ab;if(X!==""){af.push(X);X=""}}else{if(aj.test(ab)){if(X!==""){af.push(X)}af.push(ab);X=""}else{if(ab==="&"){if(X!==""){af.push(X)}X="&";for(var ag=ae+1;ag<ah.length;ag++){if(Z.test(ah[ag])){X=X+ah[ag]}else{break}}if((ag<ah.length)&&(ah[ag]===";")&&(ag>ae+1)){af.push(X+";");ae=ag}else{af.push("&")}X=""}else{X=X+ab}}}}}if(X!==""){af.push(X)}return af};h.remove_deleted_tabs=function(Z){var Y=false;for(var X=0;X<Z.length;X++){if(Z[X]==A){Y=true}else{if(Y==true){if(Z[X]==V){Y=false}else{if(Z[X]=="\t"){Z[X]=" "}}}}}for(var X=0;X<Z.length-2;X++){if((Z[X]==A)&&(Z[X+1]==" ")&&(Z[X+2]==V)){Z.splice(X,3);X=X-1}}for(var X=0;X<Z.length-2;X++){if((Z[X]==W)&&(Z[X+2]==q)&&((Z[X+1]==" ")||(Z[X+1]=="\t"))){Z.splice(X+2,1);Z.splice(X,1)}}return Z};h.fdiff3=function(ad,ac){var ab,Z;var Y,X;var aa;ab=h.split_punctuation(ad);Z=h.split_punctuation(ac);Y=h.find_keyword_indices(ab);X=h.find_keyword_indices(Z);aa=h.recurse(ab,Z,Y,X);return h.remove_deleted_tabs(aa)};h.detect_language=function(ad){var Y=0,X=0,aa=0;var ac="X";var ab,Z;X=1+(ad.split(/claim/i)).length-1+(ad.split(/characteri/i)).length-1+(ad.split(/according/i)).length-1;Y=1+(ad.split(/revendication/i)).length-1+(ad.split(/caract.ris/i)).length-1+(ad.split(/selon/i)).length-1;aa=1+(ad.split(/anspr.ch/i)).length-1+(ad.split(/gekennzeich/i)).length-1+(ad.split(/nach/i)).length-1;if(X>=aa){ab=X;Z=aa}else{ab=aa;Z=X}if(Y>=ab){Z=ab;ab=Y}else{if(Y>=Z){Z=Y}}if((ab/Z)>=3){if(ab==X){ac="E"}else{if(ab==aa){ac="D"}else{ac="F"}}}return ac};h.correct_missing_spaces=function(ad){var ac;ac=h.detect_language(ad);ad=ad.split(/\:/);ad=ad.join(": ");ad=ad.split(/\;/);ad=ad.join("; ");ad=ad.split(/\,/);ad=ad.join(", ");if(ac=="E"){ad=ad.split(/ ofa /);ad=ad.join(" of a ");ad=ad.split(/ wherein/);ad=ad.join(" wherein ");ad=ad.split(/ wherein :/);ad=ad.join(" wherein:");ad=ad.split(/ said/);ad=ad.join(" said ");ad=ad.split(/ and\/or/);ad=ad.join(" ANDSLASHOR ");ad=ad.split(/ and\,/);ad=ad.join(" ANDCOMMA ");ad=ad.split(/ and/);ad=ad.join(" and ");ad=ad.split(/ ANDSLASHOR /);ad=ad.join(" and/or");ad=ad.split(/ ANDCOMMA /);ad=ad.join(" and, ");ad=ad.split(/inthat/);ad=ad.join("in that");ad=ad.split(/ that/);ad=ad.join(" that ");ad=ad.split(/ that :/);ad=ad.join(" that:");ad=ad.split(/orfurther/);ad=ad.join("or further");ad=ad.split(/orwhere/);ad=ad.join("or where");ad=ad.split(/orthat/);ad=ad.join("or that")}if(ac=="E"){var Y=/(claim)(\d)/i;var X=/(claims)(\d)/i;var ab;if((ab=Y.exec(ad))!=null){var Z=/([\s\S]*)(claim)(\d+)([\s\S]*)/i;while((ab=Z.exec(ad))!=null){ad=ab[1]+ab[2]+" "+ab[3]+ab[4]}}if((ab=X.exec(ad))!=null){var aa=/([\s\S]*)(claims)(\d+)([\s\S]*)/i;while((ab=aa.exec(ad))!=null){ad=ab[1]+ab[2]+" "+ab[3]+ab[4]}}}return ad};h.ocr_cleanup=function(Z){if(E==true){Z=h.correct_missing_spaces(Z)}Z=h.handle_reference_signs(Z);if(K==true){Z=Z.split(/\s+\)/);Z=Z.join(")");Z=Z.split(/\(\s+/);Z=Z.join("(");Z=Z.split(/\s+\]/);Z=Z.join("]");Z=Z.split(/\[\s+/);Z=Z.join("[");Z=Z.split(/\s+\,/);Z=Z.join(",");Z=Z.split(/\s+\;/);Z=Z.join(";");Z=Z.split(/\s+\:/);Z=Z.join(":");Z=Z.split(/\s+\./);Z=Z.join(".")}Z=Z.split("<RTI>");Z=Z.join("");Z=Z.split("<RTIgt;");Z=Z.join("");Z=Z.split("</RTI>");Z=Z.join("");Z=Z.replace(/\&/g,"AMPERSANDFOOBAR");Z=Z.replace(/\;/g,"&#59;");Z=Z.replace(/\:/g,"&#58;");Z=Z.replace(/AMPERSANDFOOBAR/g,"&amp;");Z=Z.replace(/\u2013|\u2014/g,"-");Z=Z.replace(/\u2018|\u2019|\u201A|\u0060/g,"'");Z=Z.replace(/\u201c|\u201d|\u201e/g,'"');Z=Z.split("<");Z=Z.join("&lt;");Z=Z.split(">");Z=Z.join("&gt;");if(I==true){Z=Z.replace(/\u00df/g,"ss")}Z=Z.split(/[ \t]+/);Z=Z.join(" ");Z=Z.split(/[\n\f\r]+/);Z=Z.join("\t");if(N==true){var X=/(.*[a-zA-Z\u00e9\u00e8\u00f6\u00fc]+)\-\s*(\w+.*)/;var Y;while((Y=X.exec(Z))!=null){Z=Y[1]+Y[2]}}return Z};h.ocr_cleanup_desc=function(aa){var X=j;var Y=N;var Z;j=false;N=false;Z=h.ocr_cleanup(aa);j=X;N=Y;return Z};h.form_claim_reg_exp=function(Z){var Y;var X;Z=Z.toString();Y=Z.split("");re="";for(X=0;X<Y.length;X++){if(X>0){re=re+"\\s{0,1}"}if(Y[X]==1){pat="[1,l,I,i]"}else{if(Y[X]==2){pat="[2,Z,z]"}else{if(Y[X]==5){pat="[5,S,s]"}else{if(Y[X]==0){pat="[0,O,o]"}else{pat=Y[X]}}}}re=re+pat}return re};h.handle_strict_patterns=function(aa,am,af,ad,an,ah){var ab;var Z;var ak=0;var Y=100000;var ao=[];var ac;var aj;var ag;var ai=false;var ae=[];if(typeof(ah)=="undefined"){ah=""}ab=new RegExp("(.*\\.\\s*)("+am+")(\\d+)("+af+")(.*)$",ah);while((Z=ab.exec(aa))!=null){claim_no=parseInt(Z[3],10);if(typeof ao[claim_no]!="undefined"){ai=true;ae.push(claim_no)}ao[claim_no]=Z[2]+Z[3]+Z[4]+Z[5];aa=Z[1];if(ak<claim_no){ak=claim_no}if(Y>claim_no){Y=claim_no}}v2="";ab=new RegExp("^(.*?)("+am+")(\\d+)("+af+")(.*)$",ah);while((Z=ab.exec(aa))!=null){claim_no=parseInt(Z[3],10);aa=Z[1];v2=Z[2]+Z[3]+Z[4]+Z[5]+v2;if((claim_no<Y)&&(claim_no>0)){ao[claim_no]=v2;v2="";Y=claim_no}if(ak<claim_no){ak=claim_no}}if(ai==true){var al="Warning: the following claims/paragraphs have been found multiple times:\n";al=al+ae.pop();while(ae.length>0){al=al+", "+ae.pop()}alert(al+".\nPlease check the text in the input window.")}ao[0]=aa;if(ak>1000){var X=ak;ak=1000;while((ak>0)&&(typeof(ao[ak])=="undefined")){ak--}alert("Something probably went wrong.\nHighest claim number detected: "+X+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ak+".")}ag=0;for(c=1;c<=ak+3;c++){if(typeof ao[c]=="undefined"){ab=new RegExp(h.form_claim_reg_exp(c));if(ab.test(ao[ag])){ab=new RegExp(ad+h.form_claim_reg_exp(c)+an);if(ab.test(ao[ag])){if(ag==0){ab=new RegExp("(.*?)("+ad+h.form_claim_reg_exp(c)+an+")(.*)",ah)}else{ab=new RegExp("(.*?[\\.\\s]+)("+ad+h.form_claim_reg_exp(c)+an+")(.*)",ah)}if((Z=ab.exec(ao[ag]))!=null){ao[ag]=Z[1];ao[c]=Z[2]+Z[3];ag=c;if(c>ak){ak=c}}}}}else{ag=c}}ao.unshift(ak);return ao};h.handle_square_brackets_type_claims=function(X){return h.handle_strict_patterns(X,"\\[","\\]","\\[[0oO\\s]*","\\s{0,1}\\]")};h.handle_siemens_type_claims=function(Y){var X=h.detect_language(Y);if(X=="E"){return h.handle_strict_patterns(Y,"\\[claim\\s+","\\]","\\[claim\\s+","\\s{0,1}\\]","i")}else{if(X=="D"){return h.handle_strict_patterns(Y,"\\[anspruch\\s+","\\]","\\[anspruch\\s+","\\s{0,1}\\]","i")}else{if(X=="F"){return h.handle_strict_patterns(Y,"\\[revendication\\s+","\\]","\\[revendication\\s+","\\s{0,1}\\]","i")}else{return[0,Y]}}}};h.handle_claim_type_claims=function(Y){var X=h.detect_language(Y);if(X=="E"){return h.handle_strict_patterns(Y,"claim\\s+","\\.","claim\\s+","\\s{0,1}\\.","i")}else{if(X=="D"){return h.handle_strict_patterns(Y,"anspruch\\s+","\\.","anspruch\\s+","\\s{0,1}\\.","i")}else{if(X=="F"){return h.handle_strict_patterns(Y,"revendication\\s+","\\.","revendication\\s+","\\s{0,1}\\.","i")}else{return[0,Y]}}}};h.count_matches=function(aa,X){var Z;var Y=0;while((Z=X.exec(aa))!=null){Y=Y+1;aa=Z[1]}return Y};h.detect_claim_numbering_style=function(ab){var ap=/\.\s*\d+\.(.*)/;var ac=/^\d+\./;var ao=/\[\d+\]\s+(.*)/;var Y=/\[\s*anspruch\s+\d+\s*\](.*)/i;var X=/\[\s*revendication\s+\d+\s*\](.*)/i;var ar=/\[\s*claim\s+\d+\s*\](.*)/i;var am=/\.\s*\d+\/(.*)/;var ad=/^\d+\//;var al=/\.\s*\d+\s{0,1}\-(.*)/;var ah=/^\d+\s{0,1}\-/;var aj=/\.\s*\d+\)(.*)/;var Z=/^\d+\)/;var ak=/\.\s*anspruch\s+\d+\.(.*)/i;var ai=/\.\s*revendication\s+\d+\.(.*)/i;var ag=/\.\s*claim\s+\d+\.(.*)/i;var ae=[0,0,0,0,0,0,0,0,0,0,0,0];var aa;ae[g]=h.count_matches(ab,ap);if((matches=ac.exec(ab))!=null){ae[g]=ae[g]+1}ae[d]=h.count_matches(ab,ao);ae[T]=h.count_matches(ab,Y)+h.count_matches(ab,X)+h.count_matches(ab,ar);ae[w]=h.count_matches(ab,ak)+h.count_matches(ab,ai)+h.count_matches(ab,ag);ae[P]=h.count_matches(ab,am);if((matches=ad.exec(ab))!=null){ae[P]=ae[P]+1}ae[H]=h.count_matches(ab,al);if((matches=ah.exec(ab))!=null){ae[H]=ae[H]+1}var aq=j;j=true;var af=h.split_punctuation(ab);aa=af.join("");j=aq;ae[o]=h.count_matches(aa,aj);if((matches=Z.exec(aa))!=null){ae[o]=ae[o]+1}largest_score=ae[e];largest_score_style=e;second_largest_score=0;second_largest_score_style=m;for(var an=e+1;an<=R;an++){if(ae[an]>second_largest_score){if(ae[an]>largest_score){second_largest_score=largest_score;second_largest_score_style=largest_score_style;largest_score=ae[an];largest_score_style=an}else{second_largest_score=ae[an];second_largest_score_style=an}}}if((largest_score_style==d)&&(largest_score>=10)){claim_style=largest_score_style}else{if((second_largest_score!=0)&&(largest_score<2*second_largest_score)){claim_style=m}else{claim_style=largest_score_style}}return claim_style};h.split_claims=function(af){var ai;var Z;var al=0;var ad=100000;var ab=[];var am;var ak;var ae;var aa=false;var aj=[];if(U==true){am=h.detect_claim_numbering_style(af)}else{am=m}var ac="\\.";var ah="[.,]";var X="\\s{0,1}\\.";if(am==d){return h.handle_square_brackets_type_claims(af)}else{if(am==T){return h.handle_siemens_type_claims(af)}else{if(am==w){return h.handle_claim_type_claims(af)}else{if(am==P){ac="\\/";ah=ac;X="\\s{0,1}\\/"}else{if(am==H){ac="\\s{0,1}\\-";ah=ac;X=ac}else{if(am==o){ac="\\)";ah=ac;X="\\s{0,1}\\)"}}}}}}ai=new RegExp("(.*\\.\\s+)(\\d+)("+ac+")(.*)$");while((Z=ai.exec(af))!=null){claim_no=parseInt(Z[2],10);if(claim_no>1000){af=Z[1]+"["+Z[2]+"]"+Z[3]+Z[4];continue}if(typeof ab[claim_no]!="undefined"){aa=true;aj.push(claim_no)}ab[claim_no]=""+claim_no+Z[3]+Z[4];af=Z[1];if(al<claim_no){al=claim_no}if(ad>claim_no){ad=claim_no}}v2="";ai=new RegExp("^(.*?)(\\d+)("+ac+")(\\s+.*)$");while((Z=ai.exec(af))!=null){claim_no=parseInt(Z[2],10);af=Z[1];v2=""+claim_no+Z[3]+Z[4]+v2;if((claim_no<ad)&&(claim_no>0)){ab[claim_no]=v2;v2="";ad=claim_no}if(al<claim_no){al=claim_no}}if(aa==true){var ag="Warning: the following claims/paragraphs have been found multiple times:\n";ag=ag+aj.pop();while(aj.length>0){ag=ag+", "+aj.pop()}alert(ag+".\nPlease check the text in the input window.")}ab[0]=af;if(typeof ab[1]=="undefined"){if((c=ab[0].indexOf("1 "))==0){ab[1]=ab[0];ab[0]=""}else{if((c=ab[0].indexOf(" 1 "))!==-1){ab[1]=ab[0].substring(c);ab[0]=ab[0].substring(0,c)}else{ai=new RegExp("^("+h.form_claim_reg_exp(1)+X+")(.*)");if((Z=ai.exec(ab[0]))!=null){ab[0]="";ab[1]=Z[1]+Z[2]}}}}if(al>1000){var Y=al;al=1000;while((al>0)&&(typeof(ab[al])=="undefined")){al--}alert("Something probably went wrong.\nHighest claim number detected: "+Y+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+al+".")}ae=0;for(c=1;c<=al+15;c++){if(typeof ab[c]=="undefined"){if(ab[ae].indexOf("."+c)!==-1){ai=new RegExp("(.*?\\.)("+c+ac+")(\\s+.*)");if((Z=ai.exec(ab[ae]))!=null){ab[ae]=Z[1];ab[c]=Z[2]+Z[3];ae=c;if(c>al){al=c}}}}else{ae=c}}ae=0;for(c=1;c<=al+3;c++){if(typeof ab[c]=="undefined"){if(ab[ae].indexOf(c)!==-1){ai=new RegExp("(.*?\\.\\s*)("+c+")(\\s+.*)");if((Z=ai.exec(ab[ae]))!=null){if((Z[1].length>=2)&&((Z[1].charAt(Z[1].length-2)>="0")&&(Z[1].charAt(Z[1].length-2)<="9"))){}else{ab[ae]=Z[1];ab[c]=Z[2]+Z[3];ae=c;if(c>al){al=c}}}}}else{ae=c}}ae=0;for(c=1;c<=al+3;c++){if(typeof ab[c]=="undefined"){ai=new RegExp(h.form_claim_reg_exp(c));if(ai.test(ab[ae])){ai=new RegExp("(.*?\\.\\s+)("+h.form_claim_reg_exp(c)+ah+")(.*)");if((Z=ai.exec(ab[ae]))!=null){ab[ae]=Z[1];ab[c]=Z[2]+Z[3];ae=c;if(c>al){al=c}}}}else{ae=c}}if(am==g){ae=0;for(c=1;c<=al+3;c++){if(typeof ab[c]=="undefined"){ai=new RegExp(h.form_claim_reg_exp(c));if(ai.test(ab[ae])){ai=new RegExp("(.*?\\s+)("+c+ac+"\\s{0,1})(\\D.*)");if((Z=ai.exec(ab[ae]))!=null){ab[ae]=Z[1];ab[c]=Z[2]+Z[3];ae=c;if(c>al){al=c}}}}else{ae=c}}}ae=0;for(c=1;c<=al+3;c++){if(typeof ab[c]=="undefined"){ai=new RegExp(h.form_claim_reg_exp(c));if(ai.test(ab[ae])){ai=new RegExp("(.*?\\s+)("+h.form_claim_reg_exp(c)+X+")(.*)");if((Z=ai.exec(ab[ae]))!=null){ab[ae]=Z[1];ab[c]=Z[2]+Z[3];ae=c;if(c>al){al=c}}}}else{ae=c}}for(c=1;c<=al;c++){if(typeof ab[c]!="undefined"){ab[c]=h.fix_unclosed_brackets(ab[c])}}ab.unshift(al);return ab};h.handle_double_paragraphs=function(ad){var af=/\[\d+\][^\S\t]+\[\d+\](.*)/;var Z=/(.*?)\t(\[\d+\])([ ]+)(\[\d+\])(.*)/;var X=/(.*?)(\[\d+\])(.*)/;var aa="";var Y="";if(ad==""){return ad}if(h.count_matches(ad,af)>=1){while((matches=Z.exec(ad))!=null){var ac=matches[1];var ae=matches[2];var ab=matches[4];ad=matches[5];while((matches=X.exec(ac))!=null){ac=matches[1]+matches[3];aa=aa+matches[2]}Y=Y+ac+"\t"+ab;aa=aa+ae}while((matches=X.exec(ad))!=null){ad=matches[1]+matches[3];aa=aa+matches[2]}Y=Y+ad;return Y}return ad};h.split_desc=function(ab){if(ab==""){return[0,ab]}else{var Y;var X=/\.\s*\[\d+\](.*)/;var aa=h.ocr_cleanup_desc(ab);if(h.count_matches(aa,X)>=2){aa=h.handle_double_paragraphs(aa);Y=h.handle_square_brackets_type_claims(aa)}else{Y=aa.split(/[\t]+/);while((Y.length>0)&&(Y[Y.length-1]=="")){Y.pop()}Y.unshift("");Y.unshift(Y.length-1)}for(var Z=1;Z<Y.length;Z++){if(typeof Y[Z]!="undefined"){Y[Z]=h.fix_unclosed_brackets(Y[Z])}}return Y}};h.calculate_score_for_word=function(X){if((X=="claim")||(X=="claims")||(X=="according")||(X=="characterised")||(X=="characterized")||(X=="Anspruch")||(X=="Ansprüche")||(X=="gekennzeichnet")||(X=="revendication")||(X=="revendications")||(X=="caractérisé")||(X=="caractérisée")){return 0}else{return X.length}};h.count_added=function(aa){var Y=0;var Z=0;var X;for(X=0;X<aa.length;X++){if(aa[X]==W){Z=1}else{if(aa[X]==q){Z=0}else{if(aa[X]==A){Z=2}else{if(aa[X]==V){Z=0}else{if(Z==1){Y=Y+h.calculate_score_for_word(aa[X])}}}}}}return Y};h.count_unchanged=function(aa){var Z=0;var Y=0;var X;for(X=0;X<aa.length;X++){if(aa[X]==W){Y=1}else{if(aa[X]==q){Y=0}else{if(aa[X]==A){Y=2}else{if(aa[X]==V){Y=0;Z=Z-1}else{if(Y==0){Z=Z+h.calculate_score_for_word(aa[X])}}}}}}if(Z>0){return Z}else{return 0}};h.is_short_word=function(Y){var Z=["the","a"," ","of","in","and","to","is","that","der","die","das","dem","des","den","im","und","le","la","dans","que","de"];for(var X=0;X<Z.length;X++){if(Y==Z[X]){return 1}}return 0};h.cross_out_deleted=function(Z){var Y=0;var aa=[];for(var X=0;X<Z.length;X++){if(Z[X]==A){Y=1}else{if(Z[X]==V){Y=0}else{if(Z[X]==W){Y=2}else{if(Z[X]==q){Y=0}else{if(Y==0){aa.push(Z[X])}else{if(Y==1){if(Z[X]==" "){aa.push(" ")}else{aa.push(Array(1+Z[X].length).join("-"))}}}}}}}}return aa};h.alert_array=function(X){var Y=X.join("-");alert(Y)};h.reset_feature_blocks=function(){f=[];D=[];G=[]};h.add_feature_for_claim=function(Y,Z,X){f.push(Y);D.push(Z);G.push(X)};h.find_feature_block_marker=function(aa,X){var Z=aa.indexOf(l,X);var Y=aa.indexOf(O,X);if((Z<0)&&(Y>=0)){return Y}if((Y<0)&&(Z>=0)){return Z}if(Z<Y){return Z}else{return Y}};h.find_feature_blocks=function(ab,ac){var Z=0;var X=0,aa=0,ae=0;while((Z=h.find_feature_block_marker(ac,Z))>=0){if(ac.substr(Z,2)==l){ae=ae+1}else{if(ac.substr(Z,2)==O){ae=ae-1}}if(ae>X){X=ae}if(ae<aa){aa=ae}Z=Z+2}if((X>1)||(aa<0)||(ae!=0)){alert("Unbalanced feature brackets [[ ... ]] found in claim "+ab+" -- ignoring all brackets");return ac}if((X==0)&&(aa==0)){return ac}var Y=/(.*)\[\[(.*?)\]\](.*)/;var ad=0;while((matches=Y.exec(ac))!=null){h.add_feature_for_claim(ab,ad,matches[2]);ac=matches[1]+" "+p+ad+b+" "+matches[3];ad=ad+1}ac=(ac.split("  ")).join(" ");return ac};h.replace_feature_markers=function(ab){var X=/(.*)\{\{\{(\d+)\}\}\}(.*)/;var Z;var Y;var aa=0;if(X.exec(ab.join(""))==null){return ab}alert("Found feature markers in: "+ab.join("+"));Y=[];for(loop=0;loop<ab.length;loop++){if(ab[loop]==W){aa=1}else{if(ab[loop]==q){aa=0}}if((Z=X.exec(ab[loop]))!=null){if(Z[1].length>0){Y.push(Z[1])}if(aa==1){Y.push(q);Y.push(W)}if(Z[2]<=f.length){atoms=G[Z[2]].split(" ");for(i=0;i<atoms.length;i++){Y.push(atoms[i]);if(i!=atoms.length){Y.push(" ")}}}if(aa==1){Y.push(q);Y.push(W)}if(Z[3].length>0){Y.push(Z[3])}}else{Y.push(ab[loop])}}return Y};h.collect_deleted_parts=function(ac){var ab=0;var ad,Z,ae,X=-1;var af;for(ad=ac.length-1;ad>=0;ad--){if(ac[ad]==V){X=ad}else{if(ac[ad]==A){for(Z=ad-1;Z>=0;Z--){if(h.is_short_word(ac[Z])){continue}else{if(ac[Z]==q){for(ae=Z-1;ae>=0;ae--){if(ac[ae]==W){break}}if((ae>=0)&&(X>0)){if(ad-Z>1){short_words=ac.splice(Z+1,ad-Z-1);Array.prototype.splice.apply(ac,[Z,0].concat(short_words));Z=Z+short_words.length;Array.prototype.splice.apply(ac,[ad+1,0].concat(short_words));X=X+short_words.length}var Y=Z-ae+1;added_block=ac.splice(ae,Y);ad=ad-Y;Z=ad;X=X-Y;Array.prototype.splice.apply(ac,[X+1,0].concat(added_block))}else{alert("Warning: this should not happen (E101)");return ac}}else{if(ac[Z]==V){if(Z==ad-1){for(start_other_del=Z-1;start_other_del>=0;start_other_del--){if(ac[start_other_del]==A){break}}if(start_other_del>=0){ac.splice(Z,2);ad=start_other_del;Z=ad;X=X-2}}else{break}}else{break}}}}}}}for(var aa=0;aa<ac.length-1;aa++){if(((ac[aa]==V)&&(ac[aa+1]==A))||((ac[aa]==q)&&(ac[aa+1]==W))){ac.splice(aa,2)}}return ac};h.remove_deleted=function(Z){var Y=0;var aa=[];for(var X=0;X<Z.length;X++){if(Z[X]==A){Y=1}else{if(Z[X]==V){Y=0}else{if(Y==0){aa.push(Z[X])}}}}return aa};h.remove_short_unchanged=function(Z){var aa=[];for(var Y=0;Y<Z.length;Y++){if(Z[Y]==W){for(var X=aa.length-1;X>=0;X--){if(!h.is_short_word(aa[X])||aa[X]==q){break}}if(X<0){aa.unshift(W);continue}else{if(aa[X]==q){aa.splice(X,1);continue}}}aa.push(Z[Y])}for(var X=aa.length-1;X>=0;X--){if(!h.is_short_word(aa[X])||aa[X]==q){break}}if((X>=0)&&(aa[X]==q)){aa.splice(X,1);aa.push(q)}return aa};h.remove_tags=function(X){X=(X.split(W)).join("");X=(X.split(q)).join("");X=(X.split(A)).join("");X=(X.split(V)).join("");return X};h.get_color_string=function(Y){var X=["yellow","cyan","lime","orange","lightskyblue","lightgreen","coral","gold","violet","silver","pink","lightsalmon","tomato"];max_color=12;if(Y==0){the_color=0}else{the_color=1+((Y-1)%max_color)}return'<span style="BACKGROUND-COLOR: '+X[the_color]+'">'};h.get_color_string_end=function(){return"</span>"};h.get_color_string_and_update_legend_for_claim=function(Y,X){var Z=new RegExp('BACKGROUND-COLOR: (\\w+)">'+Y+h.get_color_string_end());for(leg=1;leg<X.length;leg++){if(Z.exec(X[leg])!=null){break}}if(leg==X.length){X.push(" "+h.get_color_string(leg)+Y+h.get_color_string_end())}return h.get_color_string(leg)};h.make_single_added=function(Y){var X;var Z=[];for(X=0;X<Y.length;X++){if((Y[X]!=W)&&(Y[X]!=q)){Z.push(Y[X])}}if(Z.length>0){Z.unshift(W);Z.push(q)}while(Y.length>0){Y.pop()}while(Z.length>0){Y.push(Z.shift())}return};h.format_claim_span=function(ab,af){var X="";var ae=-1;var ag=-1;var ac=[];var ad=[];var Y=false;for(var aa=1;aa<=af;aa++){if(typeof ab[aa]!="undefined"){ac.push(aa)}else{Y=true}}if(ac.length==0){return"None"}for(var Z=0;Z<ac.length;Z++){if((ac[Z]-ag==1)){ag=ac[Z]}else{if(ae>0){if((ag-ae)>=2){X=X+ae+"-"+ag+","}else{if((ag-ae)==1){X=X+ae+","+ag+","}else{X=X+ae+","}}}ae=ac[Z];ag=ac[Z]}}if((ag-ae)>=2){X=X+ae+"-"+ag}else{if((ag-ae)==1){X=X+ae+","+ag}else{X=X+ae}}if(Y){X=X+" (Warning: irregularly numbered set, please check input)"}return X};h.split_into_added_unchanged_added=function(af,ab,al,aj){var ah,ag;var ac,Y;var ai,aa,ak;var X,ae,Z;var ad;ak=0;ai=0;aa=0;Z=0;X=0;ae=0;Y=0;ac=0;for(ah=0;ah<af.length;ah++){if(af[ah]==W){ad=true;ac=ah;Y=0}else{if(af[ah]==q){if(Y>M){ae=ac-1;if(Z>ak){ai=X;aa=ae;ak=Z}X=ah+1;ae=ah+1;Z=0}else{ae=ah}ad=false}else{if(ad){Y=Y+af[ah].length}else{Z=Z+af[ah].length;ae=ah}}}}if(Z>ak){ai=X;aa=ae;ak=Z}for(ah=0;ah<ai;ah++){ab.push(af[ah])}for(ah=ai;ah<=aa;ah++){al.push(af[ah])}for(ah=aa+1;ah<af.length;ah++){aj.push(af[ah])}h.make_single_added(ab);h.make_single_added(aj);return};h.recode_added_parts=function(ad,af,X,Y){var ag,ae,ah,al,ap;var aa,ai;var ao,aj;var Z;ag=ae=ah=al=aa=ai=[];aj=0;k++;if(n==true){Z="|"}else{Z=""}for(ao=0;ao<X.length;ao++){if(X[ao]==W){aj=1;ae=[];if(k==1){al.push(X[ao])}continue}else{if(X[ao]==q){aj=2;coded_yet=0;if(h.count_added([W].concat(ae,q))>M){max_score=0;ap=0;var am,ac;for(var ak=1;ak<=af;ak++){if(typeof ad[ak]=="undefined"){continue}am=h.fdiff3(ad[ak],ae.join(""));am=h.remove_deleted(am);if((diff_score=h.count_unchanged(am))>max_score){ap=ak;max_score=diff_score}}if(max_score>M){var ab,aq,an;am=h.fdiff3(ad[ap],ae.join(""));am=h.remove_deleted(am);ab=[];aq=[];an=[];h.split_into_added_unchanged_added(am,ab,aq,an);aa=h.recode_added_parts(ad,af,ab,Y);al=al.concat(aa);al.push("<SPAN>"+Z);if(n){al.push(h.get_color_string_and_update_legend_for_claim(ap,Y))}else{al.push(h.get_color_string(Y.length));Y.push(" "+h.get_color_string(Y.length)+ap+h.get_color_string_end())}mode2=0;for(d2=0;d2<aq.length;d2++){if(aq[d2]==A){mode2=1;alert("This should not happen. Code 1.")}else{if(aq[d2]==V){mode2=0;alert("This should not happen. Code 2.")}else{if(aq[d2]==W){al.push(h.get_color_string(0))}else{if(aq[d2]==q){al.push(h.get_color_string_end())}else{if(mode2==0){al.push(aq[d2])}}}}}}al.push(h.get_color_string_end());ac=h.fdiff3(ad[ap],h.remove_tags(aq.join("")));al.push(Z+'</SPAN><SPAN class="tooltip">'+ac.join("")+"</SPAN>");ai=h.recode_added_parts(ad,af,an,Y);al=al.concat(ai);coded_yet=1}}if(!coded_yet){al.push(h.get_color_string(0));al=al.concat(ae);al.push(h.get_color_string_end())}if(k==1){al.push(q)}}}if(aj==0){al.push(X[ao])}else{if(aj==1){ae.push(X[ao])}else{if(aj==2){aj=0}}}}k--;return al};h.get_main_base_claim=function(Y){for(var Z=0;Z<r.length;Z++){if(r[Z]==Y){var X=/^(\d+)/;var aa;if((aa=X.exec(x[Z]))!=null){var ab=parseInt(aa[1]);if(ab<0){alert('Base value "'+base+'"out of bounds');return -1}else{return ab}}}}return -1};h.get_claim_base_exclusions=function(ak,ap,ad,ac){var af=0;var aa;var Y=false;if(ac==false){ad=0;aa=x}else{aa=x.slice(0)}for(var ae=0;ae<r.length;ae++){if(r[ae]==ak){if((aa[ae].search("!")>=0)&&(aa[ae].search("&")>=0)){alert("Error in base override for claim "+ak+"\nCan't both include (&) and exclude (!) claims");return[]}var aj=/(.*)\[(\d+)\](.*)/;var Z;while((Z=aj.exec(aa[ae]))!=null){if((Math.round(Z[2])<=ad)&&(Math.round(Z[2])!=0)){aa[ae]=Z[1]+(ap+parseInt(Z[2]))+Z[3];Y=true}else{if(ac==true){alert("Error in base override for claim "+ak+"\nInvalid paragraph number ["+Z[2]+"] encountered.")}else{if(aa[ae].search("&")>=0){alert("Error in base override for claim "+ak+":\nuse of description not selected.")}}aa[ae]=Z[1]+Z[3]}}var al=aa[ae].split(/[0-9!&\-\,]+/);if((al=al.join(""))!==""){alert("Error in base override for claim "+ak+"\nInvalid character(s) "+al+' encountered.\n\nValid examples: "5!8,9,12-15,38-40" or "&8,9,12-15,38-40"');return[]}var an=aa[ae];var X=/(.*?)(\d+)\-(\d+)(.*)/;var Z,ab,ai;while((Z=X.exec(an))!=null){ab=parseInt(Z[2]);ai=parseInt(Z[3]);if(ab>=ai){alert("Invalid base override range ("+Z[2]+"-"+Z[3]+") for claim "+ak+".");return[]}an=""+Z[1]+Z[2];for(var ao=ab+1;ao<=ai;ao++){an=an+","+ao}an=an+Z[4]}an=an.split(/[!&,]/);an.shift();if(aa[ae].search("!")>=0){return an}else{if(aa[ae].search("&")>=0){if((Y==false)&&(ac==true)){ad=0}var am=[];for(var ah=1;ah<=ap+ad;ah++){for(var ag=0;ag<an.length;ag++){if(an[ag]==ah){break}}if(ag==an.length){am.push(ah)}}return am}}break}}return[]};h.get_base_text_for_claim=function(X){for(var Y=0;Y<r.length;Y++){if(r[Y]==X){return x[Y]}}return""};h.insert_in_score_list=function(Y,X,Z){Y.push(X);Y.push(Z);for(var aa=(Y.length/2)-2;aa>=0;aa--){if(Z<=Y[aa*2+1]){break}Y[(aa+1)*2]=Y[aa*2];Y[(aa+1)*2+1]=Y[aa*2+1];Y[aa*2]=X;Y[aa*2+1]=Z}return};h.show_dependency_table=function(Z,ac){var Y="<B>Claim dependency table:</B><BR>";var X;for(var aa=1;aa<=ac;aa++){if(typeof(Z[aa])=="undefined"){continue}X="    "+aa+": ";Y=Y+X.substr(-5);for(var ab=1;ab<=aa;ab++){if(aa==ab){Y=Y+"x "}else{if(typeof(Z[aa][ab])=="undefined"){Y=Y+"- "}else{Y=Y+Z[aa][ab]+" "}}}Y=Y+"<BR>"}return Y};h.format_claim_tree_recursive=function(ag,ac,af,Z,Y,ad){if(typeof(ag[ac])=="undefined"){return Y}if(Y.indexOf("-"+ac+"-")>=0){return Y}var ae="";if(typeof(ad)!="undefined"){if(typeof(ad[ac])!="undefined"){ae="<SUP>("+ad[ac]+")</SUP>"}}for(var aa=1;aa<Z;aa++){Y=Y+"| "}if(Z>0){Y=Y+"+ "}else{if(Z==0){Y=Y+"<BR>"}}if(Z==0){Y=Y+"<BR>-<B>"+ac+"</B>-"+ae+"<BR>"}else{Y=Y+"-"+ac+"-"+ae+"<BR>"}for(var ab=ac+1;ab<=af;ab++){if(Y.indexOf("-"+ab+"-")>=0){continue}else{if(typeof(ag[ab])=="undefined"){continue}else{if(ag[ab][ac]==1){for(var X=ac-1;X>0;X--){if(ag[ab][X]==1){break}}if(X==0){if(typeof(ad)!="undefined"){if(typeof(ad[ab])!="undefined"){if(typeof(ad[ac])!="undefined"){ad[ab]=ad[ab]+";"+ad[ac]}}}Y=h.format_claim_tree_recursive(ag,ab,af,Z+1,Y,ad)}}}}}return Y};h.format_claim_tree=function(X,ao,ac){var ad="";for(var ah=1;ah<=ao;ah++){ad=h.format_claim_tree_recursive(X,ah,ao,0,ad,ac)}var ag=ad.split("<BR>");while((ag.length>0)&&(ag[0]=="")){ag.shift()}for(var ah=1;ah<ag.length;ah++){ag[ah]=ag[ah].split(" ")}for(var ai=0;ai<ao;ai++){last="";for(var ah=ag.length-1;ah>=1;ah--){if(typeof(ag[ah][ai])=="undefined"){last="";continue}else{if(ag[ah][ai]=="|"){if(last==""){ag[ah][ai]=" "}}else{if(ag[ah][ai]=="+"){last="+"}else{last=""}}}}}for(var ah=1;ah<ag.length;ah++){ag[ah]=ag[ah].join(" ")}ad=ag.join("<BR>");ad=ad.split("-");ad=ad.join("");ad=ad.split("+ ");ad=ad.join("+-");var al=/(.*)<SUP>\((.*?)\)<\/SUP>(.*)/;var af=/(.*?)\;(.*)/;var ae=/(\d+)/;var aa,an;while((aa=al.exec(ad))!=null){if((an=af.exec(aa[2]))!=null){base_and_support=an[1].split(",")}else{base_and_support=aa[2].split(",")}base_and_support[0]="<b><u>"+base_and_support[0]+"</u></b>";for(var aj=1;aj<base_and_support.length;aj++){base_and_support[aj]="<b>"+base_and_support[aj]+"</b>"}if(an!=null){aa[2]=base_and_support.join(",")+","+an[2]}else{aa[2]=base_and_support.join(",")}aa[2]=aa[2].split(";");aa[2]=aa[2].join(",");var Y=[];var ab=[];var am;var Z=aa[2].split(",");for(var ak=0;ak<Z.length;ak++){if((am=ae.exec(Z[ak]))!=null){value=Math.round(am[1]);for(var aj=0;aj<Y.length;aj++){if(Y[aj]>=value){break}}if((aj==Y.length)||(Y[aj]!=value)){Y.splice(aj,0,value);ab.splice(aj,0,Z[ak])}}}aa[2]=ab.join(",");ad=aa[1]+"<sup>("+aa[2]+")</sup>"+aa[3]}return ad};h.remove_claim_tree_deps=function(X){var Y=/(.*)\((.*?)\)(.*)/;var aa;while((aa=Y.exec(X))!=null){var ab=[];legend=aa[2].split(/,/);for(var Z=0;Z<legend.length;Z++){if(legend[Z].indexOf("<b>")>=0){ab.push(legend[Z])}}X=aa[1]+"{"+ab.join(",")+"}"+aa[3]}X=X.split(/\{/);X=X.join("(");X=X.split(/\}/);X=X.join(")");return X};h.remove_claim_tree_deps_and_support=function(X){var Y=/(.*)<sup>\((.*?)\)<\/sup>(.*)/;var Z;while((Z=Y.exec(X))!=null){X=Z[1]+Z[3]}return X};h.do_claim_tree_analysis=function(ag,Y,an,ad){var ak=/(\w+)(\s+)([C,c]laim)([s]*)(and|or|\s|\,|\-|\d)+(\w+)/;var ah=" to - zu bis à ";var ai=" or , and oder ou ";var ac;var al=[];var am=[];var X="";var af=0;var aj;am=new Array(Y+1);for(var ab=1;ab<=Y;ab++){if(typeof(ag[ab])=="undefined"){continue}aj=false;am[ab]=new Array(ab);for(var aa=0;aa<ab;aa++){am[ab][aa]=0}words=h.split_punctuation(ag[ab]);for(w1=2;w1<words.length;w1++){var ae=words[w1].toLowerCase();if(((ae.indexOf("claim")>=0)&&(ae.indexOf("claimed")<0))||(ae.indexOf("anspruch")>=0)||(ae.indexOf("ansprüche")>=0)||(ae.indexOf("revendication")>=0)){w1++;break}}var Z=false;af=-1;for(;w1<words.length;w1++){if(words[w1].charAt(0)==" "){continue}the_number=parseInt(words[w1],10);if(the_number>0){if(the_number==ab){alert(an+ab+" refers back to itself")}else{if(the_number>ab){alert(an+ab+" refers back to a higher claim")}else{am[ab][the_number]=1;if(Z==false){af=the_number}else{to_number=the_number;if(to_number<=af){alert(an+ab+" has a malformed dependency range ("+af+" to "+to_number+")")}else{for(d1=af+1;d1<=to_number;d1++){am[ab][d1]=1}}Z=false}}}aj=true}else{if((af>0)&&(ah.indexOf(words[w1])>=0)){Z=true}else{if(ai.indexOf(words[w1])<0){break}}}}if(aj==false){lower_claim=ag[ab].toLowerCase();lower_claim=lower_claim.replace(/\s+/g," ");lower_claim=lower_claim.replace(/voranstehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorangehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorhergehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgenannt/g,"vorstehend");lower_claim=lower_claim.replace(/vorangegangen/g,"vorstehend");lower_claim=lower_claim.replace(/vorherig/g,"vorstehend");lower_claim=lower_claim.replace(/bisherig/g,"vorstehend");if((lower_claim.indexOf("preceding claims")>=0)||(lower_claim.indexOf("previous claims")>=0)||(lower_claim.indexOf("above claims")>=0)||(lower_claim.indexOf("foregoing claims")>=0)||(lower_claim.indexOf("revendications pr")>=0)||(lower_claim.indexOf("den vorstehenden anspr")>=0)){for(d1=1;d1<ab;d1++){am[ab][d1]=1}}else{if((lower_claim.indexOf("the preceding claim")>=0)||(lower_claim.indexOf("the previous claim")>=0)||(lower_claim.indexOf("the above claim")>=0)||(lower_claim.indexOf("the foregoing claim")>=0)||(lower_claim.indexOf("la revendication pr")>=0)||(lower_claim.indexOf("dem vorstehenden anspr")>=0)){am[ab][ab-1]=1}else{if((lower_claim.indexOf("preceding claim")>=0)||(lower_claim.indexOf("previous claim")>=0)||(lower_claim.indexOf("above claim")>=0)||(lower_claim.indexOf("foregoing claim")>=0)||(lower_claim.indexOf("revendication pr")>=0)||(lower_claim.indexOf("vorstehenden anspr")>=0)){for(d1=1;d1<ab;d1++){am[ab][d1]=1}}else{if((lower_claim.indexOf("claim")>=0)||(lower_claim.indexOf("revendication")>=0)||(lower_claim.indexOf("anspr")>=0)){if(lower_claim.indexOf("claim sets")<0){alert(an+ab+"'s dependency not understood, treating as independent.")}}}}}}}X="<PRE>"+h.format_claim_tree(am,Y,ad)+"</PRE>";return X};h.insert_line_breaks=function(Y,ad){if((S==false)&&(L==false)){Y=Y.split(/\t/);Y=Y.join("<BR>\n");return Y}if(S==true){Y=Y.split("&#59;");Y=Y.join("&#59;<BR>");Y=Y.split("&#58;");Y=Y.join("&#58;<BR>")}if(L==true){Y=Y.split(",");Y=Y.join(",<BR>")}var ac;var ae="OPEN_BRACKET_FOO_FOO_FOO";var Z="CLOSE_BRACKET_FOO_FOO_FOO";var ab=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((ac=ab.exec(Y))!=null){var X=ac[2].split("<BR>");X=X.join("");Y=ac[1]+ae+X+Z+ac[3]}Y=Y.split(ae);Y=Y.join("(");Y=Y.split(Z);Y=Y.join(")");Y=Y.split("<BR> <BR>");Y=Y.join("<BR>");Y=Y.split("<BR><BR>");Y=Y.join("<BR>");Y=Y.split("<BR><BR>");Y=Y.join("<BR>");Y=Y.split(" <BR>");Y=Y.join("<BR>");Y=Y.split("<BR>");Y=Y.join("<BR>&nbsp;&nbsp;&nbsp;");if(ad){Y=Y.replace(/\d+\./g,function aa(af){return"<BR><BR>"+af})}return Y};h.post_cleanup=function(Z,ac){if(F==true){deleted_parts=Z.split(A);if(deleted_parts.length>0){var ab,Y,X;Y=new RegExp(A+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+V+W+h.get_color_string(0)+"([A-Za-zÀ-ÿ]+)"+h.get_color_string_end()+q+"([\\S\\s]*)");X=new RegExp(A+"([A-Za-zÀ-ÿ]+)"+V+W+h.get_color_string(0)+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+h.get_color_string_end()+q+"([\\S\\s]*)");Z=deleted_parts[0];for(var aa=1;aa<deleted_parts.length;aa++){deleted_parts[aa]=A+deleted_parts[aa];if((ab=Y.exec(deleted_parts[aa]))!=null){if(ab[4]===(ab[1]+ab[3])){deleted_parts[aa]=ab[1]+ab[2]+ab[3]+ab[5]}}if((ab=X.exec(deleted_parts[aa]))!=null){if(ab[1]===(ab[2]+ab[4])){deleted_parts[aa]=ab[2]+ab[3]+ab[4]+ab[5]}}Z=Z+deleted_parts[aa]}}}if(ac==false){if(y==true){highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+A}else{highlight_and_rem_start='<span style="BACKGROUND-COLOR: LightGrey">'+A}highlight_and_rem_end=V+h.get_color_string_end();Z=(Z.split(A)).join(highlight_and_rem_start);Z=(Z.split(V)).join(highlight_and_rem_end)}if((ac==true)&&(v==true)){highlight_and_add_start=h.get_color_string(0)+W;highlight_and_rem_start='<span style="BACKGROUND-COLOR: OrangeRed">'+A;highlight_and_add_end=q+h.get_color_string_end();highlight_and_rem_end=V+h.get_color_string_end();Z=(Z.split(W)).join(highlight_and_add_start);Z=(Z.split(A)).join(highlight_and_rem_start);Z=(Z.split(q)).join(highlight_and_add_end);Z=(Z.split(V)).join(highlight_and_rem_end)}Z=h.insert_line_breaks(Z,ac);return Z};h.split_and_diff=function(aK,aJ,aH){var aB,az,ad;var aq,ap,ag;var aI,ae;var ak;var ar;var Y;var au,af;var am="";var aF,aD,aC;var ai;var aG=aK;var aE=aJ;var an="text";var ao=[];var at=/\[\d+\]/;if(aH=="DESCMAGICFOO"){an="para";aB=h.split_desc(aK);az=h.split_desc(aJ);aq=aB.shift();ap=az.shift();if(aq<1){return"No original description paragraph(s) detected -- doing whole text comparison <HR>\n"+h.diff(aG,aE)}aH=""}else{an="claim";aK=h.ocr_cleanup(aK);aJ=h.ocr_cleanup(aJ);aB=h.split_claims(aK);az=h.split_claims(aJ);aq=aB.shift();ap=az.shift();if(aq<1){return"No original claim number(s) detected -- doing whole text comparison <HR>\n"+h.diff(aG,aE)}if(z.length>0){aI=h.split_desc(aH);ae=aI.shift()}else{aI=[];ae=0}}am=am+"<TABLE class='fdiff4' BORDER=1><TR class='fdiff4'><TH class='fdiff4'>New<BR>"+an+"</TH><TH class='fdiff4'>Old<BR>"+an+"</TH><TH class='fdiff4 noprint'>Base<BR>override</TH>";if(an=="claim"){am=am+"<TH class='fdiff4 noprint'>Use<BR>desc</TH>"}am=am+"<TH class='fdiff4'><DIV contenteditable>"+B+"</DIV></TH></TR>\n";if((typeof az[0]!="undefined")&&(az[0]!="")){am=am+"<TR class='fdiff4'><TD class='fdiff4'></TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD>";if(an=="claim"){am=am+"<TD class='fdiff noprint'>&nbsp;</TD>"}am=am+"<TD class='fdiff4'>"+az[0]+"</TD></TR>\n"}h.reset_feature_blocks();for(c2=1;c2<=ap;c2++){first_absent=c2;while((c2<ap)&&((typeof az[c2]=="undefined")||(az[c2]==""))){c2++}if(c2>first_absent){am=am+"<TR class='fdiff4'><TD class='fdiff4'>"+first_absent;if(c2>(first_absent+1)){am=am+"-"+(c2-1)}am=am+"</TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD><TD class='fdiff4'></TD></TR>\n"}ai=M;score_list=[];best_claim=-1;au=false;if((best_claim=h.get_main_base_claim(c2))>=0){if((best_claim>0)&&(typeof aB[best_claim]=="undefined")){alert("Base "+an+" "+best_claim+" for "+an+" "+c2+" not found in original "+an+"s!");best_claim=-1}else{au=true}}af=false;for(var Y=0;Y<z.length;Y++){if(z[Y]==c2){af=true;break}}if(af==false){for(var ax=0;ax<r.length;ax++){if(r[ax]==c2){if(x[ax].search(at)>=0){af=true;if(ae==0&&aH!=""){aI=h.split_desc(aH);ae=aI.shift()}}}}}az[c2]=h.find_feature_blocks(c2,az[c2]);if(best_claim<0){for(var ac=1;ac<=aq;ac++){if(typeof aB[ac]=="undefined"){continue}ak=h.fdiff3(aB[ac],az[c2]);diff_score=h.count_unchanged(ak);if(diff_score>ai){best_claim=ac;ai=diff_score}h.insert_in_score_list(score_list,ac,diff_score)}}ad=aB.slice();var ab=h.get_claim_base_exclusions(c2,aq,ae,af);ag=aq;if((ae>0)&&(af==true)){for(var Y=1;Y<=ae;Y++){ad[aq+Y]=aI[Y]}ag=aq+ae}for(var Z=0;Z<ab.length;Z++){ac=ab[Z];if((ac>0)&&(ac<=ag)){ad[ac]=undefined;au=true}else{if(ac==0){for(ac=0;ac<=ag;ac++){ad[ac]=undefined}au=true}}}if(best_claim>0){ar=[best_claim];ak=h.fdiff3(aB[best_claim],az[c2])}else{ar=["N/A"];ak=h.fdiff3("",az[c2])}ak=h.replace_feature_markers(ak);ak=h.collect_deleted_parts(ak);ak=h.recode_added_parts(ad,ag,ak,ar);am=am+"<TR class='fdiff4'><TD class='fdiff4'>"+c2+"</TD><TD class='fdiff4'>";if(best_claim>0){am=am+"<SPAN>"+ar[0]+'</SPAN><SPAN class="tooltip">'+aB[best_claim]+"</SPAN>"}else{am=am+ar[0]}claim_tree_legend=""+ar[0];for(Y=1;Y<ar.length;Y++){var al=/([\S\s]+>)(\d+)(<[\s\S]+)/;var X,aj;var ah=ar[Y];if((X=al.exec(ar[Y]))!=null){aj=parseInt(X[2]);if(aj>aq){desc_para=aj-aq;ah="<SPAN>"+X[1]+"["+desc_para+"]"+X[3]+'</SPAN><SPAN class="tooltip">'+ad[aj]+"</SPAN>";claim_tree_legend_text=",["+desc_para+"]"}else{ah="<SPAN>"+ar[Y]+'</SPAN><SPAN class="tooltip">'+aB[aj]+"</SPAN>";claim_tree_legend_text=","+aj}if((aj!=ar[0])&&(claim_tree_legend.indexOf(claim_tree_legend_text)<0)){claim_tree_legend=claim_tree_legend+claim_tree_legend_text}}am=am+ah}ao[c2]=claim_tree_legend;am=am+"</TD><TD class='fdiff4 noprint' align='center'>";if(au==true){am=am+'<INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'" value="'+h.get_base_text_for_claim(c2)+'">'}else{am=am+' <INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'">'}loop_end=score_list.length/2;if(loop_end>3){loop_end=3}for(Y=1;Y<loop_end;Y++){am=am+'<BR><span style="font-size:smaller">'+score_list[Y*2]+"="+Math.round((score_list[Y*2+1]*100)/score_list[1])+"% </span>"}if(an=="claim"){am=am+"</TD><TD class='fdiff4 noprint' align='center'>";if(af==true){am=am+'<INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'" checked>'}else{am=am+' <INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'">'}}am=am+"</TD><TD class='fdiff4'><DIV contenteditable>";var aa="";for(Y=0;Y<ak.length;Y++){aa=aa+ak[Y]}am=am+h.post_cleanup(aa,0)+"</DIV></TD></TR>\n"}am=am+"</TABLE>\n";aF=h.format_claim_span(aB,aq);aD=h.format_claim_span(az,ap);am=am+"<p>Original "+an+"s detected: "+aF+"<br>Amended "+an+"s detected: "+aD;if((J==true)&&((aF.search("Warn")>-1)||(aD.search("Warn")>-1))){alert("At least one of the detected "+an+" sets has irregular numbering.\nPlease verify that all "+an+" are properly identified and edit the text if necessary.\n\nYou can turn this message off by de-selecting the option below.")}if(an=="claim"){if(z.length>0){aC=h.format_claim_span(aI,ae);am=am+"<br>Original description paragraphs detected: "+aC}else{am=am+"<br>(Description not analyzed)"}if(t==true){var aA=h.do_claim_tree_analysis(aB,aq,"Original claim ");var ay=h.do_claim_tree_analysis(az,ap,"Amended claim ",ao);var aw=h.remove_claim_tree_deps(ay);var av=h.remove_claim_tree_deps_and_support(ay);am=am+"<BR><TABLE class='fdiff4' cellpadding='10' border=1><TR class='fdiff4'><TH class='fdiff4' colspan='4'>Claim trees</TH></TR><TR class='fdiff4'><TH class='fdiff4'> Original </TH><TH class='fdiff4'> Amended </TH><TH class='fdiff4'> Amended (+supt)</TH><TH class='fdiff4'> Amended (+supt +deps)</TH></TR><TR class='fdiff4'><TD valign='top'>";am+=aA;am+="</TD><TD valign='top'>";am+=av;am+="</TD><TD valign='top'>";am+=aw;am+="</TD><TD valign='top'>";am+=ay;am+="<BR><BR>&nbsp;&nbsp;<U>Legend:</U><BR>&nbsp;&nbsp;<SUP>(<B><U>2</U></B>)</SUP> base claim<BR>&nbsp;&nbsp;<SUP>(<B>3</B>)</SUP> support claim<BR>&nbsp;&nbsp;<SUP>(4)</SUP> inherited from parent";am=am+"</TD></TR></TABLE>"}}return am};h.diff=function(ae,ad){var ac;var X;var Z,Y;var ab,aa;ae=h.ocr_cleanup(ae);ad=h.ocr_cleanup(ad);ac=h.fdiff3(ae,ad);output="";for(X=0;X<ac.length;X++){output=output+ac[X]}output=h.post_cleanup(output,1);return output};h.insert_new_lines=function(Z){var aa="fj1423lkfnsfdsghdh32342";var Y=new RegExp("^([\\s\\S]*\\.)[ \\t]+([\\s\\S]*)");var X=new RegExp("^([\\s\\S]*\\d+\\.)$");while((matches=Y.exec(Z))!=null){if(X.test(matches[1])){Z=matches[1]+aa+matches[2]}else{Z=matches[1]+"\n\n"+matches[2]}}Z=Z.split(aa);Z=Z.join(" ");return Z};h.set_basis_threshold=function(X){if((X>=5)&&(X<=50)){M=X;return"OK"}else{return"Value out of bounds"}};h.set_fdiff3_highlights=function(X){if(X=="checked"){v=true}else{v=false}return"OK"};h.set_fdiff4_strikeout_highlights=function(X){if(X=="checked"){y=true}else{y=false}return"OK"};h.set_fdiff4_warn_claims=function(X){if(X=="checked"){J=true}else{J=false}return"OK"};h.set_fdiff4_simplify_legend=function(X){if(X=="checked"){n=true}else{n=false}return"OK"};h.set_fdiff4_tree_analysis=function(X){if(X=="checked"){t=true}else{t=false}return"OK"};h.set_convert_claim_styles=function(X){if(X=="checked"){U=true}else{U=false}return"OK"};h.set_ignore_hyphenation=function(X){if(X=="checked"){N=true}else{N=false}return"OK"};h.set_eszett_normalization=function(X){if(X=="checked"){I=true}else{I=false}return"OK"};h.set_ignore_case=function(X){if(X=="checked"){a=true}else{a=false}return"OK"};h.set_ignore_spaces=function(X){if(X=="checked"){K=true}else{K=false}return"OK"};h.set_ignore_in_brackets=function(X){if(X=="checked"){j=true}else{j=false}return"OK"};h.set_fix_glued_words=function(X){if(X=="checked"){F=true}else{F=false}return"OK"};h.set_insert_line_breaks_indents=function(X){if(X=="checked"){S=true}else{S=false}return"OK"};h.set_insert_line_breaks_indents2=function(X){if(X=="checked"){L=true}else{L=false}return"OK"};h.clear_claim_base_overrides=function(){r=[];x=[];return"OK"};h.set_claim_base_override=function(X,Z){var Y=parseInt(X);if(Y<1){alert('Claim value "'+X+'" out of bounds in claim base override!');return"Error"}Z=Z.split(/\s+/);Z=Z.join("");r.push(Y);x.push(Z);return"OK"};h.clear_use_desc_overrides=function(){z=[];return"OK"};h.set_use_desc_override=function(X){var Y=parseInt(X);if(Y<1){alert('Claim value "'+X+'" out of bounds in use description override!');return"Error"}z.push(Y);return"OK"};h.get_version=function(){return s};h.set_title=function(X){B=X;return"OK"};h.regenerate_title=function(){if(Q!=""){B="'"+u+"' vs. '"+C+"'"}else{B="Difference"}return"OK"};h.set_header_orig=function(X){C=X;h.regenerate_title();return"OK"};h.set_header_new=function(X){u=X;h.regenerate_title();return"OK"};h.set_dossier_number=function(X){Q=X;h.regenerate_title();return"OK"};h.filter_table_contents=function(ab){var ag=/([\s\S]*?)<span class="tooltip">([\s\S]*?)<\/span>([\s\S]*)/;var Z=/([\s\S]*?)<\/span>([\s\S]*)/;var Y=/([\s\S]*?)<div contenteditable="">([\s\S]*?)<\/div>([\s\S]*)/;var X=/<table([\s\S]*)/;var aa,ae;ab=(ab.split(/ style="cursor: default;"/)).join("");ab=(ab.split(/ style="cursor: default; /)).join(' style="');var ah=ab.split(/<\/table>/);if(ah.length<1){return ab}var ai=ah[0].split(/<tr/);for(row=1;row<ai.length;row++){var ad;if(row==1){ad=ai[row].split(/<th/)}else{ad=ai[row].split(/<td/)}if(ad.length>=5){ad[3]=ad.pop();if(ad.length==5){ad.pop()}if(row==1){ai[row]=ad.join("<th")}else{ai[row]=ad.join("<td")}}while((aa=ag.exec(ai[row]))!=null){var ac=(aa[2].match(/\<span/g)||[]).length;var af=(aa[2].match(/\<\/span/g)||[]).length;while(ac!=af){if((ae=Z.exec(aa[3]))!=null){aa[2]=aa[2]+"</span>"+ae[1];aa[3]=ae[2];ac=(aa[2].match(/\<span/g)||[]).length;af=(aa[2].match(/\<\/span/g)||[]).length}else{ac=af}}ai[row]=aa[1]+aa[3]}while((aa=Y.exec(ai[row]))!=null){ai[row]=aa[1]+aa[2]+aa[3]}}ah[0]=ai.join("<tr");ab=ah.join("</table>");return ab};h.filter_table_colours=function(Y){var X=/([\s\S]*)<span style=\"background([\s\S]*?)>([\s\S]*?)<\/span>([\s\S]*)/;var aa;var Z=Y.split(/<tr/);for(row=1;row<Z.length;row++){while((aa=X.exec(Z[row]))!=null){Z[row]=aa[1]+aa[3]+aa[4]}}Y=Z.join("<tr");return Y};return h}());