var fdiff=(function(){var h={};var u="4.89";var ad="<u>";var s="</u>";var E="<s>";var ac="</s>";var l="[[";var U="]]";var r="{{{";var b="}}}";var k=0;var m=0;var g=1;var d=2;var aa=3;var V=4;var M=5;var p=6;var y=7;var e=1;var X=7;var S=15;var x=true;var B=true;var O=true;var o=true;var v=false;var Y=false;var T=false;var N=false;var a=false;var P=false;var j=false;var ab=true;var J=true;var I=false;var Z=false;var Q=false;var t=[];var A=[];var C=[];var f=[];var H=[];var L=[];var F="Difference";var G="";var w="";var W="";var z="";h.one_time_alert=function(ae){if(z==""){alert(ae+"\n\nFurther pop-ups of this type are suppressed,\nsee bottom of claim comparison output.");z="<br><b>The following errors were encountered:</b><BR>"}z=z+ae+"<BR>"};h.one_time_alert_get_log=function(){var ae=z;z="";return ae};h.fix_unclosed_brackets=function(ak){var ag;var aj,ae;var ai="";var af="",ah="";ag=ak.toString().split("");for(ae=0;ae<ag.length;ae++){aj=ag[ae];if(ai!==""){ai=ai+aj;if(aj===")"){if(j==false){af=af+ai}ai=""}}else{if(aj==="("){ai=aj;if(ah!==""){af=af+ah;ah=""}}else{ah=ah+aj}}}if(ai!==""){return af+"{"+ai.substr(1)}return af+ah};h.handle_reference_signs=function(ag){if(j==true){var af;var ae=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((af=ae.exec(ag))!=null){ag=af[1]+af[3]}}return h.fix_unclosed_brackets(ag)};h.LCSubStr2=function(ao,al,ah,af){var ag,ae,aq,ap;var ak=new Array(-1,-1,-1,-1);var an=[];var am=0;var aj,ai;for(aq=0;aq<ah.length;aq++){ag=ah[aq];an[aq]=[];for(ap=0;ap<af.length;ap++){ae=af[ap];if(ao[ag]===al[ae]){if((aq===0)||(ap===0)){an[aq][ap]=1}else{an[aq][ap]=an[aq-1][ap-1]+1}if(an[aq][ap]>am){am=an[aq][ap];ak[0]=ah[aq-am+1];ak[1]=ah[aq];ak[2]=af[ap-am+1];ak[3]=af[ap]}}else{an[aq][ap]=0}}}return ak};h.recurse=function(aw,av,ak,aH){var ap,aB,ao,aA,az,ay;var aj=[];var aE=[];var an=[];var aI=[];var au=[];var ai=[];var al;var ag,af,aq,ax;var at,ah,aC,am;var aJ,aG;var aD=/\s/;if(aw.length<=0){if(av.length>=1){return[ad].concat(av,s)}else{return[""]}}else{if(av.length<=0){return[E].concat(aw,ac)}}if(a){var aF=[],ae=[];for(var ar=0;ar<aw.length;ar++){aF.push(aw[ar].toUpperCase())}for(var ar=0;ar<av.length;ar++){ae.push(av[ar].toUpperCase())}al=h.LCSubStr2(aF,ae,ak,aH)}else{al=h.LCSubStr2(aw,av,ak,aH)}ag=al[0];af=al[1];aq=al[2];ax=al[3];if(ag<0){at=[];while((aw.length>0)&&(av.length>0)&&(aw[0]===av[0])){at.push(aw.shift());av.shift()}ah=[];while((aw.length>0)&&(av.length>0)&&(aw[aw.length-1]===av[av.length-1])){ah.unshift(aw.pop());av.pop()}if(aw.length>0){aC=[E];aC=aC.concat(aw);aC.push(ac)}else{aC=[]}if(av.length>0){am=[ad];am=am.concat(av);am.push(s)}else{am=[]}return at.concat(aC,am,ah)}if((ag===0)&&(af===aw.length-1)&&(aq===0)&&(ax===av.length-1)){return av}ap=aw.splice(0,ag);aB=av.splice(0,aq);az=aw.splice(0,af-ag+1);ay=av.splice(0,ax-aq+1);ao=aw;aA=av;for(aG=0;aG<ak.length;aG++){aJ=ak[aG];if(aJ>af){aE.push(aJ-af-1)}if(aJ<ag){aj.push(aJ)}}for(aG=0;aG<aH.length;aG++){aJ=aH[aG];if(aJ>ax){aI.push(aJ-ax-1)}if(aJ<aq){an.push(aJ)}}for(aJ=0;aJ<az.length;aJ++){if(!aD.test(az[aJ])){au.push(aJ)}}for(aJ=0;aJ<ay.length;aJ++){if(!aD.test(ay[aJ])){ai.push(aJ)}}return(h.recurse(ap,aB,aj,an)).concat(h.recurse(az,ay,au,ai),h.recurse(ao,aA,aE,aI))};h.find_keyword_indices=function(ai){var ah=[];var af;var ag;var ae=/[\s,;:?!"'\-&\/()]/;for(af=0;af<ai.length;af++){ag=ai[af];if(ag===""){continue}if(ae.test(ag)){continue}ah.push(af)}return ah};h.split_punctuation=function(ap){var ao;var am=[];var aj="";var ai,ae="",al;var aq=/[\s,.;:?!"'\-\/]/;var ag=/[a-z,A-Z,\#,0-9]/;var af=/(.*?)([+\-±\s]+)(\d+\.\d+)(\s+)(.*)/;var ah=/\d+\.\d+/;var ak;ao=[];if(ah.test(ap)){while((ak=af.exec(ap))!=null){ao=ao.concat(ak[1].toString().split(""));ao=ao.concat(ak[2].toString().split(""));ao.push(ak[3]);ao=ao.concat(ak[4].toString().split(""));ap=ak[5]}}if(ap!==""){ao=ao.concat(ap.toString().split(""))}for(al=0;al<ao.length;al++){ai=ao[al];if(aj!==""){aj=aj+ai;if(ai===")"){if(j==false){am.push(aj)}else{if((am.length>0)&&(am[am.length-1]===" ")){am.pop()}}aj=""}}else{if(ai==="("){aj=ai;if(ae!==""){am.push(ae);ae=""}}else{if(aq.test(ai)){if(ae!==""){am.push(ae)}am.push(ai);ae=""}else{if(ai==="&"){if(ae!==""){am.push(ae)}ae="&";for(var an=al+1;an<ao.length;an++){if(ag.test(ao[an])){ae=ae+ao[an]}else{break}}if((an<ao.length)&&(ao[an]===";")&&(an>al+1)){am.push(ae+";");al=an}else{am.push("&")}ae=""}else{ae=ae+ai}}}}}if(ae!==""){am.push(ae)}return am};h.remove_deleted_tabs=function(ag){var af=false;for(var ae=0;ae<ag.length;ae++){if(ag[ae]==E){af=true}else{if(af==true){if(ag[ae]==ac){af=false}else{if(ag[ae]=="\t"){ag[ae]=" "}}}}}for(var ae=0;ae<ag.length-2;ae++){if((ag[ae]==E)&&(ag[ae+1]==" ")&&(ag[ae+2]==ac)){ag.splice(ae,3);ae=ae-1}}for(var ae=0;ae<ag.length-2;ae++){if((ag[ae]==ad)&&(ag[ae+2]==s)&&((ag[ae+1]==" ")||(ag[ae+1]=="\t"))){ag.splice(ae+2,1);ag.splice(ae,1)}}return ag};h.fdiff3=function(ak,aj){var ai,ag;var af,ae;var ah;ai=h.split_punctuation(ak);ag=h.split_punctuation(aj);af=h.find_keyword_indices(ai);ae=h.find_keyword_indices(ag);ah=h.recurse(ai,ag,af,ae);return h.remove_deleted_tabs(ah)};h.detect_language=function(ak){var af=0,ae=0,ah=0;var aj="X";var ai,ag;ae=1+(ak.split(/claim/i)).length-1+(ak.split(/characteri/i)).length-1+(ak.split(/according/i)).length-1;af=1+(ak.split(/revendication/i)).length-1+(ak.split(/caract.ris/i)).length-1+(ak.split(/selon/i)).length-1;ah=1+(ak.split(/anspr.ch/i)).length-1+(ak.split(/gekennzeich/i)).length-1+(ak.split(/nach/i)).length-1;if(ae>=ah){ai=ae;ag=ah}else{ai=ah;ag=ae}if(af>=ai){ag=ai;ai=af}else{if(af>=ag){ag=af}}if((ai/ag)>=3){if(ai==ae){aj="E"}else{if(ai==ah){aj="D"}else{aj="F"}}}return aj};h.correct_missing_spaces=function(ak){var aj;aj=h.detect_language(ak);ak=ak.split(/\:/);ak=ak.join(": ");ak=ak.split(/\;/);ak=ak.join("; ");ak=ak.split(/\,/);ak=ak.join(", ");if(aj=="E"){ak=ak.split(/ ofa /);ak=ak.join(" of a ");ak=ak.split(/ wherein/);ak=ak.join(" wherein ");ak=ak.split(/ wherein :/);ak=ak.join(" wherein:");ak=ak.split(/ said/);ak=ak.join(" said ");ak=ak.split(/ and\/or/);ak=ak.join(" ANDSLASHOR ");ak=ak.split(/ and\,/);ak=ak.join(" ANDCOMMA ");ak=ak.split(/ and/);ak=ak.join(" and ");ak=ak.split(/ ANDSLASHOR /);ak=ak.join(" and/or");ak=ak.split(/ ANDCOMMA /);ak=ak.join(" and, ");ak=ak.split(/inthat/);ak=ak.join("in that");ak=ak.split(/ that/);ak=ak.join(" that ");ak=ak.split(/ that :/);ak=ak.join(" that:");ak=ak.split(/orfurther/);ak=ak.join("or further");ak=ak.split(/orwhere/);ak=ak.join("or where");ak=ak.split(/orthat/);ak=ak.join("or that")}if(aj=="E"){var af=/(claim)(\d)/i;var ae=/(claims)(\d)/i;var ai;if((ai=af.exec(ak))!=null){var ag=/([\s\S]*)(claim)(\d+)([\s\S]*)/i;while((ai=ag.exec(ak))!=null){ak=ai[1]+ai[2]+" "+ai[3]+ai[4]}}if((ai=ae.exec(ak))!=null){var ah=/([\s\S]*)(claims)(\d+)([\s\S]*)/i;while((ai=ah.exec(ak))!=null){ak=ai[1]+ai[2]+" "+ai[3]+ai[4]}}}return ak};h.ocr_cleanup=function(ag){if(J==true){ag=h.correct_missing_spaces(ag)}ag=h.handle_reference_signs(ag);if(P==true){ag=ag.split(/\s+\)/);ag=ag.join(")");ag=ag.split(/\(\s+/);ag=ag.join("(");ag=ag.split(/\s+\]/);ag=ag.join("]");ag=ag.split(/\[\s+/);ag=ag.join("[");ag=ag.split(/\s+\,/);ag=ag.join(",");ag=ag.split(/\s+\;/);ag=ag.join(";");ag=ag.split(/\s+\:/);ag=ag.join(":");ag=ag.split(/\s+\./);ag=ag.join(".")}ag=ag.split("<RTI>");ag=ag.join("");ag=ag.split("<RTIgt;");ag=ag.join("");ag=ag.split("</RTI>");ag=ag.join("");ag=ag.replace(/\&/g,"AMPERSANDFOOBAR");ag=ag.replace(/\;/g,"&#59;");ag=ag.replace(/\:/g,"&#58;");ag=ag.replace(/AMPERSANDFOOBAR/g,"&amp;");ag=ag.replace(/\u2013|\u2014/g,"-");ag=ag.replace(/\u2018|\u2019|\u201A|\u0060/g,"'");ag=ag.replace(/\u201c|\u201d|\u201e/g,'"');ag=ag.split("<");ag=ag.join("&lt;");ag=ag.split(">");ag=ag.join("&gt;");if(N==true){ag=ag.replace(/\u00df/g,"ss")}ag=ag.split(/[ \t]+/);ag=ag.join(" ");ag=ag.split(/[\n\f\r]+/);ag=ag.join("\t");if(T==true){var ae=/(.*[a-zA-Z\u00e9\u00e8\u00f6\u00fc]+)\-\s*(\w+.*)/;var af;while((af=ae.exec(ag))!=null){ag=af[1]+af[2]}}return ag};h.ocr_cleanup_desc=function(ah){var ae=j;var af=T;var ag;j=false;T=false;ag=h.ocr_cleanup(ah);j=ae;T=af;return ag};h.form_claim_reg_exp=function(ag){var af;var ae;ag=ag.toString();af=ag.split("");re="";for(ae=0;ae<af.length;ae++){if(ae>0){re=re+"\\s{0,1}"}if(af[ae]==1){pat="[1,l,I,i]"}else{if(af[ae]==2){pat="[2,Z,z]"}else{if(af[ae]==5){pat="[5,S,s]"}else{if(af[ae]==0){pat="[0,O,o]"}else{pat=af[ae]}}}}re=re+pat}return re};h.handle_strict_patterns=function(ah,au,am,ak,av,ao){var ai;var ag;var ar=0;var af=100000;var aw=[];var aj;var aq;var an;var ap=false;var al=[];if(typeof(ao)=="undefined"){ao=""}ai=new RegExp("(.*\\.\\s*)("+au+")(\\d+)("+am+")(.*)$",ao);while((ag=ai.exec(ah))!=null){claim_no=parseInt(ag[3],10);if(typeof aw[claim_no]!="undefined"){ap=true;al.push(claim_no)}aw[claim_no]=ag[2]+ag[3]+ag[4]+ag[5];ah=ag[1];if(ar<claim_no){ar=claim_no}if(af>claim_no){af=claim_no}}v2="";ai=new RegExp("^(.*?)("+au+")(\\d+)("+am+")(.*)$",ao);while((ag=ai.exec(ah))!=null){claim_no=parseInt(ag[3],10);ah=ag[1];v2=ag[2]+ag[3]+ag[4]+ag[5]+v2;if((claim_no<af)&&(claim_no>0)){aw[claim_no]=v2;v2="";af=claim_no}if(ar<claim_no){ar=claim_no}}if(ap==true){var at="Warning: the following claims/paragraphs have been found multiple times:\n";at=at+al.pop();while(al.length>0){at=at+", "+al.pop()}alert(at+".\nPlease check the text in the input window.")}aw[0]=ah;if(ar>1000){var ae=ar;ar=1000;while((ar>0)&&(typeof(aw[ar])=="undefined")){ar--}alert("Something probably went wrong.\nHighest claim number detected: "+ae+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+ar+".")}an=0;for(c=1;c<=ar+3;c++){if(typeof aw[c]=="undefined"){ai=new RegExp(h.form_claim_reg_exp(c));if(ai.test(aw[an])){ai=new RegExp(ak+h.form_claim_reg_exp(c)+av);if(ai.test(aw[an])){if(an==0){ai=new RegExp("(.*?)("+ak+h.form_claim_reg_exp(c)+av+")(.*)",ao)}else{ai=new RegExp("(.*?[\\.\\s]+)("+ak+h.form_claim_reg_exp(c)+av+")(.*)",ao)}if((ag=ai.exec(aw[an]))!=null){aw[an]=ag[1];aw[c]=ag[2]+ag[3];an=c;if(c>ar){ar=c}}}}}else{an=c}}aw.unshift(ar);return aw};h.handle_square_brackets_type_claims=function(ae){return h.handle_strict_patterns(ae,"\\[","\\]","\\[[0oO\\s]*","\\s{0,1}\\]")};h.handle_siemens_type_claims=function(af){var ae=h.detect_language(af);if(ae=="E"){return h.handle_strict_patterns(af,"\\[claim\\s+","\\]","\\[claim\\s+","\\s{0,1}\\]","i")}else{if(ae=="D"){return h.handle_strict_patterns(af,"\\[anspruch\\s+","\\]","\\[anspruch\\s+","\\s{0,1}\\]","i")}else{if(ae=="F"){return h.handle_strict_patterns(af,"\\[revendication\\s+","\\]","\\[revendication\\s+","\\s{0,1}\\]","i")}else{return[0,af]}}}};h.handle_claim_type_claims=function(af){var ae=h.detect_language(af);if(ae=="E"){return h.handle_strict_patterns(af,"claim\\s+","\\.","claim\\s+","\\s{0,1}\\.","i")}else{if(ae=="D"){return h.handle_strict_patterns(af,"anspruch\\s+","\\.","anspruch\\s+","\\s{0,1}\\.","i")}else{if(ae=="F"){return h.handle_strict_patterns(af,"revendication\\s+","\\.","revendication\\s+","\\s{0,1}\\.","i")}else{return[0,af]}}}};h.count_matches=function(ah,ae){var ag;var af=0;while((ag=ae.exec(ah))!=null){af=af+1;ah=ag[1]}return af};h.detect_claim_numbering_style=function(ai){var ax=/\.\s*\d+\.(.*)/;var aj=/^\d+\./;var aw=/\[\d+\]\s+(.*)/;var af=/\[\s*anspruch\s+\d+\s*\](.*)/i;var ae=/\[\s*revendication\s+\d+\s*\](.*)/i;var az=/\[\s*claim\s+\d+\s*\](.*)/i;var au=/\.\s*\d+\/(.*)/;var ak=/^\d+\//;var at=/\.\s*\d+\s{0,1}\-(.*)/;var ao=/^\d+\s{0,1}\-/;var aq=/\.\s*\d+\)(.*)/;var ag=/^\d+\)/;var ar=/\.\s*anspruch\s+\d+\.(.*)/i;var ap=/\.\s*revendication\s+\d+\.(.*)/i;var an=/\.\s*claim\s+\d+\.(.*)/i;var al=[0,0,0,0,0,0,0,0,0,0,0,0];var ah;al[g]=h.count_matches(ai,ax);if((matches=aj.exec(ai))!=null){al[g]=al[g]+1}al[d]=h.count_matches(ai,aw);al[aa]=h.count_matches(ai,af)+h.count_matches(ai,ae)+h.count_matches(ai,az);al[y]=h.count_matches(ai,ar)+h.count_matches(ai,ap)+h.count_matches(ai,an);al[V]=h.count_matches(ai,au);if((matches=ak.exec(ai))!=null){al[V]=al[V]+1}al[M]=h.count_matches(ai,at);if((matches=ao.exec(ai))!=null){al[M]=al[M]+1}var ay=j;j=true;var am=h.split_punctuation(ai);ah=am.join("");j=ay;al[p]=h.count_matches(ah,aq);if((matches=ag.exec(ah))!=null){al[p]=al[p]+1}largest_score=al[e];largest_score_style=e;second_largest_score=0;second_largest_score_style=m;for(var av=e+1;av<=X;av++){if(al[av]>second_largest_score){if(al[av]>largest_score){second_largest_score=largest_score;second_largest_score_style=largest_score_style;largest_score=al[av];largest_score_style=av}else{second_largest_score=al[av];second_largest_score_style=av}}}if((largest_score_style==d)&&(largest_score>=10)){claim_style=largest_score_style}else{if((second_largest_score!=0)&&(largest_score<2*second_largest_score)){claim_style=m}else{claim_style=largest_score_style}}return claim_style};h.split_claims=function(am){var ap;var ag;var at=0;var ak=100000;var ai=[];var au;var ar;var al;var ah=false;var aq=[];if(ab==true){au=h.detect_claim_numbering_style(am)}else{au=m}var aj="\\.";var ao="[.,]";var ae="\\s{0,1}\\.";if(au==d){return h.handle_square_brackets_type_claims(am)}else{if(au==aa){return h.handle_siemens_type_claims(am)}else{if(au==y){return h.handle_claim_type_claims(am)}else{if(au==V){aj="\\/";ao=aj;ae="\\s{0,1}\\/"}else{if(au==M){aj="\\s{0,1}\\-";ao=aj;ae=aj}else{if(au==p){aj="\\)";ao=aj;ae="\\s{0,1}\\)"}}}}}}ap=new RegExp("(.*\\.\\s+)(\\d+)("+aj+")(.*)$");while((ag=ap.exec(am))!=null){claim_no=parseInt(ag[2],10);if(claim_no>1000){am=ag[1]+"["+ag[2]+"]"+ag[3]+ag[4];continue}if(typeof ai[claim_no]!="undefined"){ah=true;aq.push(claim_no)}ai[claim_no]=""+claim_no+ag[3]+ag[4];am=ag[1];if(at<claim_no){at=claim_no}if(ak>claim_no){ak=claim_no}}v2="";ap=new RegExp("^(.*?)(\\d+)("+aj+")(\\s+.*)$");while((ag=ap.exec(am))!=null){claim_no=parseInt(ag[2],10);am=ag[1];v2=""+claim_no+ag[3]+ag[4]+v2;if((claim_no<ak)&&(claim_no>0)){ai[claim_no]=v2;v2="";ak=claim_no}if(at<claim_no){at=claim_no}}if(ah==true){var an="Warning: the following claims/paragraphs have been found multiple times:\n";an=an+aq.pop();while(aq.length>0){an=an+", "+aq.pop()}alert(an+".\nPlease check the text in the input window.")}ai[0]=am;if(typeof ai[1]=="undefined"){if((c=ai[0].indexOf("1 "))==0){ai[1]=ai[0];ai[0]=""}else{if((c=ai[0].indexOf(" 1 "))!==-1){ai[1]=ai[0].substring(c);ai[0]=ai[0].substring(0,c)}else{ap=new RegExp("^("+h.form_claim_reg_exp(1)+ae+")(.*)");if((ag=ap.exec(ai[0]))!=null){ai[0]="";ai[1]=ag[1]+ag[2]}}}}if(at>1000){var af=at;at=1000;while((at>0)&&(typeof(ai[at])=="undefined")){at--}alert("Something probably went wrong.\nHighest claim number detected: "+af+".\nPlease refer to the troubleshooting section for hints on workarounds.\nIgnoring anything past last seen claim/paragraph "+at+".")}al=0;for(c=1;c<=at+15;c++){if(typeof ai[c]=="undefined"){if(ai[al].indexOf("."+c)!==-1){ap=new RegExp("(.*?\\.)("+c+aj+")(\\s+.*)");if((ag=ap.exec(ai[al]))!=null){ai[al]=ag[1];ai[c]=ag[2]+ag[3];al=c;if(c>at){at=c}}}}else{al=c}}al=0;for(c=1;c<=at+3;c++){if(typeof ai[c]=="undefined"){if(ai[al].indexOf(c)!==-1){ap=new RegExp("(.*?\\.\\s*)("+c+")(\\s+.*)");if((ag=ap.exec(ai[al]))!=null){if((ag[1].length>=2)&&((ag[1].charAt(ag[1].length-2)>="0")&&(ag[1].charAt(ag[1].length-2)<="9"))){}else{ai[al]=ag[1];ai[c]=ag[2]+ag[3];al=c;if(c>at){at=c}}}}}else{al=c}}al=0;for(c=1;c<=at+3;c++){if(typeof ai[c]=="undefined"){ap=new RegExp(h.form_claim_reg_exp(c));if(ap.test(ai[al])){ap=new RegExp("(.*?\\.\\s+)("+h.form_claim_reg_exp(c)+ao+")(.*)");if((ag=ap.exec(ai[al]))!=null){ai[al]=ag[1];ai[c]=ag[2]+ag[3];al=c;if(c>at){at=c}}}}else{al=c}}if(au==g){al=0;for(c=1;c<=at+3;c++){if(typeof ai[c]=="undefined"){ap=new RegExp(h.form_claim_reg_exp(c));if(ap.test(ai[al])){ap=new RegExp("(.*?\\s+)("+c+aj+"\\s{0,1})(\\D.*)");if((ag=ap.exec(ai[al]))!=null){ai[al]=ag[1];ai[c]=ag[2]+ag[3];al=c;if(c>at){at=c}}}}else{al=c}}}al=0;for(c=1;c<=at+3;c++){if(typeof ai[c]=="undefined"){ap=new RegExp(h.form_claim_reg_exp(c));if(ap.test(ai[al])){ap=new RegExp("(.*?\\s+)("+h.form_claim_reg_exp(c)+ae+")(.*)");if((ag=ap.exec(ai[al]))!=null){ai[al]=ag[1];ai[c]=ag[2]+ag[3];al=c;if(c>at){at=c}}}}else{al=c}}for(c=1;c<=at;c++){if(typeof ai[c]!="undefined"){ai[c]=h.fix_unclosed_brackets(ai[c])}}ai.unshift(at);return ai};h.handle_double_paragraphs=function(ak){var am=/\[\d+\][^\S\t]+\[\d+\](.*)/;var ag=/(.*?)\t(\[\d+\])([ ]+)(\[\d+\])(.*)/;var ae=/(.*?)(\[\d+\])(.*)/;var ah="";var af="";if(ak==""){return ak}if(h.count_matches(ak,am)>=1){while((matches=ag.exec(ak))!=null){var aj=matches[1];var al=matches[2];var ai=matches[4];ak=matches[5];while((matches=ae.exec(aj))!=null){aj=matches[1]+matches[3];ah=ah+matches[2]}af=af+aj+"\t"+ai;ah=ah+al}while((matches=ae.exec(ak))!=null){ak=matches[1]+matches[3];ah=ah+matches[2]}af=af+ak;return af}return ak};h.split_desc=function(ai){if(ai==""){return[0,ai]}else{var af;var ae=/\.\s*\[\d+\](.*)/;var ah=h.ocr_cleanup_desc(ai);if(h.count_matches(ah,ae)>=2){ah=h.handle_double_paragraphs(ah);af=h.handle_square_brackets_type_claims(ah)}else{af=ah.split(/[\t]+/);while((af.length>0)&&(af[af.length-1]=="")){af.pop()}af.unshift("");af.unshift(af.length-1)}for(var ag=1;ag<af.length;ag++){if(typeof af[ag]!="undefined"){af[ag]=h.fix_unclosed_brackets(af[ag])}}return af}};h.calculate_score_for_word=function(ae){if((ae=="claim")||(ae=="claims")||(ae=="according")||(ae=="characterised")||(ae=="characterized")||(ae=="Anspruch")||(ae=="Ansprüche")||(ae=="gekennzeichnet")||(ae=="revendication")||(ae=="revendications")||(ae=="caractérisé")||(ae=="caractérisée")){return 0}else{return ae.length}};h.count_added=function(ah){var af=0;var ag=0;var ae;for(ae=0;ae<ah.length;ae++){if(ah[ae]==ad){ag=1}else{if(ah[ae]==s){ag=0}else{if(ah[ae]==E){ag=2}else{if(ah[ae]==ac){ag=0}else{if(ag==1){af=af+h.calculate_score_for_word(ah[ae])}}}}}}return af};h.count_unchanged=function(ah){var ag=0;var af=0;var ae;for(ae=0;ae<ah.length;ae++){if(ah[ae]==ad){af=1}else{if(ah[ae]==s){af=0}else{if(ah[ae]==E){af=2}else{if(ah[ae]==ac){af=0;ag=ag-1}else{if(af==0){ag=ag+h.calculate_score_for_word(ah[ae])}}}}}}if(ag>0){return ag}else{return 0}};h.is_short_word=function(af){var ag=["the","a"," ","of","in","and","to","is","that","der","die","das","dem","des","den","im","und","le","la","dans","que","de"];for(var ae=0;ae<ag.length;ae++){if(af==ag[ae]){return 1}}return 0};h.cross_out_deleted=function(ag){var af=0;var ah=[];for(var ae=0;ae<ag.length;ae++){if(ag[ae]==E){af=1}else{if(ag[ae]==ac){af=0}else{if(ag[ae]==ad){af=2}else{if(ag[ae]==s){af=0}else{if(af==0){ah.push(ag[ae])}else{if(af==1){if(ag[ae]==" "){ah.push(" ")}else{ah.push(Array(1+ag[ae].length).join("-"))}}}}}}}}return ah};h.alert_array=function(ae){var af=ae.join("-");alert(af)};h.reset_feature_blocks=function(){f=[];H=[];L=[]};h.add_feature_for_claim=function(af,ag,ae){f.push(af);H.push(ag);L.push(ae)};h.find_feature_block_marker=function(ah,ae){var ag=ah.indexOf(l,ae);var af=ah.indexOf(U,ae);if((ag<0)&&(af>=0)){return af}if((af<0)&&(ag>=0)){return ag}if(ag<af){return ag}else{return af}};h.find_feature_blocks=function(ai,aj){var ag=0;var ae=0,ah=0,al=0;while((ag=h.find_feature_block_marker(aj,ag))>=0){if(aj.substr(ag,2)==l){al=al+1}else{if(aj.substr(ag,2)==U){al=al-1}}if(al>ae){ae=al}if(al<ah){ah=al}ag=ag+2}if((ae>1)||(ah<0)||(al!=0)){alert("Unbalanced feature brackets [[ ... ]] found in claim "+ai+" -- ignoring all brackets");return aj}if((ae==0)&&(ah==0)){return aj}var af=/(.*)\[\[(.*?)\]\](.*)/;var ak=0;while((matches=af.exec(aj))!=null){h.add_feature_for_claim(ai,ak,matches[2]);aj=matches[1]+" "+r+ak+b+" "+matches[3];ak=ak+1}aj=(aj.split("  ")).join(" ");return aj};h.replace_feature_markers=function(ai){var ae=/(.*)\{\{\{(\d+)\}\}\}(.*)/;var ag;var af;var ah=0;if(ae.exec(ai.join(""))==null){return ai}af=[];for(loop=0;loop<ai.length;loop++){if(ai[loop]==ad){ah=1}else{if(ai[loop]==s){ah=0}}if((ag=ae.exec(ai[loop]))!=null){if(ag[1].length>0){af.push(ag[1])}if(ah==1){af.push(s);af.push(ad)}if(ag[2]<=f.length){atoms=L[ag[2]].split(" ");for(i=0;i<atoms.length;i++){af.push(atoms[i]);if(i!=atoms.length){af.push(" ")}}}if(ah==1){af.push(s);af.push(ad)}if(ag[3].length>0){af.push(ag[3])}}else{af.push(ai[loop])}}return af};h.collect_deleted_parts=function(aj){var ai=0;var ak,ag,al,ae=-1;var am;for(ak=aj.length-1;ak>=0;ak--){if(aj[ak]==ac){ae=ak}else{if(aj[ak]==E){for(ag=ak-1;ag>=0;ag--){if(h.is_short_word(aj[ag])){continue}else{if(aj[ag]==s){for(al=ag-1;al>=0;al--){if(aj[al]==ad){break}}if((al>=0)&&(ae>0)){if(ak-ag>1){short_words=aj.splice(ag+1,ak-ag-1);Array.prototype.splice.apply(aj,[ag,0].concat(short_words));ag=ag+short_words.length;Array.prototype.splice.apply(aj,[ak+1,0].concat(short_words));ae=ae+short_words.length}var af=ag-al+1;added_block=aj.splice(al,af);ak=ak-af;ag=ak;ae=ae-af;Array.prototype.splice.apply(aj,[ae+1,0].concat(added_block))}else{alert("Warning: this should not happen (E101)");return aj}}else{if(aj[ag]==ac){if(ag==ak-1){for(start_other_del=ag-1;start_other_del>=0;start_other_del--){if(aj[start_other_del]==E){break}}if(start_other_del>=0){aj.splice(ag,2);ak=start_other_del;ag=ak;ae=ae-2}}else{break}}else{break}}}}}}}for(var ah=0;ah<aj.length-1;ah++){if(((aj[ah]==ac)&&(aj[ah+1]==E))||((aj[ah]==s)&&(aj[ah+1]==ad))){aj.splice(ah,2)}}return aj};h.remove_deleted=function(ag){var af=0;var ah=[];for(var ae=0;ae<ag.length;ae++){if(ag[ae]==E){af=1}else{if(ag[ae]==ac){af=0}else{if(af==0){ah.push(ag[ae])}}}}return ah};h.remove_short_unchanged=function(ag){var ah=[];for(var af=0;af<ag.length;af++){if(ag[af]==ad){for(var ae=ah.length-1;ae>=0;ae--){if(!h.is_short_word(ah[ae])||ah[ae]==s){break}}if(ae<0){ah.unshift(ad);continue}else{if(ah[ae]==s){ah.splice(ae,1);continue}}}ah.push(ag[af])}for(var ae=ah.length-1;ae>=0;ae--){if(!h.is_short_word(ah[ae])||ah[ae]==s){break}}if((ae>=0)&&(ah[ae]==s)){ah.splice(ae,1);ah.push(s)}return ah};h.remove_tags=function(ae){ae=(ae.split(ad)).join("");ae=(ae.split(s)).join("");ae=(ae.split(E)).join("");ae=(ae.split(ac)).join("");return ae};h.get_color_string=function(af){var ae=["yellow","cyan","lime","orange","lightskyblue","lightgreen","coral","gold","violet","silver","pink","lightsalmon","tomato"];max_color=12;if(af==0){the_color=0}else{the_color=1+((af-1)%max_color)}return'<span style="background-color: '+ae[the_color]+'">'};h.get_color_string_end=function(){return"</span>"};h.get_color_string_and_update_legend_for_claim=function(af,ae){var ag=new RegExp('background-color: (\\w+)">'+af+h.get_color_string_end());for(leg=1;leg<ae.length;leg++){if(ag.exec(ae[leg])!=null){break}}if(leg==ae.length){ae.push(" "+h.get_color_string(leg)+af+h.get_color_string_end())}return h.get_color_string(leg)};h.make_single_added=function(af){var ae;var ag=[];for(ae=0;ae<af.length;ae++){if((af[ae]!=ad)&&(af[ae]!=s)){ag.push(af[ae])}}if(ag.length>0){ag.unshift(ad);ag.push(s)}while(af.length>0){af.pop()}while(ag.length>0){af.push(ag.shift())}return};h.format_claim_span=function(ai,am){var ae="";var al=-1;var an=-1;var aj=[];var ak=[];var af=false;for(var ah=1;ah<=am;ah++){if(typeof ai[ah]!="undefined"){aj.push(ah)}else{af=true}}if(aj.length==0){return"None"}for(var ag=0;ag<aj.length;ag++){if((aj[ag]-an==1)){an=aj[ag]}else{if(al>0){if((an-al)>=2){ae=ae+al+"-"+an+","}else{if((an-al)==1){ae=ae+al+","+an+","}else{ae=ae+al+","}}}al=aj[ag];an=aj[ag]}}if((an-al)>=2){ae=ae+al+"-"+an}else{if((an-al)==1){ae=ae+al+","+an}else{ae=ae+al}}if(af){ae=ae+" (Warning: irregularly numbered set, please check input)"}return ae};h.split_into_added_unchanged_added=function(am,ai,at,aq){var ao,an;var aj,af;var ap,ah,ar;var ae,al,ag;var ak;ar=0;ap=0;ah=0;ag=0;ae=0;al=0;af=0;aj=0;for(ao=0;ao<am.length;ao++){if(am[ao]==ad){ak=true;aj=ao;af=0}else{if(am[ao]==s){if(af>S){al=aj-1;if(ag>ar){ap=ae;ah=al;ar=ag}ae=ao+1;al=ao+1;ag=0}else{al=ao}ak=false}else{if(ak){af=af+am[ao].length}else{ag=ag+am[ao].length;al=ao}}}}if(ag>ar){ap=ae;ah=al;ar=ag}for(ao=0;ao<ap;ao++){ai.push(am[ao])}for(ao=ap;ao<=ah;ao++){at.push(am[ao])}for(ao=ah+1;ao<am.length;ao++){aq.push(am[ao])}h.make_single_added(ai);h.make_single_added(aq);return};h.recode_added_parts=function(ak,am,ae,af){var an,al,ao,at,ax;var ah,ap;var aw,aq;var ag;an=al=ao=at=ah=ap=[];aq=0;k++;if(o==false){ag="|"}else{ag=""}for(aw=0;aw<ae.length;aw++){if(ae[aw]==ad){aq=1;al=[];if(k==1){at.push(ae[aw])}continue}else{if(ae[aw]==s){aq=2;coded_yet=0;if(h.count_added([ad].concat(al,s))>S){max_score=0;ax=0;var au,aj;for(var ar=1;ar<=am;ar++){if(typeof ak[ar]=="undefined"){continue}au=h.fdiff3(ak[ar],al.join(""));au=h.remove_deleted(au);if((diff_score=h.count_unchanged(au))>max_score){ax=ar;max_score=diff_score}}if(max_score>S){var ai,ay,av;au=h.fdiff3(ak[ax],al.join(""));au=h.remove_deleted(au);ai=[];ay=[];av=[];h.split_into_added_unchanged_added(au,ai,ay,av);ah=h.recode_added_parts(ak,am,ai,af);at=at.concat(ah);at.push("<SPAN>"+ag);if(o){at.push(h.get_color_string_and_update_legend_for_claim(ax,af))}else{at.push(h.get_color_string(af.length));af.push(" "+h.get_color_string(af.length)+ax+h.get_color_string_end())}mode2=0;for(d2=0;d2<ay.length;d2++){if(ay[d2]==E){mode2=1;alert("This should not happen. Code 1.")}else{if(ay[d2]==ac){mode2=0;alert("This should not happen. Code 2.")}else{if(ay[d2]==ad){at.push(h.get_color_string(0))}else{if(ay[d2]==s){at.push(h.get_color_string_end())}else{if(mode2==0){at.push(ay[d2])}}}}}}at.push(h.get_color_string_end());aj=h.fdiff3(ak[ax],h.remove_tags(ay.join("")));at.push(ag+'</SPAN><SPAN class="tooltip">'+aj.join("")+"</SPAN>");ap=h.recode_added_parts(ak,am,av,af);at=at.concat(ap);coded_yet=1}}if(!coded_yet){at.push(h.get_color_string(0));at=at.concat(al);at.push(h.get_color_string_end())}if(k==1){at.push(s)}}}if(aq==0){at.push(ae[aw])}else{if(aq==1){al.push(ae[aw])}else{if(aq==2){aq=0}}}}k--;return at};h.get_main_base_claim=function(af){for(var ag=0;ag<t.length;ag++){if(t[ag]==af){var ae=/^(\d+)/;var ah;if((ah=ae.exec(A[ag]))!=null){var ai=parseInt(ah[1]);if(ai<0){alert('Base value "'+base+'"out of bounds');return -1}else{return ai}}}}return -1};h.get_claim_base_exclusions=function(ar,ax,ak,aj){var am=0;var ah;var af=false;if(aj==false){ak=0;ah=A}else{ah=A.slice(0)}for(var al=0;al<t.length;al++){if(t[al]==ar){if((ah[al].search("!")>=0)&&(ah[al].search("&")>=0)){alert("Error in base override for claim "+ar+"\nCan't both include (&) and exclude (!) claims");return[]}var aq=/(.*)\[(\d+)\](.*)/;var ag;while((ag=aq.exec(ah[al]))!=null){if((Math.round(ag[2])<=ak)&&(Math.round(ag[2])!=0)){ah[al]=ag[1]+(ax+parseInt(ag[2]))+ag[3];af=true}else{if(aj==true){alert("Error in base override for claim "+ar+"\nInvalid paragraph number ["+ag[2]+"] encountered.")}else{if(ah[al].search("&")>=0){alert("Error in base override for claim "+ar+":\nuse of description not selected.")}}ah[al]=ag[1]+ag[3]}}var at=ah[al].split(/[0-9!&\-\,]+/);if((at=at.join(""))!==""){alert("Error in base override for claim "+ar+"\nInvalid character(s) "+at+' encountered.\n\nValid examples: "5!8,9,12-15,38-40" or "&8,9,12-15,38-40"');return[]}var av=ah[al];var ae=/(.*?)(\d+)\-(\d+)(.*)/;var ag,ai,ap;while((ag=ae.exec(av))!=null){ai=parseInt(ag[2]);ap=parseInt(ag[3]);if(ai>=ap){alert("Invalid base override range ("+ag[2]+"-"+ag[3]+") for claim "+ar+".");return[]}av=""+ag[1]+ag[2];for(var aw=ai+1;aw<=ap;aw++){av=av+","+aw}av=av+ag[4]}av=av.split(/[!&,]/);av.shift();if(ah[al].search("!")>=0){return av}else{if(ah[al].search("&")>=0){if((af==false)&&(aj==true)){ak=0}var au=[];for(var ao=1;ao<=ax+ak;ao++){for(var an=0;an<av.length;an++){if(av[an]==ao){break}}if(an==av.length){au.push(ao)}}return au}}break}}return[]};h.get_base_text_for_claim=function(ae){for(var af=0;af<t.length;af++){if(t[af]==ae){return A[af]}}return""};h.insert_in_score_list=function(af,ae,ag){af.push(ae);af.push(ag);for(var ah=(af.length/2)-2;ah>=0;ah--){if(ag<=af[ah*2+1]){break}af[(ah+1)*2]=af[ah*2];af[(ah+1)*2+1]=af[ah*2+1];af[ah*2]=ae;af[ah*2+1]=ag}return};h.show_dependency_table=function(ag,aj){var af="<B>Claim dependency table:</B><BR>";var ae;for(var ah=1;ah<=aj;ah++){if(typeof(ag[ah])=="undefined"){continue}ae="    "+ah+": ";af=af+ae.substr(-5);for(var ai=1;ai<=ah;ai++){if(ah==ai){af=af+"x "}else{if(typeof(ag[ah][ai])=="undefined"){af=af+"- "}else{af=af+ag[ah][ai]+" "}}}af=af+"<BR>"}return af};h.format_claim_tree_recursive=function(an,aj,am,ag,af,ak){if(typeof(an[aj])=="undefined"){return af}if(af.indexOf("-"+aj+"-")>=0){return af}var al="";if(typeof(ak)!="undefined"){if(typeof(ak[aj])!="undefined"){al="<SUP>("+ak[aj]+")</SUP>"}}for(var ah=1;ah<ag;ah++){af=af+"| "}if(ag>0){af=af+"+ "}else{if(ag==0){af=af+"<BR>"}}if(ag==0){af=af+"<BR>-<B>"+aj+"</B>-"+al+"<BR>"}else{af=af+"-"+aj+"-"+al+"<BR>"}for(var ai=aj+1;ai<=am;ai++){if(af.indexOf("-"+ai+"-")>=0){continue}else{if(typeof(an[ai])=="undefined"){continue}else{if(an[ai][aj]==1){for(var ae=aj-1;ae>0;ae--){if(an[ai][ae]==1){break}}if(ae==0){if(typeof(ak)!="undefined"){if(typeof(ak[ai])!="undefined"){if(typeof(ak[aj])!="undefined"){ak[ai]=ak[ai]+";"+ak[aj]}}}af=h.format_claim_tree_recursive(an,ai,am,ag+1,af,ak)}}}}}return af};h.format_claim_tree=function(ae,aw,aj){var ak="";for(var ao=1;ao<=aw;ao++){ak=h.format_claim_tree_recursive(ae,ao,aw,0,ak,aj)}var an=ak.split("<BR>");while((an.length>0)&&(an[0]=="")){an.shift()}for(var ao=1;ao<an.length;ao++){an[ao]=an[ao].split(" ")}for(var ap=0;ap<aw;ap++){last="";for(var ao=an.length-1;ao>=1;ao--){if(typeof(an[ao][ap])=="undefined"){last="";continue}else{if(an[ao][ap]=="|"){if(last==""){an[ao][ap]=" "}}else{if(an[ao][ap]=="+"){last="+"}else{last=""}}}}}for(var ao=1;ao<an.length;ao++){an[ao]=an[ao].join(" ")}ak=an.join("<BR>");ak=ak.split("-");ak=ak.join("");ak=ak.split("+ ");ak=ak.join("+-");var at=/(.*)<SUP>\((.*?)\)<\/SUP>(.*)/;var am=/(.*?)\;(.*)/;var al=/(\d+)/;var ah,av;while((ah=at.exec(ak))!=null){if((av=am.exec(ah[2]))!=null){base_and_support=av[1].split(",")}else{base_and_support=ah[2].split(",")}base_and_support[0]="<b><u>"+base_and_support[0]+"</u></b>";for(var aq=1;aq<base_and_support.length;aq++){base_and_support[aq]="<b>"+base_and_support[aq]+"</b>"}if(av!=null){ah[2]=base_and_support.join(",")+","+av[2]}else{ah[2]=base_and_support.join(",")}ah[2]=ah[2].split(";");ah[2]=ah[2].join(",");var af=[];var ai=[];var au;var ag=ah[2].split(",");for(var ar=0;ar<ag.length;ar++){if((au=al.exec(ag[ar]))!=null){value=Math.round(au[1]);for(var aq=0;aq<af.length;aq++){if(af[aq]>=value){break}}if((aq==af.length)||(af[aq]!=value)){af.splice(aq,0,value);ai.splice(aq,0,ag[ar])}}}ah[2]=ai.join(",");ak=ah[1]+"<sup>("+ah[2]+")</sup>"+ah[3]}return ak};h.remove_claim_tree_deps=function(ae){var af=/(.*)\((.*?)\)(.*)/;var ah;while((ah=af.exec(ae))!=null){var ai=[];legend=ah[2].split(/,/);for(var ag=0;ag<legend.length;ag++){if(legend[ag].indexOf("<b>")>=0){ai.push(legend[ag])}}ae=ah[1]+"{"+ai.join(",")+"}"+ah[3]}ae=ae.split(/\{/);ae=ae.join("(");ae=ae.split(/\}/);ae=ae.join(")");return ae};h.remove_claim_tree_deps_and_support=function(ae){var af=/(.*)<sup>\((.*?)\)<\/sup>(.*)/;var ag;while((ag=af.exec(ae))!=null){ae=ag[1]+ag[3]}return ae};h.do_claim_tree_analysis=function(an,af,av,ak){var ar=/(\w+)(\s+)([C,c]laim)([s]*)(and|or|\s|\,|\-|\d)+(\w+)/;var ao=" to - zu bis à ";var ap=" or , and oder ou ";var aj;var at=[];var au=[];var ae="";var am=0;var aq;au=new Array(af+1);for(var ai=1;ai<=af;ai++){if(typeof(an[ai])=="undefined"){continue}aq=false;au[ai]=new Array(ai);for(var ah=0;ah<ai;ah++){au[ai][ah]=0}words=h.split_punctuation(an[ai]);for(w1=2;w1<words.length;w1++){var al=words[w1].toLowerCase();if(((al.indexOf("claim")>=0)&&(al.indexOf("claimed")<0))||(al.indexOf("anspruch")>=0)||(al.indexOf("ansprüche")>=0)||(al.indexOf("revendication")>=0)){w1++;break}}var ag=false;am=-1;for(;w1<words.length;w1++){if(words[w1].charAt(0)==" "){continue}the_number=parseInt(words[w1],10);if(the_number>0){if(the_number==ai){h.one_time_alert(av+ai+" refers back to itself.")}else{if(the_number>ai){h.one_time_alert(av+ai+" refers back to a later claim.")}else{au[ai][the_number]=1;if(ag==false){am=the_number}else{to_number=the_number;if(to_number<=am){h.one_time_alert(av+ai+" has a malformed dependency range ("+am+" to "+to_number+").")}else{for(d1=am+1;d1<=to_number;d1++){au[ai][d1]=1}}ag=false}}}aq=true}else{if((am>0)&&(ao.indexOf(words[w1])>=0)){ag=true}else{if(ap.indexOf(words[w1])<0){break}}}}if(aq==false){lower_claim=an[ai].toLowerCase();lower_claim=lower_claim.replace(/\s+/g," ");lower_claim=lower_claim.replace(/voranstehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorangehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorhergehend/g,"vorstehend");lower_claim=lower_claim.replace(/vorgenannt/g,"vorstehend");lower_claim=lower_claim.replace(/vorangegangen/g,"vorstehend");lower_claim=lower_claim.replace(/vorherig/g,"vorstehend");lower_claim=lower_claim.replace(/bisherig/g,"vorstehend");if((lower_claim.indexOf("preceding claims")>=0)||(lower_claim.indexOf("previous claims")>=0)||(lower_claim.indexOf("above claims")>=0)||(lower_claim.indexOf("foregoing claims")>=0)||(lower_claim.indexOf("revendications pr")>=0)||(lower_claim.indexOf("den vorstehenden anspr")>=0)){for(d1=1;d1<ai;d1++){au[ai][d1]=1}}else{if((lower_claim.indexOf("the preceding claim")>=0)||(lower_claim.indexOf("the previous claim")>=0)||(lower_claim.indexOf("the above claim")>=0)||(lower_claim.indexOf("the foregoing claim")>=0)||(lower_claim.indexOf("la revendication pr")>=0)||(lower_claim.indexOf("dem vorstehenden anspr")>=0)){au[ai][ai-1]=1}else{if((lower_claim.indexOf("preceding claim")>=0)||(lower_claim.indexOf("previous claim")>=0)||(lower_claim.indexOf("above claim")>=0)||(lower_claim.indexOf("foregoing claim")>=0)||(lower_claim.indexOf("revendication pr")>=0)||(lower_claim.indexOf("vorstehenden anspr")>=0)){for(d1=1;d1<ai;d1++){au[ai][d1]=1}}else{if((lower_claim.indexOf("claim")>=0)||(lower_claim.indexOf("revendication")>=0)||(lower_claim.indexOf("anspr")>=0)){if(lower_claim.indexOf("claim sets")<0){h.one_time_alert(av+ai+"'s dependency not understood, treating as independent.")}}}}}}}ae="<PRE><CODE>"+h.format_claim_tree(au,af,ak)+"</CODE></PRE>";return ae};var K=[];var R=0;var n=0;var D=[];h.reset_score_matrix=function(ae,af){K=[];R=0;n=0;return};h.set_score_matrix_max=function(af,ae){D[af]=ae};h.set_score_matrix_value=function(ag,ae,af){if(typeof(K[ag])=="undefined"){K[ag]=[]}if(ag>R){R=ag}if(ae>n){n=ae}K[ag][ae]=af;return};var q=["#808080","#909090","#a0a0a0","#b0b0b0","#c0c0c0","#d0d0d0","#e0e0e0","#f0f0f0","#ffff00","#f0ff00","#d0ff00","#b0ff00","#90ff00","#80ff00","#60ff00","#40ff00","#00ff00"];h.score_matrix_score_colour=function(ae){if(ae>=100){return q[16]}if(ae<=0){return q[0]}return q[Math.floor(ae*16/100)]};h.format_score_matrix=function(){var af="";var ag;var ae=[];for(let row=1;row<=R;row++){if(typeof(K[row])=="undefined"){continue}ae[row]=[];ag=1;for(let col=1;col<=n;col++){if(typeof(K[row][col])!="undefined"){if(K[row][col]>ag){ag=K[row][col]}}}for(let col=1;col<=n;col++){if(typeof(K[row][col])!="undefined"){ae[row][col]=100*K[row][col]/ag;K[row][col]=100*K[row][col]/D[row]}}}af=af+"<BR><H2>Score matrix</H2>";af=af+"<TABLE class='fdiff4' BORDER=1><TR><TH style='width:30px'>sc</TH>";for(col=1;col<=n;col++){af=af+"<TH style='width:30px'>"+col+"</TH>"}af=af+"<TH>old</TH>";af=af+"</TR>";for(row=1;row<=R;row++){if(typeof(K[row])!="undefined"){af=af+"<TR><TD><B>"+row+"</B></TD>";for(col=1;col<=n;col++){if(typeof(K[row][col])!="undefined"){af=af+"<TD bgcolor='"+h.score_matrix_score_colour(ae[row][col])+"'>"+K[row][col].toFixed(0)+"</TD>"}else{af=af+"<TD>&nbsp;</TD>"}}af=af+"<TD>&nbsp;</TB></TR>"}}af=af+"<TR><TD><B>new</B></TD>";for(col=1;col<=n;col++){af=af+"<TD>&nbsp;</TD>"}af=af+"</TR>";af=af+"</TABLE>";if(false){af=af+"<TABLE>";af=af+"<TR>";for(let col=0;col<=16;col++){af=af+"<TD bgcolor='"+q[col]+"'>&nbsp;</TD>"}af=af+"</TR>";af=af+"</TABLE>"}return af};h.insert_line_breaks=function(af,ak){if((Z==false)&&(Q==false)){af=af.split(/\t/);af=af.join("<BR>\n");return af}if(Z==true){af=af.split("&#59;");af=af.join("&#59;<BR>");af=af.split("&#58;");af=af.join("&#58;<BR>")}if(Q==true){af=af.split(",");af=af.join(",<BR>")}var aj;var al="OPEN_BRACKET_FOO_FOO_FOO";var ag="CLOSE_BRACKET_FOO_FOO_FOO";var ai=/([\s\S]*)\((.*?)\)([\s\S]*)/;while((aj=ai.exec(af))!=null){var ae=aj[2].split("<BR>");ae=ae.join("");af=aj[1]+al+ae+ag+aj[3]}af=af.split(al);af=af.join("(");af=af.split(ag);af=af.join(")");af=af.split("<BR> <BR>");af=af.join("<BR>");af=af.split("<BR><BR>");af=af.join("<BR>");af=af.split("<BR><BR>");af=af.join("<BR>");af=af.split(" <BR>");af=af.join("<BR>");af=af.split("<BR>");af=af.join("<BR>&nbsp;&nbsp;&nbsp;");if(ak){af=af.replace(/\d+\./g,function ah(am){return"<BR><BR>"+am})}return af};h.post_cleanup=function(ag,aj){if(I==true){deleted_parts=ag.split(E);if(deleted_parts.length>0){var ai,af,ae;af=new RegExp(E+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+ac+ad+h.get_color_string(0)+"([A-Za-zÀ-ÿ]+)"+h.get_color_string_end()+s+"([\\S\\s]*)");ae=new RegExp(E+"([A-Za-zÀ-ÿ]+)"+ac+ad+h.get_color_string(0)+"([A-Za-zÀ-ÿ]+)(\\s+)([A-Za-zÀ-ÿ]+)"+h.get_color_string_end()+s+"([\\S\\s]*)");ag=deleted_parts[0];for(var ah=1;ah<deleted_parts.length;ah++){deleted_parts[ah]=E+deleted_parts[ah];if((ai=af.exec(deleted_parts[ah]))!=null){if(ai[4]===(ai[1]+ai[3])){deleted_parts[ah]=ai[1]+ai[2]+ai[3]+ai[5]}}if((ai=ae.exec(deleted_parts[ah]))!=null){if(ai[1]===(ai[2]+ai[4])){deleted_parts[ah]=ai[2]+ai[3]+ai[4]+ai[5]}}ag=ag+deleted_parts[ah]}}}if(aj==false){if(B==true){highlight_and_rem_start='<span style="background-color: OrangeRed">'+E}else{highlight_and_rem_start='<span style="background-color: LightGrey">'+E}highlight_and_rem_end=ac+h.get_color_string_end();ag=(ag.split(E)).join(highlight_and_rem_start);ag=(ag.split(ac)).join(highlight_and_rem_end)}if((aj==true)&&(x==true)){highlight_and_add_start=h.get_color_string(0)+ad;highlight_and_rem_start='<span style="background-color: OrangeRed">'+E;highlight_and_add_end=s+h.get_color_string_end();highlight_and_rem_end=ac+h.get_color_string_end();ag=(ag.split(ad)).join(highlight_and_add_start);ag=(ag.split(E)).join(highlight_and_rem_start);ag=(ag.split(s)).join(highlight_and_add_end);ag=(ag.split(ac)).join(highlight_and_rem_end)}ag=h.insert_line_breaks(ag,aj);return ag};h.split_and_diff=function(aR,aQ,aO){var aI,aG,ak;var ay,ax,an;var aP,al;var ar;var az;var af;var aB,am;var au="";var aM,aK,aJ;var ap;var aN=aR;var aL=aQ;var av="text";var aw=[];var aA=/\[\d+\]/;if(aO=="DESCMAGICFOO"){av="para";aI=h.split_desc(aR);aG=h.split_desc(aQ);ay=aI.shift();ax=aG.shift();if(ay<1){return"No original description paragraph(s) detected -- doing whole text comparison <HR>\n"+h.diff(aN,aL)}aO=""}else{av="claim";aR=h.ocr_cleanup(aR);aQ=h.ocr_cleanup(aQ);aI=h.split_claims(aR);aG=h.split_claims(aQ);ay=aI.shift();ax=aG.shift();if(ay<1){return"No original claim number(s) detected -- doing whole text comparison <HR>\n"+h.diff(aN,aL)}if(C.length>0){aP=h.split_desc(aO);al=aP.shift()}else{aP=[];al=0}}au=au+"<TABLE class='fdiff4' BORDER=1><TR class='fdiff4'><TH class='fdiff4'>New<BR>"+av+"</TH><TH class='fdiff4'>Old<BR>"+av+"</TH><TH class='fdiff4 noprint'>Base<BR>override</TH>";if(av=="claim"){au=au+"<TH class='fdiff4 noprint'>Use<BR>desc</TH>"}au=au+"<TH class='fdiff4'><DIV contenteditable>"+F+"</DIV></TH></TR>\n";if((typeof aG[0]!="undefined")&&(aG[0]!="")){au=au+"<TR class='fdiff4'><TD class='fdiff4'></TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD>";if(av=="claim"){au=au+"<TD class='fdiff noprint'>&nbsp;</TD>"}au=au+"<TD class='fdiff4'>"+aG[0]+"</TD></TR>\n"}h.reset_feature_blocks();h.reset_score_matrix();for(c2=1;c2<=ax;c2++){first_absent=c2;while((c2<ax)&&((typeof aG[c2]=="undefined")||(aG[c2]==""))){c2++}if(c2>first_absent){au=au+"<TR class='fdiff4'><TD class='fdiff4'>"+first_absent;if(c2>(first_absent+1)){au=au+"-"+(c2-1)}au=au+"</TD><TD class='fdiff4'></TD><TD class='fdiff4 noprint'></TD><TD class='fdiff4'></TD></TR>\n"}ap=S;score_list=[];best_claim=-1;aB=false;if((best_claim=h.get_main_base_claim(c2))>=0){if((best_claim>0)&&(typeof aI[best_claim]=="undefined")){alert("Base "+av+" "+best_claim+" for "+av+" "+c2+" not found in original "+av+"s!");best_claim=-1}else{aB=true}}am=false;for(var af=0;af<C.length;af++){if(C[af]==c2){am=true;break}}if(am==false){for(var aE=0;aE<t.length;aE++){if(t[aE]==c2){if(A[aE].search(aA)>=0){am=true;if(al==0&&aO!=""){aP=h.split_desc(aO);al=aP.shift()}}}}}aG[c2]=h.find_feature_blocks(c2,aG[c2]);for(var aj=1;aj<=ay;aj++){if(typeof aI[aj]=="undefined"){continue}ar=h.fdiff3(aI[aj],aG[c2]);diff_score=h.count_unchanged(ar);if(diff_score>ap){if(aB==false){best_claim=aj}ap=diff_score}h.insert_in_score_list(score_list,aj,diff_score);h.set_score_matrix_value(c2,aj,diff_score)}ar=h.fdiff3(aG[c2],aG[c2]);diff_score=h.count_unchanged(ar);h.set_score_matrix_max(c2,diff_score);ak=aI.slice();var ai=h.get_claim_base_exclusions(c2,ay,al,am);an=ay;if((al>0)&&(am==true)){for(var af=1;af<=al;af++){ak[ay+af]=aP[af]}an=ay+al}for(var ag=0;ag<ai.length;ag++){aj=ai[ag];if((aj>0)&&(aj<=an)){ak[aj]=undefined;aB=true}else{if(aj==0){for(aj=0;aj<=an;aj++){ak[aj]=undefined}aB=true}}}if(best_claim>0){az=[best_claim];ar=h.fdiff3(aI[best_claim],aG[c2])}else{az=["N/A"];ar=h.fdiff3("",aG[c2])}ar=h.collect_deleted_parts(ar);ar=h.replace_feature_markers(ar);ar=h.recode_added_parts(ak,an,ar,az);au=au+"<TR class='fdiff4'><TD class='fdiff4'>"+c2+"</TD><TD class='fdiff4'>";if(best_claim>0){au=au+"<SPAN>"+az[0]+'</SPAN><SPAN class="tooltip">'+aI[best_claim]+"</SPAN>"}else{au=au+az[0]}claim_tree_legend=""+az[0];for(af=1;af<az.length;af++){var at=/([\S\s]+>)(\d+)(<[\s\S]+)/;var ae,aq;var ao=az[af];if((ae=at.exec(az[af]))!=null){aq=parseInt(ae[2]);if(aq>ay){desc_para=aq-ay;ao="<SPAN>"+ae[1]+"["+desc_para+"]"+ae[3]+'</SPAN><SPAN class="tooltip">'+ak[aq]+"</SPAN>";claim_tree_legend_text=",["+desc_para+"]"}else{ao="<SPAN>"+az[af]+'</SPAN><SPAN class="tooltip">'+aI[aq]+"</SPAN>";claim_tree_legend_text=","+aq}if((aq!=az[0])&&(claim_tree_legend.indexOf(claim_tree_legend_text)<0)){claim_tree_legend=claim_tree_legend+claim_tree_legend_text}}au=au+ao}aw[c2]=claim_tree_legend;au=au+"</TD><TD class='fdiff4 noprint' align='center'>";if(aB==true){au=au+'<INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'" value="'+h.get_base_text_for_claim(c2)+'">'}else{au=au+' <INPUT type="text" size="4" class="claimbase" name="claimbase'+c2+'">'}loop_end=score_list.length/2;if(loop_end>3){loop_end=3}for(af=1;af<loop_end;af++){au=au+'<BR><span style="font-size:smaller">'+score_list[af*2]+"="+Math.round((score_list[af*2+1]*100)/score_list[1])+"% </span>"}if(av=="claim"){au=au+"</TD><TD class='fdiff4 noprint' align='center'>";if(am==true){au=au+'<INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'" checked>'}else{au=au+' <INPUT type="checkbox" class="use_desc" name="use_desc'+c2+'">'}}au=au+"</TD><TD class='fdiff4'><DIV contenteditable>";var ah="";for(af=0;af<ar.length;af++){ah=ah+ar[af]}au=au+h.post_cleanup(ah,0)+"</DIV></TD></TR>\n"}au=au+"</TABLE>\n";aM=h.format_claim_span(aI,ay);aK=h.format_claim_span(aG,ax);au=au+"<p>Original "+av+"s detected: "+aM+"<br>Amended "+av+"s detected: "+aK;if((O==true)&&((aM.search("Warn")>-1)||(aK.search("Warn")>-1))){alert("At least one of the detected "+av+" sets has irregular numbering.\nPlease verify that all "+av+" are properly identified and edit the text if necessary.\n\nYou can turn this message off by de-selecting the option below.")}if(av=="claim"){if(C.length>0){aJ=h.format_claim_span(aP,al);au=au+"<br>Original description paragraphs detected: "+aJ}else{au=au+"<br>(Description not analyzed)"}if(v==true){var aH=h.do_claim_tree_analysis(aI,ay,"Original claim ");var aF=h.do_claim_tree_analysis(aG,ax,"Amended claim ",aw);var aD=h.remove_claim_tree_deps(aF);var aC=h.remove_claim_tree_deps_and_support(aF);au=au+"<BR><H2>Claim trees</H2>";au=au+"<TABLE class='fdiff4' cellpadding='10' border=1><TR class='fdiff4'><TH class='fdiff4'> Original </TH><TH class='fdiff4'> Amended </TH><TH class='fdiff4'> Amended (+supt)</TH><TH class='fdiff4'> Amended (+supt +deps)</TH></TR><TR class='fdiff4'><TD valign='top' style='vertical-align: top !important'>";au+=aH;au+="</TD><TD valign='top' style='vertical-align: top !important'>";au+=aC;au+="</TD><TD valign='top' style='vertical-align: top !important'>";au+=aD;au+="</TD><TD valign='top' style='vertical-align: top !important'>";au+=aF;au+="<BR><BR>&nbsp;&nbsp;<U>Legend:</U><BR>&nbsp;&nbsp;<SUP>(<B><U>2</U></B>)</SUP> base claim<BR>&nbsp;&nbsp;<SUP>(<B>3</B>)</SUP> support claim<BR>&nbsp;&nbsp;<SUP>(4)</SUP> inherited from parent";au=au+"</TD></TR></TABLE>";au=au+h.one_time_alert_get_log()}if(Y==true){au=au+h.format_score_matrix()}}return au};h.diff=function(al,ak){var aj;var ae;var ag,af;var ai,ah;al=h.ocr_cleanup(al);ak=h.ocr_cleanup(ak);aj=h.fdiff3(al,ak);output="";for(ae=0;ae<aj.length;ae++){output=output+aj[ae]}output=h.post_cleanup(output,1);return output};h.insert_new_lines=function(ag){var ah="fj1423lkfnsfdsghdh32342";var af=new RegExp("^([\\s\\S]*\\.)[ \\t]+([\\s\\S]*)");var ae=new RegExp("^([\\s\\S]*\\d+\\.)$");while((matches=af.exec(ag))!=null){if(ae.test(matches[1])){ag=matches[1]+ah+matches[2]}else{ag=matches[1]+"\n\n"+matches[2]}}ag=ag.split(ah);ag=ag.join(" ");return ag};h.set_basis_threshold=function(ae){if((ae>=5)&&(ae<=50)){S=ae;return"OK"}else{return"Value out of bounds"}};h.set_fdiff3_highlights=function(ae){if(ae=="checked"){x=true}else{x=false}return"OK"};h.set_fdiff4_strikeout_highlights=function(ae){if(ae=="checked"){B=true}else{B=false}return"OK"};h.set_fdiff4_warn_claims=function(ae){if(ae=="checked"){O=true}else{O=false}return"OK"};h.set_fdiff4_simplify_legend=function(ae){if(ae=="checked"){o=true}else{o=false}return"OK"};h.set_fdiff4_tree_analysis=function(ae){if(ae=="checked"){v=true}else{v=false}return"OK"};h.set_fdiff4_score_matrix=function(ae){if(ae=="checked"){Y=true}else{Y=false}return"OK"};h.set_convert_claim_styles=function(ae){if(ae=="checked"){ab=true}else{ab=false}return"OK"};h.set_ignore_hyphenation=function(ae){if(ae=="checked"){T=true}else{T=false}return"OK"};h.set_eszett_normalization=function(ae){if(ae=="checked"){N=true}else{N=false}return"OK"};h.set_ignore_case=function(ae){if(ae=="checked"){a=true}else{a=false}return"OK"};h.set_ignore_spaces=function(ae){if(ae=="checked"){P=true}else{P=false}return"OK"};h.set_ignore_in_brackets=function(ae){if(ae=="checked"){j=true}else{j=false}return"OK"};h.set_fix_glued_words=function(ae){if(ae=="checked"){I=true}else{I=false}return"OK"};h.set_insert_line_breaks_indents=function(ae){if(ae=="checked"){Z=true}else{Z=false}return"OK"};h.set_insert_line_breaks_indents2=function(ae){if(ae=="checked"){Q=true}else{Q=false}return"OK"};h.clear_claim_base_overrides=function(){t=[];A=[];return"OK"};h.set_claim_base_override=function(ae,ag){var af=parseInt(ae);if(af<1){alert('Claim value "'+ae+'" out of bounds in claim base override!');return"Error"}ag=ag.split(/\s+/);ag=ag.join("");t.push(af);A.push(ag);return"OK"};h.clear_use_desc_overrides=function(){C=[];return"OK"};h.set_use_desc_override=function(ae){var af=parseInt(ae);if(af<1){alert('Claim value "'+ae+'" out of bounds in use description override!');return"Error"}C.push(af);return"OK"};h.get_version=function(){return u};h.set_title=function(ae){F=ae;return"OK"};h.regenerate_title=function(){if(W!=""){F="'"+w+"' vs. '"+G+"'"}else{F="Difference"}return"OK"};h.set_header_orig=function(ae){G=ae;h.regenerate_title();return"OK"};h.set_header_new=function(ae){w=ae;h.regenerate_title();return"OK"};h.set_dossier_number=function(ae){W=ae;h.regenerate_title();return"OK"};h.filter_table_contents=function(aj,am){var ap=/([\s\S]*?)<span class="tooltip">([\s\S]*?)<\/span>([\s\S]*)/;var ah=/([\s\S]*?)<\/span>([\s\S]*)/;var af=/([\s\S]*?)<div contenteditable="">([\s\S]*?)<\/div>([\s\S]*)/;var ae=/<table([\s\S]*)/;var ai,an;aj=(aj.split(/ style="cursor: default;"/)).join("");aj=(aj.split(/ style="cursor: default; /)).join(' style="');var aq=aj.split(/<\/table>/);if(aq.length<1){return aj}var at=aq[0].split(/<tr/);for(var ar=1;ar<at.length;ar++){var al;if(ar==1){al=at[ar].split(/<th/)}else{al=at[ar].split(/<td/)}if(am==true){for(var ag=1;ag<al.length;ag++){al[ag]=" style='text-align: left !important'"+al[ag]}}if(al.length>=5){al[3]=al.pop();if(al.length==5){al.pop()}if(ar==1){at[ar]=al.join("<th")}else{at[ar]=al.join("<td")}}while((ai=ap.exec(at[ar]))!=null){var ak=(ai[2].match(/\<span/g)||[]).length;var ao=(ai[2].match(/\<\/span/g)||[]).length;while(ak!=ao){if((an=ah.exec(ai[3]))!=null){ai[2]=ai[2]+"</span>"+an[1];ai[3]=an[2];ak=(ai[2].match(/\<span/g)||[]).length;ao=(ai[2].match(/\<\/span/g)||[]).length}else{ak=ao}}at[ar]=ai[1]+ai[3]}while((ai=af.exec(at[ar]))!=null){at[ar]=ai[1]+ai[2]+ai[3]}}aq[0]=at.join("<tr");aj=aq.join("</table>");return aj};h.filter_table_colours=function(af){var ae=/([\s\S]*)<span style=\"background-color([\s\S]*?)>([\s\S]*?)<\/span>([\s\S]*)/;var ah;var ag=af.split(/<tr/);for(row=1;row<ag.length;row++){while((ah=ae.exec(ag[row]))!=null){ag[row]=ah[1]+ah[3]+ah[4]}}af=ag.join("<tr");return af};return h}());